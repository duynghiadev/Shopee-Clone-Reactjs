âœ…âœ…âœ…âœ… ÄÃ¢y lÃ  docs tá»± research google vÃ  chat-GPT âœ…âœ…âœ…âœ…

## RTK Query lÃ  gÃ¬ ?

- `RTK Query` lÃ  má»™t thÆ° viá»‡n Ä‘Æ°á»£c cung cáº¥p bá»Ÿi Redux Toolkit (RTK) vÃ  Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ quáº£n lÃ½ tráº¡ng thÃ¡i (`state`) vÃ  gá»­i cÃ¡c yÃªu cáº§u máº¡ng (network requests) trong á»©ng dá»¥ng Redux. NÃ³ cung cáº¥p má»™t cÃ¡ch Ä‘Æ¡n giáº£n vÃ  máº¡nh máº½ Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c hoáº¡t Ä‘á»™ng liÃªn quan Ä‘áº¿n API nhÆ° truy váº¥n dá»¯ liá»‡u, thay Ä‘á»•i dá»¯ liá»‡u, `caching`, `invalidation`, vÃ  nhiá»u tÃ­nh nÄƒng khÃ¡c.

- Vá»›i `RTK Query`, báº¡n cÃ³ thá»ƒ Ä‘á»‹nh nghÄ©a cÃ¡c endpoints (Ä‘iá»ƒm cuá»‘i) API thÃ´ng qua viá»‡c táº¡o ra cÃ¡c API slice. CÃ¡c API slice nÃ y Ä‘á»‹nh nghÄ©a cÃ¡c hÃ nh Ä‘á»™ng (actions) vÃ  reducers tÆ°Æ¡ng á»©ng Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c yÃªu cáº§u máº¡ng vÃ  quáº£n lÃ½ tráº¡ng thÃ¡i dá»¯ liá»‡u liÃªn quan.

- `RTK Query` tá»± Ä‘á»™ng xá»­ lÃ½ viá»‡c táº¡o ra cÃ¡c hÃ m truy váº¥n vÃ  mutations dá»±a trÃªn cÃ¡c endpoints Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trong API slice. NÃ³ cung cáº¥p cÃ¡c phÆ°Æ¡ng thá»©c tiá»‡n Ã­ch Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c hoáº¡t Ä‘á»™ng nhÆ° láº¥y dá»¯ liá»‡u tá»« API, cáº­p nháº­t dá»¯ liá»‡u, xÃ³a dá»¯ liá»‡u, vÃ  nhiá»u hoáº¡t Ä‘á»™ng khÃ¡c má»™t cÃ¡ch dá»… dÃ ng vÃ  nháº¥t quÃ¡n.

- Má»™t sá»‘ tÃ­nh nÄƒng ná»•i báº­t cá»§a `RTK Query` bao gá»“m:

  - `Caching`: Tá»± Ä‘á»™ng quáº£n lÃ½ bá»™ nhá»› cache Ä‘á»ƒ lÆ°u trá»¯ dá»¯ liá»‡u trÆ°á»›c Ä‘Ã³ vÃ  giáº£m sá»‘ lÆ°á»£ng yÃªu cáº§u máº¡ng láº·p láº¡i.
  - `Invalidation`: Tá»± Ä‘á»™ng gá»i API láº¡i khi cÃ³ cÃ¡c thay Ä‘á»•i liÃªn quan Ä‘áº¿n dá»¯ liá»‡u. NÃ³ lÃ  má»™t hÃ m cÃ³ tÃªn lÃ  `invalidatesTags`
  - `Refetching`: Cho phÃ©p tá»± Ä‘á»™ng gá»­i láº¡i cÃ¡c yÃªu cáº§u máº¡ng khi á»©ng dá»¥ng Ä‘Æ°á»£c táº­p trung hoáº·c káº¿t ná»‘i máº¡ng láº¡i.
  - `Pagination`: Há»— trá»£ trang báº±ng cÃ¡ch tá»± Ä‘á»™ng quáº£n lÃ½ vÃ  láº¥y dá»¯ liá»‡u phÃ¢n trang tá»« API.
  - `TypeScript-friendly`: Há»— trá»£ tá»‘t TypeScript vá»›i kiá»ƒu dá»¯ liá»‡u máº¡nh máº½ vÃ  IntelliSense.

=> TÃ³m láº¡i: `RTK Query` giÃºp giáº£m Ä‘Ã¡ng ká»ƒ cÃ´ng viá»‡c láº·p láº¡i, giáº£m thiá»ƒu code boilerplate vÃ  cung cáº¥p má»™t cÃ¡ch tiáº¿p cáº­n hiá»‡u quáº£ cho viá»‡c lÃ m viá»‡c vá»›i API trong Redux.

## mutation trong ngá»¯ cáº£nh redux thÃ¬ nÃ³ cÃ³ nghÄ©a lÃ  gÃ¬ ?

- Trong ngá»¯ cáº£nh cá»§a Redux, thuáº­t ngá»¯ "`mutation`" Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ chá»‰ cÃ¡c hÃ nh Ä‘á»™ng thay Ä‘á»•i tráº¡ng thÃ¡i (`state`) cá»§a á»©ng dá»¥ng. Trong Redux, cÃ¡c `mutations` thÆ°á»ng Ä‘Æ°á»£c thá»±c hiá»‡n thÃ´ng qua cÃ¡c `action` vÃ  `reducers`.

- Trong Redux, má»™t `mutation` xáº£y ra khi má»™t `action` Ä‘Æ°á»£c gá»­i Ä‘i Ä‘á»ƒ thay Ä‘á»•i tráº¡ng thÃ¡i (`state`) cá»§a á»©ng dá»¥ng. CÃ¡c `action` Ä‘áº¡i diá»‡n cho sá»± kiá»‡n (`event`) hoáº·c hÃ nh Ä‘á»™ng Ä‘Æ°á»£c kÃ­ch hoáº¡t trong á»©ng dá»¥ng, cháº³ng háº¡n nhÆ° ngÆ°á»i dÃ¹ng nháº¥p vÃ o má»™t nÃºt, gá»­i má»™t biá»ƒu máº«u, hoáº·c nháº­n dá»¯ liá»‡u tá»« API. Má»—i `action` Ä‘Æ°á»£c gá»­i Ä‘i sáº½ kÃ­ch hoáº¡t cÃ¡c `reducers` Ä‘á»ƒ xÃ¡c Ä‘á»‹nh cÃ¡ch thay Ä‘á»•i tráº¡ng thÃ¡i (`state`) cá»§a á»©ng dá»¥ng dá»±a trÃªn `action` Ä‘Ã³.

- `Reducers` trong Redux cÃ³ nhiá»‡m vá»¥ xá»­ lÃ½ cÃ¡c `action` vÃ  táº¡o ra má»™t phiÃªn báº£n má»›i cá»§a tráº¡ng thÃ¡i (`state`) dá»±a trÃªn `action` Ä‘Ã³. Nhá»¯ng thay Ä‘á»•i nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c coi lÃ  cÃ¡c `mutations` vÃ¬ chÃºng thay Ä‘á»•i tráº¡ng thÃ¡i hiá»‡n táº¡i thÃ nh tráº¡ng thÃ¡i má»›i, nhÆ°ng theo cÃ¡ch tiáº¿p cáº­n khÃ´ng thay Ä‘á»•i (`immutable`) cá»§a Redux. Thay vÃ¬ sá»­a Ä‘á»•i trá»±c tiáº¿p tráº¡ng thÃ¡i hiá»‡n táº¡i, Redux khuyáº¿n khÃ­ch viá»‡c táº¡o ra má»™t báº£n sao cá»§a tráº¡ng thÃ¡i hiá»‡n táº¡i vÃ  thá»±c hiá»‡n cÃ¡c thay Ä‘á»•i trÃªn báº£n sao Ä‘Ã³ Ä‘á»ƒ táº¡o ra má»™t tráº¡ng thÃ¡i má»›i.

=> ğŸš€ğŸ“Œ VÃ¬ váº­y, trong ngá»¯ cáº£nh Redux, "`mutation`" thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ chá»‰ cÃ¡c hÃ nh Ä‘á»™ng thay Ä‘á»•i tráº¡ng thÃ¡i cá»§a á»©ng dá»¥ng thÃ´ng qua viá»‡c sá»­ dá»¥ng `action` vÃ  `reducer` Ä‘á»ƒ táº¡o ra má»™t tráº¡ng thÃ¡i má»›i (`new state`).

## code boilerplate trong láº­p trÃ¬nh Ä‘Æ°á»£c gá»i lÃ  gÃ¬ ?

- Trong láº­p trÃ¬nh, "boilerplate" (báº£n máº«u) lÃ  cÃ¡c Ä‘oáº¡n mÃ£ hoáº·c cáº¥u trÃºc mÃ£ Ä‘Æ°á»£c sá»­ dá»¥ng nhiá»u láº§n trong cÃ¡c dá»± Ã¡n pháº§n má»m khÃ¡c nhau. CÃ¡c Ä‘oáº¡n mÃ£ boilerplate thÆ°á»ng Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c cÃ´ng viá»‡c cÆ¡ báº£n vÃ  phá»• biáº¿n, nhÆ° khá»Ÿi táº¡o má»™t á»©ng dá»¥ng, cáº¥u hÃ¬nh mÃ´i trÆ°á»ng, xá»­ lÃ½ lá»—i, Ä‘á»‹nh nghÄ©a cÃ¡c hÃ m vÃ  lá»›p, vÃ  nhiá»u tÃ¡c vá»¥ khÃ¡c.

- Boilerplate code thÆ°á»ng khÃ´ng cung cáº¥p giÃ¡ trá»‹ Ä‘Ã¡ng ká»ƒ cho chá»©c nÄƒng cá»§a á»©ng dá»¥ng, mÃ  chá»‰ lÃ  ná»n táº£ng cho cÃ¡c pháº§n má»m phá»©c táº¡p hÆ¡n. Viá»‡c sá»­ dá»¥ng boilerplate code cÃ³ thá»ƒ giÃºp Ä‘Æ¡n giáº£n hÃ³a vÃ  tÄƒng tá»‘c Ä‘á»™ phÃ¡t triá»ƒn pháº§n má»m, vÃ¬ cÃ¡c láº­p trÃ¬nh viÃªn khÃ´ng cáº§n pháº£i viáº¿t láº¡i cÃ¡c Ä‘oáº¡n mÃ£ cÆ¡ báº£n má»—i khi táº¡o má»™t á»©ng dá»¥ng má»›i.

- VÃ­ dá»¥, trong web development, cÃ¡c boilerplate code phá»• biáº¿n nhÆ° "create-react-app" cho React, "Express-generator" cho Node.js vÃ  "Ruby on Rails" cho Ruby. CÃ¡c framework nÃ y cung cáº¥p cÃ¡c Ä‘oáº¡n mÃ£ boilerplate Ä‘á»ƒ giÃºp táº¡o nÃªn má»™t á»©ng dá»¥ng web hoÃ n chá»‰nh má»™t cÃ¡ch nhanh chÃ³ng vÃ  dá»… dÃ ng hÆ¡n.

=> TÃ³m láº¡i, code boilerplate nÃ³ cÅ©ng chá»‰ code thá»«a, code khÃ´ng cÃ³ giÃ¡ trá»‹.

## LÃ½ do RTK Query xuáº¥t hiá»‡n ? RTK Query giÃºp chÃºng ta lÃ m nhá»¯ng viá»‡c gÃ¬ ?

- âœ… RTK Query xuáº¥t hiá»‡n vá»›i má»¥c Ä‘Ã­ch giáº£i quyáº¿t nhá»¯ng thÃ¡ch thá»©c vÃ  váº¥n Ä‘á» thÆ°á»ng gáº·p khi lÃ m viá»‡c vá»›i API trong Redux. DÆ°á»›i Ä‘Ã¢y lÃ  má»™t sá»‘ lÃ½ do vÃ  lá»£i Ã­ch cá»§a viá»‡c sá»­ dá»¥ng RTK Query:

  - `Giáº£m code boilerplate`: RTK Query giÃºp giáº£m sá»‘ lÆ°á»£ng code boilerplate cáº§n pháº£i viáº¿t Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c yÃªu cáº§u máº¡ng, quáº£n lÃ½ tráº¡ng thÃ¡i vÃ  `caching`. NÃ³ tá»± Ä‘á»™ng táº¡o ra cÃ¡c hÃ m truy váº¥n vÃ  `mutations` dá»±a trÃªn cáº¥u hÃ¬nh `endpoints`, giÃºp tiáº¿t kiá»‡m thá»i gian vÃ  cÃ´ng sá»©c.

  - `Quáº£n lÃ½ tráº¡ng thÃ¡i dá»… dÃ ng`: RTK Query tá»± Ä‘á»™ng quáº£n lÃ½ tráº¡ng thÃ¡i cá»§a dá»¯ liá»‡u liÃªn quan Ä‘áº¿n API, bao gá»“m viá»‡c lÆ°u trá»¯ vÃ  cáº­p nháº­t dá»¯ liá»‡u. NÃ³ cung cáº¥p cÃ¡c cÆ¡ cháº¿ nhÆ° `caching`, `invalidation` vÃ  `refetching` Ä‘á»ƒ Ä‘áº£m báº£o ráº±ng dá»¯ liá»‡u Ä‘Æ°á»£c duy trÃ¬ vÃ  cáº­p nháº­t má»™t cÃ¡ch nháº¥t quÃ¡n.

  - `TÃ­ch há»£p tá»‘t vá»›i Redux`: RTK Query Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn cÆ¡ sá»Ÿ cá»§a Redux vÃ  tÃ­ch há»£p má»™t cÃ¡ch mÆ°á»£t mÃ  vá»›i cÃ¡c cÃ´ng cá»¥ vÃ  khÃ¡i niá»‡m cá»§a Redux nhÆ° `actions`, `reducers` vÃ  `store`. NÃ³ táº­n dá»¥ng cÃ¡c lá»£i Ã­ch cá»§a Redux nhÆ° kiá»ƒm soÃ¡t tráº¡ng thÃ¡i dá»… dÃ ng, gá»¡ lá»—i vÃ  theo dÃµi thay Ä‘á»•i.

  - `TÃ­ch há»£p TypeScript-friendly`: RTK Query há»— trá»£ tá»‘t TypeScript vá»›i kiá»ƒu dá»¯ liá»‡u máº¡nh máº½ vÃ  IntelliSense. NÃ³ cung cáº¥p cÃ¡c kiá»ƒu dá»¯ liá»‡u Ä‘Ãºng Ä‘áº¯n cho cÃ¡c truy váº¥n vÃ  mutations, giÃºp giáº£m thiá»ƒu lá»—i vÃ  cung cáº¥p tráº£i nghiá»‡m phÃ¡t triá»ƒn an toÃ n vÃ  dá»… dÃ ng.

  - `Cung cáº¥p tÃ­nh nÄƒng máº¡nh máº½`: RTK Query Ä‘i kÃ¨m vá»›i nhiá»u tÃ­nh nÄƒng há»¯u Ã­ch nhÆ° `pagination`, `sorting`, `filtering` vÃ  tá»± Ä‘á»™ng gá»­i láº¡i yÃªu cáº§u máº¡ng khi á»©ng dá»¥ng Ä‘Æ°á»£c táº­p trung hoáº·c káº¿t ná»‘i máº¡ng láº¡i. NÃ³ cung cáº¥p má»™t cÃ¡ch tiáº¿p cáº­n tiá»‡n lá»£i vÃ  máº¡nh máº½ cho viá»‡c lÃ m viá»‡c vá»›i API.

=> ğŸš€ğŸ“Œ TÃ³m láº¡i, `RTK Query` giÃºp giáº£m thiá»ƒu cÃ´ng viá»‡c láº·p láº¡i, cung cáº¥p quáº£n lÃ½ tráº¡ng thÃ¡i dá»… dÃ ng, tÃ­ch há»£p tá»‘t vá»›i Redux vÃ  cung cáº¥p nhiá»u tÃ­nh nÄƒng máº¡nh máº½ Ä‘á»ƒ lÃ m viá»‡c vá»›i API. NÃ³ táº¡o ra má»™t cÃ¡ch tiáº¿p cáº­n hiá»‡u quáº£ vÃ  hiá»‡u quáº£ hÆ¡n cho viá»‡c quáº£n lÃ½ dá»¯ liá»‡u vÃ  tÆ°Æ¡ng tÃ¡c vá»›i cÃ¡c dá»‹ch vá»¥ máº¡ng trong á»©ng dá»¥ng Redux.

- âœ… NgoÃ i nhá»¯ng tÃ­nh nÄƒng chÃ­nh Ä‘Ã£ Ä‘Æ°á»£c Ä‘á» cáº­p, RTK Query cÃ²n cung cáº¥p má»™t sá»‘ tÃ­nh nÄƒng khÃ¡c nháº±m tá»‘i Æ°u hÃ³a vÃ  Ä‘Æ¡n giáº£n hÃ³a quÃ¡ trÃ¬nh lÃ m viá»‡c vá»›i API. DÆ°á»›i Ä‘Ã¢y lÃ  má»™t sá»‘ tÃ­nh nÄƒng quan trá»ng khÃ¡c cá»§a RTK Query:

- `Auto-Generated API Slices`: RTK Query tá»± Ä‘á»™ng táº¡o ra cÃ¡c API slices (Ä‘oáº¡n code Ä‘á»ƒ thao tÃ¡c vá»›i dá»¯ liá»‡u tá»« API) dá»±a trÃªn cáº¥u hÃ¬nh endpoints. CÃ¡c API slices nÃ y giÃºp giáº£m thiá»ƒu code boilerplate vÃ  tá»± Ä‘á»™ng xá»­ lÃ½ cÃ¡c thao tÃ¡c CRUD (`Create`, `Read`, `Update`, `Delete`) liÃªn quan Ä‘áº¿n dá»¯ liá»‡u tá»« API.

- `Data Normalization`: RTK Query há»— trá»£ viá»‡c normalize dá»¯ liá»‡u tá»± Ä‘á»™ng. Äiá»u nÃ y Ä‘áº£m báº£o ráº±ng cÃ¡c má»¥c dá»¯ liá»‡u Ä‘Æ°á»£c lÆ°u trá»¯ vÃ  sá»­ dá»¥ng chung má»™t cÃ¡ch hiá»‡u quáº£, trÃ¡nh viá»‡c lÆ°u trá»¯ dá»¯ liá»‡u trÃ¹ng láº·p vÃ  tá»‘i Æ°u hÃ³a hiá»‡u suáº¥t.

- `Pagination`: RTK Query há»— trá»£ tÃ­nh nÄƒng phÃ¢n trang dá»¯ liá»‡u tá»« API. NÃ³ cung cáº¥p cÃ¡c phÆ°Æ¡ng thá»©c vÃ  kiá»ƒu dá»¯ liá»‡u Ä‘á»ƒ dá»… dÃ ng thao tÃ¡c vá»›i cÃ¡c trang dá»¯ liá»‡u vÃ  tá»± Ä‘á»™ng táº£i cÃ¡c trang má»›i khi cáº§n thiáº¿t.

- `Data Invalidation`: RTK Query cÃ³ kháº£ nÄƒng tá»± Ä‘á»™ng xÃ¡c Ä‘á»‹nh khi dá»¯ liá»‡u tá»« API Ä‘Ã£ bá»‹ lá»—i thá»i hoáº·c khÃ´ng cÃ²n Ä‘Ãºng. Khi dá»¯ liá»‡u bá»‹ háº¿t háº¡n, nÃ³ sáº½ tá»± Ä‘á»™ng gá»­i yÃªu cáº§u má»›i Ä‘á»ƒ cáº­p nháº­t dá»¯ liá»‡u vÃ  duy trÃ¬ tÃ­nh nháº¥t quÃ¡n. NÃ³i má»™t cÃ¡ch dá»… hiá»ƒu hÆ¡n nÃ³ cÃ³ nghÄ©a lÃ : Tá»± Ä‘á»™ng gá»i API láº¡i khi cÃ³ cÃ¡c thay Ä‘á»•i liÃªn quan Ä‘áº¿n dá»¯ liá»‡u. NÃ³ lÃ  má»™t hÃ m cÃ³ tÃªn lÃ  `invalidatesTags`

- `Polling`: RTK Query há»— trá»£ tÃ­nh nÄƒng polling, cho phÃ©p tá»± Ä‘á»™ng gá»­i yÃªu cáº§u tá»›i API theo khoáº£ng thá»i gian nháº¥t Ä‘á»‹nh. Äiá»u nÃ y há»¯u Ã­ch trong cÃ¡c trÆ°á»ng há»£p cáº§n cáº­p nháº­t dá»¯ liá»‡u liÃªn tá»¥c hoáº·c theo dÃµi sá»± thay Ä‘á»•i tá»« phÃ­a server.

- `TypeScript Support`: RTK Query Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ tÆ°Æ¡ng thÃ­ch tá»‘t vá»›i TypeScript. NÃ³ cung cáº¥p cÃ¡c kiá»ƒu dá»¯ liá»‡u máº¡nh máº½ Ä‘á»ƒ giÃºp phÃ¡t hiá»‡n lá»—i vÃ  cung cáº¥p tráº£i nghiá»‡m phÃ¡t triá»ƒn an toÃ n vÃ  dá»… dÃ ng.

=> ğŸš€ğŸ“Œ TÃ³m láº¡i, `RTK Query` khÃ´ng chá»‰ cung cáº¥p cÃ¡c tÃ­nh nÄƒng cÆ¡ báº£n Ä‘á»ƒ lÃ m viá»‡c vá»›i API mÃ  cÃ²n Ä‘i kÃ¨m vá»›i nhiá»u tÃ­nh nÄƒng khÃ¡c nháº±m tá»‘i Æ°u hÃ³a quÃ¡ trÃ¬nh lÃ m viá»‡c vÃ  Ä‘Æ¡n giáº£n hÃ³a viá»‡c quáº£n lÃ½ dá»¯ liá»‡u trong á»©ng dá»¥ng Redux.

## RTK Query dÃ¹ng Ä‘á»ƒ sá»­ dá»¥ng trong nhá»¯ng trÆ°á»ng há»£p nÃ o ?

- `RTK Query` Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ sá»­ dá»¥ng trong cÃ¡c trÆ°á»ng há»£p sau:

- `Truy váº¥n dá»¯ liá»‡u tá»« API`: RTK Query giÃºp báº¡n truy váº¥n dá»¯ liá»‡u tá»« API má»™t cÃ¡ch dá»… dÃ ng vÃ  hiá»‡u quáº£. Báº¡n cÃ³ thá»ƒ Ä‘á»‹nh nghÄ©a cÃ¡c endpoint API vÃ  sá»­ dá»¥ng cÃ¡c hÃ m táº¡o truy váº¥n Ä‘á»ƒ láº¥y dá»¯ liá»‡u tá»« server.

- `Quáº£n lÃ½ tráº¡ng thÃ¡i dá»¯ liá»‡u`: RTK Query tá»± Ä‘á»™ng quáº£n lÃ½ tráº¡ng thÃ¡i dá»¯ liá»‡u trÃªn client-side. NÃ³ lÆ°u trá»¯ vÃ  cáº­p nháº­t dá»¯ liá»‡u tá»« server, cho phÃ©p báº¡n truy cáº­p vÃ o dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c cache mÃ  khÃ´ng cáº§n gá»­i yÃªu cáº§u láº¡i.

- `TÃ­ch há»£p vá»›i Redux`: RTK Query Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn Redux vÃ  tÃ­ch há»£p hoÃ n háº£o vá»›i Redux store. NÃ³ giÃºp báº¡n tá»• chá»©c vÃ  quáº£n lÃ½ dá»¯ liá»‡u trong store Redux má»™t cÃ¡ch dá»… dÃ ng vÃ  theo cÃ¡ch tiáº¿p cáº­n kiá»ƒu Redux Toolkit.

- `Caching data`: RTK Query cung cáº¥p tÃ­nh nÄƒng caching dá»¯ liá»‡u tá»± Ä‘á»™ng.

  - CÃ³ nghÄ©a lÃ  RTK Query cÃ³ kháº£ nÄƒng tá»± Ä‘á»™ng lÆ°u trá»¯ dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c truy váº¥n tá»« API. Khi báº¡n thá»±c hiá»‡n má»™t truy váº¥n dá»¯ liá»‡u tá»« API báº±ng RTK Query, nÃ³ sáº½ tá»± Ä‘á»™ng lÆ°u trá»¯ káº¿t quáº£ cá»§a truy váº¥n Ä‘Ã³ trong bá»™ nhá»› cache.

  - Khi báº¡n thá»±c hiá»‡n truy váº¥n tÆ°Æ¡ng tá»± sau Ä‘Ã³, RTK Query sáº½ kiá»ƒm tra xem dá»¯ liá»‡u Ä‘Ã£ cÃ³ trong cache hay chÆ°a. Náº¿u dá»¯ liá»‡u Ä‘Ã£ tá»“n táº¡i trong cache vÃ  chÆ°a háº¿t háº¡n, RTK Query sáº½ tráº£ vá» dá»¯ liá»‡u tá»« cache mÃ  khÃ´ng cáº§n gá»­i yÃªu cáº§u má»›i Ä‘áº¿n API. Äiá»u nÃ y giÃºp giáº£m sá»‘ lÆ°á»£ng yÃªu cáº§u gá»­i Ä‘i vÃ  cáº£i thiá»‡n hiá»‡u suáº¥t á»©ng dá»¥ng.

  - TÃ­nh nÄƒng caching tá»± Ä‘á»™ng cá»§a RTK Query cÅ©ng Ä‘i kÃ¨m vá»›i viá»‡c quáº£n lÃ½ tÃ­nh nháº¥t quÃ¡n dá»¯ liá»‡u. Khi cÃ³ sá»± thay Ä‘á»•i tá»« phÃ­a server, RTK Query sáº½ tá»± Ä‘á»™ng cáº­p nháº­t dá»¯ liá»‡u trong cache Ä‘á»ƒ Ä‘áº£m báº£o dá»¯ liá»‡u Ä‘Æ°á»£c cáº­p nháº­t vÃ  Ä‘Ãºng Ä‘áº¯n.

  - Vá»›i tÃ­nh nÄƒng caching nÃ y, RTK Query giÃºp tá»‘i Æ°u viá»‡c truy váº¥n dá»¯ liá»‡u tá»« API vÃ  cung cáº¥p tráº£i nghiá»‡m á»©ng dá»¥ng mÆ°á»£t mÃ  hÆ¡n cho ngÆ°á»i dÃ¹ng.

- `invalidation data`:

  - Tá»± Ä‘á»™ng gá»i API láº¡i khi cÃ³ cÃ¡c thay Ä‘á»•i liÃªn quan Ä‘áº¿n dá»¯ liá»‡u. NÃ³ lÃ  má»™t hÃ m cÃ³ tÃªn lÃ  `invalidatesTags`

  - NÃ³ cÅ©ng há»— trá»£ invalidation tá»± Ä‘á»™ng khi dá»¯ liá»‡u háº¿t háº¡n hoáº·c khÃ´ng cÃ²n Ä‘Ãºng.

  - RTK Query cung cáº¥p tÃ­nh nÄƒng invalidation tá»± Ä‘á»™ng khi dá»¯ liá»‡u háº¿t háº¡n hoáº·c khÃ´ng cÃ²n Ä‘Ãºng. Khi báº¡n thá»±c hiá»‡n má»™t truy váº¥n dá»¯ liá»‡u tá»« API báº±ng RTK Query, nÃ³ sáº½ tá»± Ä‘á»™ng ghi láº¡i thá»i gian khi dá»¯ liá»‡u Ä‘Æ°á»£c truy váº¥n. Sau má»™t khoáº£ng thá»i gian xÃ¡c Ä‘á»‹nh, RTK Query sáº½ xem xÃ©t dá»¯ liá»‡u Ä‘Ã£ háº¿t háº¡n hay khÃ´ng.

  - Náº¿u dá»¯ liá»‡u Ä‘Ã£ háº¿t háº¡n, RTK Query sáº½ tá»± Ä‘á»™ng gá»­i yÃªu cáº§u má»›i Ä‘áº¿n API Ä‘á»ƒ cáº­p nháº­t dá»¯ liá»‡u má»›i nháº¥t. Äiá»u nÃ y Ä‘áº£m báº£o ráº±ng dá»¯ liá»‡u trong cache luÃ´n Ä‘Æ°á»£c cáº­p nháº­t vÃ  khÃ´ng trá»Ÿ nÃªn lá»—i thá»i.

  - NgoÃ i ra, RTK Query cÅ©ng há»— trá»£ viá»‡c xÃ¡c Ä‘á»‹nh tá»± Ä‘á»™ng khi dá»¯ liá»‡u khÃ´ng cÃ²n Ä‘Ãºng. Khi cÃ³ sá»± thay Ä‘á»•i tá»« phÃ­a server, vÃ­ dá»¥ nhÆ° thÃ´ng tin bá»‹ thay Ä‘á»•i hoáº·c báº£n ghi bá»‹ xÃ³a, RTK Query sáº½ tá»± Ä‘á»™ng ghi nháº­n sá»± thay Ä‘á»•i nÃ y vÃ  cáº­p nháº­t dá»¯ liá»‡u trong cache. Äiá»u nÃ y Ä‘áº£m báº£o ráº±ng dá»¯ liá»‡u Ä‘Æ°á»£c duy trÃ¬ trong tráº¡ng thÃ¡i chÃ­nh xÃ¡c vÃ  tÆ°Æ¡ng thÃ­ch vá»›i tráº¡ng thÃ¡i thá»±c táº¿ tá»« phÃ­a server.

  - TÃ­nh nÄƒng invalidation tá»± Ä‘á»™ng cá»§a RTK Query giÃºp Ä‘áº£m báº£o ráº±ng dá»¯ liá»‡u trong á»©ng dá»¥ng cá»§a báº¡n luÃ´n Ä‘Æ°á»£c cáº­p nháº­t vÃ  Ä‘Ãºng Ä‘áº¯n, Ä‘á»“ng thá»i giáº£m táº£i cho server báº±ng cÃ¡ch chá»‰ cáº­p nháº­t dá»¯ liá»‡u khi cáº§n thiáº¿t.

- `TÃ­ch há»£p vá»›i TypeScript`: RTK Query Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ tÆ°Æ¡ng thÃ­ch tá»‘t vá»›i TypeScript, cung cáº¥p cÃ¡c kiá»ƒu dá»¯ liá»‡u máº¡nh máº½ Ä‘á»ƒ giÃºp phÃ¡t hiá»‡n lá»—i vÃ  cung cáº¥p tráº£i nghiá»‡m phÃ¡t triá»ƒn an toÃ n vÃ  dá»… dÃ ng.

=> ğŸš€ğŸ“Œ TÃ³m láº¡i, `RTK Query` lÃ  má»™t cÃ´ng cá»¥ máº¡nh máº½ Ä‘á»ƒ lÃ m viá»‡c vá»›i API trong Redux. NÃ³ giÃºp báº¡n truy váº¥n dá»¯ liá»‡u, quáº£n lÃ½ tráº¡ng thÃ¡i dá»¯ liá»‡u, `caching`, `invalidation` vÃ  tÃ­ch há»£p tá»‘t vá»›i `Redux` vÃ  `TypeScript`.

## RTK Query xá»‹n Ä‘áº¿n cá»Ÿ nÃ o ?

- RTK Query Ä‘Æ°á»£c xem lÃ  má»™t thÆ° viá»‡n xá»‹n trong viá»‡c quáº£n lÃ½ truy váº¥n dá»¯ liá»‡u trong á»©ng dá»¥ng Redux. DÆ°á»›i Ä‘Ã¢y lÃ  má»™t sá»‘ Ä‘iá»ƒm ná»•i báº­t cá»§a RTK Query:

  - `TÃ­ch há»£p dá»… dÃ ng`: RTK Query Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ tÃ­ch há»£p trá»±c tiáº¿p vá»›i Redux vÃ  Redux Toolkit. Báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng RTK Query mÃ  khÃ´ng cáº§n pháº£i cÃ i Ä‘áº·t cÃ¡c thÆ° viá»‡n ngoÃ i khÃ¡c.

  - `CÃº phÃ¡p Ä‘Æ¡n giáº£n`: RTK Query cung cáº¥p cÃº phÃ¡p Ä‘Æ¡n giáº£n vÃ  rÃµ rÃ ng Ä‘á»ƒ Ä‘á»‹nh nghÄ©a cÃ¡c truy váº¥n dá»¯ liá»‡u vÃ  mutations. Báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡c `builder functions` Ä‘á»ƒ xÃ¡c Ä‘á»‹nh cÃ¡c endpoint API vÃ  quy Ä‘á»‹nh cÃ¡c hoáº¡t Ä‘á»™ng CRUD má»™t cÃ¡ch dá»… dÃ ng.

  - `TÃ­nh nÄƒng tá»± Ä‘á»™ng`: RTK Query cung cáº¥p nhiá»u tÃ­nh nÄƒng tá»± Ä‘á»™ng nhÆ° `caching` dá»¯ liá»‡u, `invalidation` dá»¯ liá»‡u, vÃ  `refetching` tá»± Ä‘á»™ng khi á»©ng dá»¥ng cÃ³ sá»± thay Ä‘á»•i hoáº·c Ä‘Æ°á»£c focus. Äiá»u nÃ y giÃºp giáº£m thiá»ƒu viá»‡c láº­p trÃ¬nh thá»§ cÃ´ng vÃ  tá»‘i Æ°u hiá»‡u nÄƒng á»©ng dá»¥ng.

  - `TÆ°Æ¡ng thÃ­ch vá»›i REST vÃ  GraphQL`: RTK Query há»— trá»£ cáº£ REST vÃ  GraphQL vÃ  cho phÃ©p báº¡n xÃ¡c Ä‘á»‹nh cÃ¡c truy váº¥n vÃ  mutations dá»±a trÃªn cáº£ hai phÆ°Æ¡ng thá»©c nÃ y. Báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng RTK Query Ä‘á»ƒ giao tiáº¿p vá»›i cÃ¡c `API` dá»±a trÃªn `REST` hoáº·c `GraphQL` má»™t cÃ¡ch dá»… dÃ ng.

  - `TÃ­ch há»£p vá»›i DevTools`: RTK Query tÃ­ch há»£p sáºµn vá»›i `Redux DevTools`, cho phÃ©p báº¡n theo dÃµi vÃ  gá»¡ lá»—i cÃ¡c hoáº¡t Ä‘á»™ng truy váº¥n vÃ  mutations má»™t cÃ¡ch dá»… dÃ ng.

=> ğŸš€ğŸ“Œ TÃ³m láº¡i, `RTK Query` Ä‘Æ°á»£c Ä‘Ã¡nh giÃ¡ lÃ  má»™t thÆ° viá»‡n xá»‹n Ä‘áº¿n má»©c Ä‘áº£m báº£o tÃ­nh Ä‘Æ¡n giáº£n, hiá»‡u nÄƒng cao vÃ  tÃ­ch há»£p tá»‘t vá»›i Redux, giÃºp giáº£m thiá»ƒu cÃ´ng viá»‡c láº·p láº¡i vÃ  tá»‘i Æ°u quÃ¡ trÃ¬nh quáº£n lÃ½ truy váº¥n dá»¯ liá»‡u trong á»©ng dá»¥ng Redux cá»§a báº¡n.

## Khi sá»­ dá»¥ng RTK Query nÃ³ cÃ³ khÃ¡c gÃ¬ so vá»›i createAsyncThunk ?

- Khi sá»­ dá»¥ng RTK Query, cÃ³ má»™t sá»‘ `khÃ¡c biá»‡t` so vá»›i viá»‡c sá»­ dá»¥ng `createAsyncThunk` trong Redux Toolkit:

  - `Tá»± Ä‘á»™ng táº¡o cÃ¡c action vÃ  reducer`: RTK Query tá»± Ä‘á»™ng táº¡o cÃ¡c action vÃ  reducer cho cÃ¡c truy váº¥n vÃ  mutations, giÃºp giáº£m bá»›t cÃ´ng viá»‡c láº·p láº¡i khi táº¡o cÃ¡c action vÃ  reducer thá»§ cÃ´ng nhÆ° khi sá»­ dá»¥ng `createAsyncThunk`.

  - `TÃ­ch há»£p sáºµn vá»›i Redux Toolkit`: RTK Query Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ tÃ­ch há»£p sáºµn vá»›i Redux Toolkit, mang Ä‘áº¿n sá»± thuáº­n tiá»‡n vÃ  tÆ°Æ¡ng thÃ­ch vá»›i cÃ¡ch Redux Toolkit xá»­ lÃ½ `store` vÃ  `middleware`.

  ğŸ‘‰ CÃ¢u nÃ y nÃ³i vá» viá»‡c RTK Query Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ tÃ­ch há»£p sáºµn vá»›i Redux Toolkit. Äiá»u nÃ y cÃ³ nghÄ©a lÃ  RTK Query Ä‘Æ°á»£c xÃ¢y dá»±ng Ä‘á»ƒ hoáº¡t Ä‘á»™ng tá»‘t vá»›i Redux Toolkit vÃ  táº­n dá»¥ng cÃ¡c tÃ­nh nÄƒng vÃ  cáº¥u trÃºc cá»§a Redux Toolkit.

  ğŸ‘‰ Khi sá»­ dá»¥ng Redux Toolkit, chÃºng ta thÆ°á»ng sá»­ dá»¥ng `configureStore` Ä‘á»ƒ táº¡o `store` vÃ  sá»­ dá»¥ng cÃ¡c `middleware` nhÆ° `redux-thunk` hoáº·c `redux-saga` Ä‘á»ƒ xá»­ lÃ½ cÃ¡c side effects. RTK Query cung cáº¥p má»™t `middleware` riÃªng Ä‘á»ƒ xá»­ lÃ½ cÃ¡c truy váº¥n vÃ  `mutations` tá»« API, vÃ  nÃ³ Ä‘Ã£ Ä‘Æ°á»£c tÃ­ch há»£p sáºµn vá»›i Redux Toolkit. Äiá»u nÃ y Ä‘á»“ng nghÄ©a ráº±ng chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng RTK Query nhÆ° má»™t pháº§n cá»§a Redux Toolkit mÃ  khÃ´ng cáº§n cáº¥u hÃ¬nh hoáº·c tÃ­ch há»£p thÃªm nhiá»u thÆ° viá»‡n hay `middleware` khÃ¡c.

  ğŸ‘‰ Viá»‡c tÃ­ch há»£p sáºµn giá»¯a RTK Query vÃ  Redux Toolkit mang láº¡i sá»± thuáº­n tiá»‡n vÃ  tÆ°Æ¡ng thÃ­ch cho viá»‡c quáº£n lÃ½ tráº¡ng thÃ¡i á»©ng dá»¥ng vÃ  xá»­ lÃ½ cÃ¡c tÃ¡c Ä‘á»™ng phá»¥ trong má»™t cáº¥u trÃºc duy nháº¥t. ChÃºng ta khÃ´ng cáº§n lo láº¯ng vá» viá»‡c cáº¥u hÃ¬nh Redux store, xá»­ lÃ½ `middleware` hoáº·c tÃ­ch há»£p cÃ¡c thÆ° viá»‡n khÃ¡c, vÃ¬ RTK Query Ä‘Ã£ Ä‘Æ°á»£c tá»‘i Æ°u vÃ  Ä‘á»“ng bá»™ hoÃ¡ tá»‘t vá»›i Redux Toolkit.

  - `Há»— trá»£ caching tá»± Ä‘á»™ng`: RTK Query cung cáº¥p tÃ­nh nÄƒng `caching` tá»± Ä‘á»™ng, giÃºp lÆ°u trá»¯ káº¿t quáº£ truy váº¥n vÃ  sá»­ dá»¥ng láº¡i chÃºng mÃ  khÃ´ng cáº§n gá»­i láº¡i yÃªu cáº§u máº¡ng. Äiá»u nÃ y giÃºp cáº£i thiá»‡n hiá»‡u suáº¥t á»©ng dá»¥ng vÃ  giáº£m táº£i cho server.

  - `Tá»± Ä‘á»™ng xá»­ lÃ½ invalidation`: RTK Query há»— trá»£ `invalidation` tá»± Ä‘á»™ng khi dá»¯ liá»‡u háº¿t háº¡n hoáº·c khÃ´ng cÃ²n Ä‘Ãºng. Khi cÃ³ dá»¯ liá»‡u má»›i Ä‘Æ°á»£c cáº­p nháº­t, RTK Query sáº½ tá»± Ä‘á»™ng cáº­p nháº­t `cache` vÃ  thÃ´ng bÃ¡o cho cÃ¡c thÃ nh pháº§n (`component`) sá»­ dá»¥ng dá»¯ liá»‡u Ä‘á»ƒ cáº­p nháº­t giao diá»‡n. NÃ³i má»™t cÃ¡ch dá»… hiá»ƒu nÃ³ lÃ : Tá»± Ä‘á»™ng gá»i API láº¡i khi cÃ³ cÃ¡c thay Ä‘á»•i liÃªn quan Ä‘áº¿n dá»¯ liá»‡u. NÃ³ lÃ  má»™t hÃ m cÃ³ tÃªn lÃ  `invalidatesTags`

  - `Há»— trá»£ cÃ¡c tÃ­nh nÄƒng tiá»‡n Ã­ch khÃ¡c`: RTK Query cung cáº¥p cÃ¡c tÃ­nh nÄƒng tiá»‡n Ã­ch nhÆ° `pagination`, `polling` (tá»± Ä‘á»™ng gá»­i yÃªu cáº§u liÃªn tá»¥c), `refetching` (gá»­i láº¡i yÃªu cáº§u khi cÃ³ sá»± tÆ°Æ¡ng tÃ¡c tá»« ngÆ°á»i dÃ¹ng), vÃ  nhiá»u tÃ­nh nÄƒng khÃ¡c giÃºp quáº£n lÃ½ dá»¯ liá»‡u tá»« API dá»… dÃ ng hÆ¡n.

  ğŸ‘‰ CÃ¡ch thá»©c polling cÃ³ thá»ƒ Ä‘Æ°á»£c thá»±c hiá»‡n báº±ng cÃ¡ch sá»­ dá»¥ng hÃ m láº·p (looping) hoáº·c sá»­ dá»¥ng cÃ¡c cÆ¡ cháº¿ nhÆ° setTimeout hoáº·c setInterval Ä‘á»ƒ gá»­i yÃªu cáº§u Ä‘á»‹nh ká»³. Khi dá»¯ liá»‡u háº¿t háº¡n hoáº·c cÃ³ sá»± thay Ä‘á»•i, á»©ng dá»¥ng sáº½ gá»­i láº¡i yÃªu cáº§u Ä‘á»ƒ láº¥y thÃ´ng tin má»›i.

  ğŸ‘‰ Tuy nhiÃªn, cáº§n lÆ°u Ã½ ráº±ng viá»‡c sá»­ dá»¥ng polling cÃ³ thá»ƒ gÃ¢y tá»‘n tÃ i nguyÃªn máº¡ng vÃ  hiá»‡u nÄƒng á»©ng dá»¥ng. Náº¿u khÃ´ng cáº§n thiáº¿t, nÃªn xem xÃ©t sá»­ dá»¥ng cÃ¡c phÆ°Æ¡ng phÃ¡p khÃ¡c nhÆ° long polling hoáº·c sá»± kiá»‡n Ä‘áº©y (push events) Ä‘á»ƒ giáº£m táº£i vÃ  tá»‘i Æ°u hÃ³a quÃ¡ trÃ¬nh cáº­p nháº­t dá»¯ liá»‡u.

=> ğŸš€ğŸ“Œ TÃ³m láº¡i, `RTK Query` cung cáº¥p má»™t giáº£i phÃ¡p toÃ n diá»‡n vÃ  tiá»‡n lá»£i cho viá»‡c quáº£n lÃ½ truy váº¥n vÃ  mutations tá»« API, giÃºp giáº£m thiá»ƒu cÃ´ng viá»‡c láº·p láº¡i, tá»‘i Æ°u hiá»‡u suáº¥t vÃ  cung cáº¥p cÃ¡c tÃ­nh nÄƒng máº¡nh máº½ nhÆ° `caching` vÃ  `invalidation`.

## Æ¯u Ä‘iá»ƒm vÃ  khuyáº¿t Ä‘iá»ƒm khi sá»­ dá»¥ng RTK Query ?

- âŒâŒâŒâŒ Æ¯u Ä‘iá»ƒm âŒâŒâŒâŒ

- âœ…âœ… Khi sá»­ dá»¥ng RTK Query, báº¡n sáº½ táº­n hÆ°á»Ÿng má»™t sá»‘ Æ°u Ä‘iá»ƒm sau:

  - `Dá»… sá»­ dá»¥ng`: RTK Query cung cáº¥p cÃº phÃ¡p Ä‘Æ¡n giáº£n vÃ  gá»n gÃ ng Ä‘á»ƒ táº¡o vÃ  quáº£n lÃ½ cÃ¡c truy váº¥n vÃ  mutations tá»« API. NÃ³ giáº£m thiá»ƒu khá»‘i lÆ°á»£ng mÃ£ vÃ  Ä‘Æ¡n giáº£n hÃ³a quy trÃ¬nh láº­p trÃ¬nh.

  - `TÃ­ch há»£p sáºµn vá»›i Redux Toolkit`: RTK Query Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ tÃ­ch há»£p sáºµn vá»›i Redux Toolkit, má»™t cÃ´ng cá»¥ máº¡nh máº½ cho quáº£n lÃ½ tráº¡ng thÃ¡i á»©ng dá»¥ng. Äiá»u nÃ y Ä‘áº£m báº£o sá»± tÆ°Æ¡ng thÃ­ch vÃ  tÃ­ch há»£p dá»… dÃ ng vá»›i Redux store vÃ  `middleware`.

  - `TÃ­nh nÄƒng caching tá»± Ä‘á»™ng`: RTK Query cung cáº¥p tÃ­nh nÄƒng `caching` dá»¯ liá»‡u tá»± Ä‘á»™ng. Khi báº¡n thá»±c hiá»‡n má»™t truy váº¥n, káº¿t quáº£ sáº½ Ä‘Æ°á»£c lÆ°u trá»¯ trong bá»™ nhá»› `cache`, vÃ  cÃ¡c truy váº¥n tÆ°Æ¡ng tá»± sau Ä‘Ã³ sáº½ sá»­ dá»¥ng dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c lÆ°u trá»¯ tá»« `cache` thay vÃ¬ gá»­i yÃªu cáº§u má»›i Ä‘áº¿n API. Äiá»u nÃ y giÃºp tiáº¿t kiá»‡m tÃ i nguyÃªn máº¡ng vÃ  tÄƒng tá»‘c Ä‘á»™ pháº£n há»“i.

  - `Invalidations tá»± Ä‘á»™ng`: RTK Query há»— trá»£ invalidations tá»± Ä‘á»™ng. Khi dá»¯ liá»‡u trong `cache` háº¿t háº¡n hoáº·c khÃ´ng cÃ²n Ä‘Ãºng, RTK Query sáº½ tá»± Ä‘á»™ng lÃ m má»›i dá»¯ liá»‡u báº±ng cÃ¡ch gá»­i yÃªu cáº§u má»›i Ä‘áº¿n API. Äiá»u nÃ y Ä‘áº£m báº£o ráº±ng dá»¯ liá»‡u Ä‘Æ°á»£c cáº­p nháº­t vÃ  chÃ­nh xÃ¡c.

  - `Xá»­ lÃ½ side effects tá»± Ä‘á»™ng`: RTK Query giÃºp tá»± Ä‘á»™ng xá»­ lÃ½ cÃ¡c side effects nhÆ° xá»­ lÃ½ lá»—i, tÃ¡i truy váº¥n khi máº¥t káº¿t ná»‘i, hoáº·c thá»±c hiá»‡n cÃ¡c hÃ nh Ä‘á»™ng phá»¥ liÃªn quan Ä‘áº¿n dá»¯ liá»‡u. Báº¡n khÃ´ng cáº§n pháº£i viáº¿t nhiá»u mÃ£ xá»­ lÃ½ tÆ°Æ¡ng tÃ¡c vá»›i API, RTK Query sáº½ tá»± Ä‘á»™ng quáº£n lÃ½ vÃ  xá»­ lÃ½ cÃ¡c tÃ¡c vá»¥ phá»¥ liÃªn quan.

  - `Há»— trá»£ TypeScript`: RTK Query há»— trá»£ tá»‘t `TypeScript`, cho phÃ©p báº¡n kiá»ƒm tra kiá»ƒu dá»¯ liá»‡u vÃ  phÃ¡t hiá»‡n lá»—i má»™t cÃ¡ch dá»… dÃ ng. CÃº phÃ¡p máº¡nh máº½ cá»§a RTK Query cÅ©ng giÃºp kiá»ƒm soÃ¡t vÃ  Ä‘á»‹nh nghÄ©a rÃµ rÃ ng cÃ¡c kiá»ƒu dá»¯ liá»‡u.

=> ğŸš€ğŸ“Œ Tá»•ng thá»ƒ, RTK Query mang láº¡i nhiá»u Æ°u Ä‘iá»ƒm cho viá»‡c quáº£n lÃ½ tráº¡ng thÃ¡i á»©ng dá»¥ng vÃ  tÆ°Æ¡ng tÃ¡c vá»›i API, giÃºp báº¡n giáº£m thiá»ƒu cÃ´ng sá»©c láº­p trÃ¬nh vÃ  tÄƒng hiá»‡u suáº¥t á»©ng dá»¥ng.

- âŒâŒâŒâŒ Khuyáº¿t Ä‘iá»ƒm âŒâŒâŒâŒ

- âœ…âœ… Máº·c dÃ¹ RTK Query cÃ³ nhiá»u Æ°u Ä‘iá»ƒm, nhÆ°ng cÅ©ng cÃ³ má»™t sá»‘ khuyáº¿t Ä‘iá»ƒm sau:

  - `Há»c há»i ban Ä‘áº§u`: RTK Query cÃ³ má»™t cÃº phÃ¡p riÃªng vÃ  yÃªu cáº§u má»™t giai Ä‘oáº¡n há»c há»i ban Ä‘áº§u Ä‘á»ƒ hiá»ƒu cÃ¡ch sá»­ dá»¥ng vÃ  cáº¥u hÃ¬nh chÃ­nh xÃ¡c. Äiá»u nÃ y cÃ³ thá»ƒ lÃ m tÄƒng Ä‘á»™ dá»‘c há»c táº­p vÃ  táº¡o ra má»™t thá»i gian thÃ­ch á»©ng ban Ä‘áº§u.

  - `Giá»›i háº¡n tÃ¹y chá»‰nh`: Máº·c dÃ¹ RTK Query cung cáº¥p nhiá»u tÃ­nh nÄƒng máº¡nh máº½, cÃ³ thá»ƒ cÃ³ má»™t sá»‘ trÆ°á»ng há»£p sá»­ dá»¥ng Ä‘áº·c biá»‡t mÃ  yÃªu cáº§u tÃ¹y chá»‰nh phá»©c táº¡p hÆ¡n. Trong nhá»¯ng trÆ°á»ng há»£p nhÆ° váº­y, viá»‡c tÃ¹y chá»‰nh RTK Query cÃ³ thá»ƒ trá»Ÿ nÃªn khÃ³ khÄƒn hoáº·c háº¡n cháº¿.

  - `Phá»¥ thuá»™c vÃ o Redux Toolkit`: RTK Query Ä‘Æ°á»£c tÃ­ch há»£p sáºµn vá»›i Redux Toolkit vÃ  sá»­ dá»¥ng Redux store vÃ  `middleware`. Äiá»u nÃ y cÃ³ nghÄ©a lÃ  náº¿u báº¡n khÃ´ng sá»­ dá»¥ng Redux hoáº·c khÃ´ng muá»‘n sá»­ dá»¥ng Redux Toolkit, viá»‡c tÃ­ch há»£p RTK Query vÃ o dá»± Ã¡n hiá»‡n cÃ³ cÃ³ thá»ƒ gáº·p má»™t sá»‘ khÃ³ khÄƒn.

  - `Háº¡n cháº¿ vá»›i cÃ¡c há»‡ thá»‘ng API phá»©c táº¡p`: RTK Query Ä‘Æ°á»£c thiáº¿t káº¿ cho viá»‡c lÃ m viá»‡c vá»›i cÃ¡c há»‡ thá»‘ng API `RESTful` Ä‘Æ¡n giáº£n. Äá»‘i vá»›i cÃ¡c há»‡ thá»‘ng API phá»©c táº¡p hÆ¡n, cÃ³ thá»ƒ cáº§n pháº£i thá»±c hiá»‡n tÃ¹y chá»‰nh vÃ  má»Ÿ rá»™ng RTK Query Ä‘á»ƒ Ä‘Ã¡p á»©ng cÃ¡c yÃªu cáº§u cá»¥ thá»ƒ.

  - `Hiá»‡u suáº¥t khÃ´ng linh hoáº¡t`: Máº·c dÃ¹ RTK Query cung cáº¥p tÃ­nh nÄƒng caching dá»¯ liá»‡u tá»± Ä‘á»™ng, hiá»‡u suáº¥t khÃ´ng linh hoáº¡t trong má»™t sá»‘ trÆ°á»ng há»£p Ä‘áº·c biá»‡t. Äiá»u nÃ y cÃ³ thá»ƒ xáº£y ra khi dá»¯ liá»‡u thay Ä‘á»•i thÆ°á»ng xuyÃªn hoáº·c khi yÃªu cáº§u truy váº¥n phá»©c táº¡p vá»›i sá»‘ lÆ°á»£ng lá»›n dá»¯ liá»‡u.

=> ğŸš€ğŸ“Œ Tuy nhiÃªn, cÃ¡c khuyáº¿t Ä‘iá»ƒm nÃ y thÆ°á»ng Ä‘Æ°á»£c cÃ¢n nháº¯c vÃ  quáº£n lÃ½ tá»‘t trong háº§u háº¿t cÃ¡c dá»± Ã¡n, vÃ  Æ°u Ä‘iá»ƒm cá»§a RTK Query váº«n Ä‘Æ°á»£c Ä‘Ã¡nh giÃ¡ cao trong viá»‡c phÃ¡t triá»ƒn á»©ng dá»¥ng.

## RTK Query Ä‘Æ°á»£c nhiá»u developer Æ°a chuá»™ng khi lÃ m cÃ¡c dá»± Ã¡n khÃ´ng ?

- RTK Query Ä‘Ã£ nháº­n Ä‘Æ°á»£c sá»± Æ°a chuá»™ng tá»« nhiá»u nhÃ  phÃ¡t triá»ƒn khi lÃ m cÃ¡c dá»± Ã¡n vÃ¬ cÃ¡c lÃ½ do sau:

  - Dá»… sá»­ dá»¥ng: RTK Query Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ Ä‘Æ¡n giáº£n hÃ³a viá»‡c truy váº¥n vÃ  quáº£n lÃ½ dá»¯ liá»‡u tá»« API. NÃ³ cung cáº¥p má»™t cÃº phÃ¡p rÃµ rÃ ng vÃ  dá»… hiá»ƒu, giÃºp giáº£m Ä‘á»™ phá»©c táº¡p cá»§a viá»‡c xá»­ lÃ½ truy váº¥n dá»¯ liá»‡u.

  - TÃ­ch há»£p sáºµn vá»›i Redux Toolkit: RTK Query tÃ­ch há»£p tá»‘t vá»›i Redux Toolkit, mang láº¡i sá»± thuáº­n tiá»‡n vÃ  tÆ°Æ¡ng thÃ­ch vá»›i cÃ¡ch Redux Toolkit xá»­ lÃ½ `store` vÃ  `middleware`. Äiá»u nÃ y giÃºp giáº£m Ä‘á»™ phá»©c táº¡p cá»§a viá»‡c tÃ­ch há»£p vÃ  quáº£n lÃ½ tráº¡ng thÃ¡i á»©ng dá»¥ng.

  - TÃ­nh nÄƒng máº¡nh máº½: RTK Query cung cáº¥p nhiá»u tÃ­nh nÄƒng há»¯u Ã­ch nhÆ° caching tá»± Ä‘á»™ng, `refetching`, `invalidation`, `pagination`, `prefetching`, vÃ  nhiá»u hÆ¡n ná»¯a. CÃ¡c tÃ­nh nÄƒng nÃ y giÃºp giáº£m thá»i gian vÃ  cÃ´ng sá»©c trong viá»‡c xá»­ lÃ½ dá»¯ liá»‡u tá»« API.

  - TÃ­ch há»£p dá»¯ liá»‡u dá»… dÃ ng: RTK Query cho phÃ©p báº¡n Ä‘á»‹nh nghÄ©a cÃ¡c endpoint vÃ  truy váº¥n dá»¯ liá»‡u thÃ´ng qua cÃ¡c tá»‡p slice, giÃºp tá»• chá»©c mÃ£ vÃ  quáº£n lÃ½ dá»¯ liá»‡u má»™t cÃ¡ch cÃ³ tá»• chá»©c. NÃ³ cÅ©ng cho phÃ©p báº¡n tÃ¹y chá»‰nh cÃ¡c truy váº¥n dá»±a trÃªn nhu cáº§u cá»¥ thá»ƒ cá»§a á»©ng dá»¥ng.

  - TÃ­ch há»£p tá»‘t vá»›i UI frameworks: RTK Query cÃ³ kháº£ nÄƒng tÃ­ch há»£p tá»‘t vá»›i cÃ¡c framework UI phá»• biáº¿n nhÆ° React, Angular vÃ  Vue. Äiá»u nÃ y giÃºp cho viá»‡c phÃ¡t triá»ƒn á»©ng dá»¥ng dá»… dÃ ng vÃ  linh hoáº¡t hÆ¡n trong mÃ´i trÆ°á»ng phÃ¡t triá»ƒn phá»• biáº¿n.

=> ğŸš€ğŸ“Œ TÃ³m láº¡i, RTK Query Ä‘Ã£ trá»Ÿ thÃ nh má»™t lá»±a chá»n phá»• biáº¿n cho nhiá»u nhÃ  phÃ¡t triá»ƒn khi lÃ m cÃ¡c dá»± Ã¡n, nhá» vÃ o tÃ­nh Ä‘Æ¡n giáº£n, tÃ­ch há»£p vá»›i Redux Toolkit vÃ  cÃ¡c tÃ­nh nÄƒng máº¡nh máº½ giÃºp giáº£m cÃ´ng sá»©c vÃ  thá»i gian trong viá»‡c quáº£n lÃ½ dá»¯ liá»‡u tá»« API.

## Cho vÃ­ dá»¥ vá» RTK Query ?

- DÆ°á»›i Ä‘Ã¢y lÃ  má»™t vÃ­ dá»¥ Ä‘Æ¡n giáº£n vá» viá»‡c sá»­ dá»¥ng RTK Query trong má»™t á»©ng dá»¥ng React Ä‘á»ƒ truy váº¥n vÃ  quáº£n lÃ½ dá»¯ liá»‡u tá»« má»™t API:

- Äáº§u tiÃªn, chÃºng ta cáº§n cÃ i Ä‘áº·t cÃ¡c thÆ° viá»‡n cáº§n thiáº¿t:

```jsx
npm install @reduxjs/toolkit react-redux @reduxjs/toolkit/query
```

- Tiáº¿p theo, chÃºng ta sáº½ Ä‘á»‹nh nghÄ©a má»™t slice sá»­ dá»¥ng RTK Query Ä‘á»ƒ truy váº¥n dá»¯ liá»‡u tá»« API. VÃ­ dá»¥ sau Ä‘Ã¢y sá»­ dá»¥ng slice Ä‘á»ƒ láº¥y danh sÃ¡ch ngÆ°á»i dÃ¹ng tá»« API:

âœ…âœ…âœ…âœ… Äoáº¡n code 1: âœ…âœ…âœ…âœ…

```jsx
// user.slice.js

import { createSlice } from "@reduxjs/toolkit";
import { createAsyncThunk } from "@reduxjs/toolkit/query";

// Äá»‹nh nghÄ©a truy váº¥n
export const fetchUsers = createAsyncThunk("users/fetchUsers", async () => {
  const response = await fetch("/api/users");
  const data = await response.json();
  return data;
});

// Äá»‹nh nghÄ©a slice
const userSlice = createSlice({
  name: "users",
  initialState: [],
  reducers: {},
  extraReducers: (builder) => {
    builder.addCase(fetchUsers.fulfilled, (state, action) => {
      return action.payload;
    });
  },
});

export default userSlice.reducer;
```

âœ…âœ…âœ…âœ…âŒâŒ DÆ°á»›i Ä‘Ã¢y lÃ  phÃ¢n tÃ­ch vÃ  giáº£i thÃ­ch tá»«ng Ä‘oáº¡n code trÃªn âŒâŒâœ…âœ…âœ…âœ…

```jsx
import { createSlice } from "@reduxjs/toolkit";
import { createAsyncThunk } from "@reduxjs/toolkit/query";
```

- âœ… Äoáº¡n code trÃªn cÃ³ Ã½ nghÄ©a:

- Trong Ä‘oáº¡n code trÃªn, chÃºng ta sá»­ dá»¥ng hai phÆ°Æ¡ng thá»©c Ä‘Æ°á»£c cung cáº¥p bá»Ÿi thÆ° viá»‡n `@reduxjs/toolkit` Ä‘á»ƒ táº¡o slice vÃ  truy váº¥n báº¥t Ä‘á»“ng bá»™ (async).

- `createSlice`: ÄÃ¢y lÃ  má»™t hÃ m Ä‘Æ°á»£c cung cáº¥p bá»Ÿi Redux Toolkit Ä‘á»ƒ táº¡o ra má»™t slice trong Redux. Slice lÃ  má»™t pháº§n cá»§a store Redux, chá»©a cÃ¡c reducers vÃ  actions liÃªn quan Ä‘áº¿n má»™t pháº§n cá»§a á»©ng dá»¥ng. ChÃºng ta import `createSlice` tá»« `@reduxjs/toolkit` Ä‘á»ƒ táº¡o slice má»›i.

- `createAsyncThunk`: ÄÃ¢y lÃ  má»™t hÃ m cung cáº¥p bá»Ÿi Redux Toolkit Ä‘á»ƒ táº¡o ra má»™t action async Ä‘Æ°á»£c xá»­ lÃ½ bá»Ÿi Redux Thunk middleware. HÃ m nÃ y nháº­n vÃ o má»™t tÃªn Ä‘á»‹nh danh cho action vÃ  má»™t hÃ m async thá»±c hiá»‡n cÃ¡c cÃ´ng viá»‡c báº¥t Ä‘á»“ng bá»™, vÃ­ dá»¥ nhÆ° gá»i API. HÃ m nÃ y tráº£ vá» má»™t action creator, cho phÃ©p chÃºng ta gá»­i cÃ¡c action async nÃ y vÃ  xá»­ lÃ½ káº¿t quáº£ cá»§a chÃºng trong reducers.

=> Tá»•ng káº¿t, Ä‘oáº¡n code trÃªn sá»­ dá»¥ng createSlice Ä‘á»ƒ táº¡o má»™t slice má»›i trong Redux vÃ  createAsyncThunk Ä‘á»ƒ táº¡o má»™t action async Ä‘Æ°á»£c xá»­ lÃ½ bá»Ÿi Redux Thunk middleware. ÄÃ¢y lÃ  cÃ¡c hÃ m quan trá»ng trong Redux Toolkit giÃºp chÃºng ta dá»… dÃ ng quáº£n lÃ½ state vÃ  xá»­ lÃ½ cÃ¡c tÃ¡c vá»¥ báº¥t Ä‘á»“ng bá»™ trong á»©ng dá»¥ng Redux.

```jsx
export const fetchUsers = createAsyncThunk("users/fetchUsers", async () => {
  const response = await fetch("/api/users");
  const data = await response.json();
  return data;
});
```

- Trong Ä‘oáº¡n code trÃªn, chÃºng ta táº¡o má»™t action async cÃ³ tÃªn lÃ  "`users/fetchUsers`" sá»­ dá»¥ng `createAsyncThunk` tá»« Redux Toolkit. Action nÃ y Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ gá»­i má»™t yÃªu cáº§u API Ä‘áº¿n Ä‘Æ°á»ng dáº«n "`/api/users`" Ä‘á»ƒ láº¥y danh sÃ¡ch ngÆ°á»i dÃ¹ng.

- Khi action "users/fetchUsers" Ä‘Æ°á»£c gá»i, Redux Thunk middleware sáº½ báº¯t Ä‘áº§u xá»­ lÃ½ action nÃ y. Trong hÃ m async Ä‘Æ°á»£c truyá»n vÃ o `createAsyncThunk`, chÃºng ta sá»­ dá»¥ng `fetch` Ä‘á»ƒ gá»­i má»™t yÃªu cáº§u GET Ä‘áº¿n "`/api/users`" vÃ  Ä‘á»£i pháº£n há»“i tá»« server.

- Khi pháº£n há»“i Ä‘Æ°á»£c nháº­n, chÃºng ta sá»­ dá»¥ng `response.json()` Ä‘á»ƒ chuyá»ƒn Ä‘á»•i dá»¯ liá»‡u pháº£n há»“i tá»« Ä‘á»‹nh dáº¡ng `JSON` sang dáº¡ng Ä‘á»‘i tÆ°á»£ng (`object`) cá»§a JavaScript. Káº¿t quáº£ dá»¯ liá»‡u JSON chuyá»ƒn Ä‘á»•i Ä‘Æ°á»£c tráº£ vá» tá»« hÃ m `async` vÃ  tá»± Ä‘á»™ng trá»Ÿ thÃ nh `payload` cá»§a `action`.

- CÃ¡c reducers cá»§a chÃºng ta cÃ³ thá»ƒ Ä‘Äƒng kÃ½ Ä‘á»ƒ láº¯ng nghe action "`users/fetchUsers`" vÃ  xá»­ lÃ½ káº¿t quáº£ cá»§a nÃ³. Khi `action` Ä‘Æ°á»£c `dispatch`, Redux Thunk middleware sáº½ thá»±c thi hÃ m `async` Ä‘Ã£ Ä‘Æ°á»£c truyá»n vÃ o `createAsyncThunk` vÃ  cáº­p nháº­t tráº¡ng thÃ¡i cá»§a action dá»±a trÃªn káº¿t quáº£ tráº£ vá» tá»« hÃ m async.

- Äiá»u nÃ y cho phÃ©p chÃºng ta gá»­i yÃªu cáº§u API má»™t cÃ¡ch dá»… dÃ ng vÃ  xá»­ lÃ½ káº¿t quáº£ má»™t cÃ¡ch tá»± Ä‘á»™ng trong Redux, giÃºp chÃºng ta quáº£n lÃ½ tráº¡ng thÃ¡i vÃ  tÆ°Æ¡ng tÃ¡c vá»›i dá»¯ liá»‡u tá»« API má»™t cÃ¡ch tiá»‡n lá»£i.

- Äoáº¡n code trÃªn sáº½ táº¡o ra má»™t action creator cÃ³ tÃªn `fetchUsers`, mÃ  chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng Ä‘á»ƒ dispatch action nÃ y vÃ  xá»­ lÃ½ káº¿t quáº£ trong reducers cá»§a chÃºng ta. Khi action nÃ y Ä‘Æ°á»£c dispatch, Redux Thunk middleware sáº½ thá»±c thi hÃ m `async` Ä‘Ã£ Ä‘Æ°á»£c truyá»n vÃ o `createAsyncThunk` vÃ  cáº­p nháº­t tráº¡ng thÃ¡i cá»§a action dá»±a trÃªn káº¿t quáº£ tráº£ vá» tá»« hÃ m async.

âŒâŒâŒâŒ ğŸ‘†ğŸ‘†ğŸ‘† LÆ°u Ã½ trong Ä‘oáº¡n giáº£i thÃ­ch trÃªn: ğŸ‘†ğŸ‘†ğŸ‘† âŒâŒâŒâŒ

- Trong Ä‘oáº¡n giáº£i thÃ­ch code á»Ÿ trÃªn cÃ³ Ä‘á» cáº­p Ä‘áº¿n tá»« `tráº¡ng thÃ¡i cá»§a action`. LÆ°u Ã½ Ä‘Ã³ khÃ´ng pháº£i lÃ  payload cá»§a action. ChÃºng ta hÃ£y tÃ¬m hiá»ƒu vá» nÃ³ lÃ  cÃ¡i gÃ¬ ?

- Tráº¡ng thÃ¡i cá»§a action khÃ´ng pháº£i lÃ  payload cá»§a action Ä‘Ã³. Tráº¡ng thÃ¡i cá»§a action chá»‰ Ä‘Æ¡n giáº£n lÃ  má»™t thuá»™c tÃ­nh (property) cá»§a action, thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ biá»ƒu thá»‹ tráº¡ng thÃ¡i cá»§a má»™t cÃ´ng viá»‡c khÃ´ng Ä‘á»“ng bá»™ (async).

- Khi sá»­ dá»¥ng `createAsyncThunk`, Redux Toolkit tá»± Ä‘á»™ng táº¡o ra cÃ¡c tráº¡ng thÃ¡i cho action tÆ°Æ¡ng á»©ng vá»›i cÃ¡c tráº¡ng thÃ¡i cá»§a cÃ´ng viá»‡c async: `pending`, `fulfilled`, vÃ  `rejected`. CÃ¡c tráº¡ng thÃ¡i nÃ y khÃ´ng pháº£i lÃ  payload cá»§a action, mÃ  lÃ  cÃ¡c thuá»™c tÃ­nh cá»§a action Ä‘á»ƒ biá»ƒu thá»‹ tráº¡ng thÃ¡i cá»§a cÃ´ng viá»‡c.

- VÃ­ dá»¥, khi action `users/fetchUsers` Ä‘Æ°á»£c gá»i, nÃ³ cÃ³ thá»ƒ cÃ³ cÃ¡c tráº¡ng thÃ¡i nhÆ° sau:

- `users/fetchUsers/pending`: ÄÆ°á»£c gá»­i khi cÃ´ng viá»‡c Ä‘ang Ä‘Æ°á»£c thá»±c hiá»‡n.
- `users/fetchUsers/fulfilled`: ÄÆ°á»£c gá»­i khi cÃ´ng viá»‡c hoÃ n thÃ nh thÃ nh cÃ´ng, kÃ¨m theo payload lÃ  káº¿t quáº£ tráº£ vá» tá»« hÃ m async.
- `users/fetchUsers/rejected`: ÄÆ°á»£c gá»­i khi cÃ´ng viá»‡c bá»‹ tá»« chá»‘i hoáº·c lá»—i xáº£y ra, kÃ¨m theo payload lÃ  thÃ´ng tin lá»—i.

=> Payload cá»§a action Ä‘Æ°á»£c chá»©a trong thuá»™c tÃ­nh `payload` cá»§a action, khÃ´ng pháº£i lÃ  tráº¡ng thÃ¡i cá»§a action. Tráº¡ng thÃ¡i cá»§a action Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ theo dÃµi quÃ¡ trÃ¬nh thá»±c hiá»‡n cá»§a cÃ´ng viá»‡c vÃ  thá»±c hiá»‡n cÃ¡c xá»­ lÃ½ phÃ¹ há»£p trong reducer.

```jsx
const userSlice = createSlice({
  name: "users",
  initialState: [],
  reducers: {},
  extraReducers: (builder) => {
    builder.addCase(fetchUsers.fulfilled, (state, action) => {
      return action.payload;
    });
  },
});
```

- Äoáº¡n code trÃªn Ä‘á»‹nh nghÄ©a má»™t slice cá»§a Redux Toolkit cÃ³ tÃªn lÃ  "users" (name: "users"). Slice nÃ y sáº½ quáº£n lÃ½ tráº¡ng thÃ¡i liÃªn quan Ä‘áº¿n ngÆ°á»i dÃ¹ng (users).

  - `initialState` Ä‘á»‹nh nghÄ©a tráº¡ng thÃ¡i ban Ä‘áº§u cá»§a slice, á»Ÿ Ä‘Ã¢y lÃ  má»™t máº£ng rá»—ng (initialState: []).
  - `reducers` lÃ  má»™t Ä‘á»‘i tÆ°á»£ng chá»©a cÃ¡c reducer (hÃ m xá»­ lÃ½ action) tÆ°Æ¡ng á»©ng vá»›i cÃ¡c action Ä‘Æ°á»£c gá»­i Ä‘áº¿n slice. Trong vÃ­ dá»¥ nÃ y, khÃ´ng cÃ³ reducer nÃ o Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a (reducers: {}), nÃªn slice chá»‰ sá»­ dá»¥ng reducers Ä‘Æ°á»£c táº¡o ra bá»Ÿi `extraReducers`.
  - `extraReducers` lÃ  má»™t hÃ m callback nháº­n vÃ o má»™t Ä‘á»‘i tÆ°á»£ng builder, cho phÃ©p chÃºng ta xÃ¡c Ä‘á»‹nh cÃ¡c reducer cho cÃ¡c action khÃ´ng thuá»™c reducers Ä‘Ã£ Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trÆ°á»›c Ä‘Ã³. Trong vÃ­ dá»¥ nÃ y, chá»‰ cÃ³ má»™t reducer Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a thÃ´ng qua `builder.addCase`.
  - `builder.addCase` xÃ¡c Ä‘á»‹nh má»™t reducer cho má»™t action cá»¥ thá»ƒ. Trong vÃ­ dá»¥ nÃ y, reducer Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh cho action `fetchUsers.fulfilled`, tá»©c lÃ  khi action `fetchUsers` hoÃ n thÃ nh thÃ nh cÃ´ng.
  - Trong reducer, tráº¡ng thÃ¡i hiá»‡n táº¡i cá»§a slice (`state`) Ä‘Æ°á»£c cáº­p nháº­t báº±ng payload cá»§a action (`action.payload`). Äiá»u nÃ y cÃ³ nghÄ©a lÃ  khi action `fetchUsers.fulfilled` Ä‘Æ°á»£c gá»­i vÃ  thÃ nh cÃ´ng, tráº¡ng thÃ¡i cá»§a slice "users" sáº½ Ä‘Æ°á»£c cáº­p nháº­t thÃ nh dá»¯ liá»‡u ngÆ°á»i dÃ¹ng Ä‘Æ°á»£c tráº£ vá» tá»« hÃ m `fetchUsers`.

- Vá»›i Ä‘oáº¡n code trÃªn, khi action `fetchUsers.fulfilled` Ä‘Æ°á»£c gá»i vÃ  hoÃ n thÃ nh thÃ nh cÃ´ng, tráº¡ng thÃ¡i cá»§a slice "users" sáº½ Ä‘Æ°á»£c cáº­p nháº­t vá»›i dá»¯ liá»‡u ngÆ°á»i dÃ¹ng má»›i.

```jsx
export default userSlice.reducer;
```

- Äoáº¡n code trÃªn xuáº¥t ra reducer cá»§a slice Ä‘Æ°á»£c táº¡o bá»Ÿi `createSlice`. `createSlice` tráº£ vá» má»™t Ä‘á»‘i tÆ°á»£ng slice gá»“m cÃ¡c reducer Ä‘Ã£ Ä‘Æ°á»£c tá»± Ä‘á»™ng táº¡o ra dá»±a trÃªn cÃ¡c hÃ nh Ä‘á»™ng Ä‘Ã£ Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh trong `reducers` vÃ  `extraReducers`.

- Trong trÆ°á»ng há»£p nÃ y, `userSlice.reducer` lÃ  reducer Ä‘Æ°á»£c táº¡o ra bá»Ÿi slice `userSlice`. Báº±ng cÃ¡ch xuáº¥t reducer nÃ y, chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng nÃ³ Ä‘á»ƒ káº¿t há»£p vá»›i cÃ¡c reducer khÃ¡c vÃ  táº¡o ra store trong Redux.

âœ…âœ…âœ…âœ… Äoáº¡n code 2: âœ…âœ…âœ…âœ…

- Sau Ä‘Ã³, chÃºng ta cáº§n khai bÃ¡o RTK Query API Ä‘á»ƒ sá»­ dá»¥ng trong á»©ng dá»¥ng. VÃ­ dá»¥ sau Ä‘Ã¢y khai bÃ¡o má»™t API Ä‘á»ƒ láº¥y danh sÃ¡ch ngÆ°á»i dÃ¹ng:

```jsx
// api.js

import { createApi, fetchBaseQuery } from "@reduxjs/toolkit/query";

export const userApi = createApi({
  reducerPath: "userApi",
  baseQuery: fetchBaseQuery({ baseUrl: "/api" }),
  endpoints: (builder) => ({
    getUsers: builder.query({
      query: () => "users",
    }),
  }),
});

export const { useGetUsersQuery } = userApi;
```

âœ…âœ…âœ…âœ…âŒâŒ DÆ°á»›i Ä‘Ã¢y lÃ  phÃ¢n tÃ­ch vÃ  giáº£i thÃ­ch tá»«ng Ä‘oáº¡n code trÃªn âŒâŒâœ…âœ…âœ…âœ…

```jsx
import { createApi, fetchBaseQuery } from "@reduxjs/toolkit/query";
```

- Äoáº¡n code trÃªn sá»­ dá»¥ng `createApi` vÃ  `fetchBaseQuery` tá»« Redux Toolkit Query Ä‘á»ƒ táº¡o ra má»™t API client. `createApi` lÃ  má»™t hÃ m giÃºp xÃ¢y dá»±ng API client cho viá»‡c thá»±c hiá»‡n cÃ¡c yÃªu cáº§u truy váº¥n dá»¯ liá»‡u tá»« API.

- `fetchBaseQuery` lÃ  má»™t trong nhá»¯ng phÆ°Æ¡ng thá»©c máº·c Ä‘á»‹nh Ä‘Æ°á»£c cung cáº¥p bá»Ÿi Redux Toolkit Query (`RTK Query`) Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c yÃªu cáº§u HTTP thÃ´ng qua `fetch`. NÃ³ lÃ  má»™t fetch base query function cho phÃ©p báº¡n tÃ¹y chá»‰nh vÃ  cáº¥u hÃ¬nh cÃ¡c yÃªu cáº§u HTTP trÆ°á»›c khi gá»­i lÃªn server.

- Khi sá»­ dá»¥ng `createApi` vÃ  `fetchBaseQuery` káº¿t há»£p, chÃºng ta cÃ³ thá»ƒ xÃ¢y dá»±ng má»™t API client vá»›i cÃ¡c phÆ°Æ¡ng thá»©c truy váº¥n dá»¯ liá»‡u nhÆ° `query`, `mutation`, vÃ  `subscription` Ä‘á»ƒ gá»­i cÃ¡c yÃªu cáº§u tÆ°Æ¡ng á»©ng Ä‘áº¿n server.

```jsx
export const userApi = createApi({
  reducerPath: "userApi",
  baseQuery: fetchBaseQuery({
    baseUrl: "/api",
  }),
  endpoints: (builder) => ({
    getUsers: builder.query({
      query: () => "users",
    }),
  }),
});
```

- Äoáº¡n code trÃªn sá»­ dá»¥ng `createApi` tá»« Redux Toolkit Query Ä‘á»ƒ táº¡o má»™t API client cho viá»‡c truy váº¥n dá»¯ liá»‡u tá»« API.

- `reducerPath` lÃ  tÃªn cá»§a reducer Ä‘Æ°á»£c táº¡o ra bá»Ÿi API client, sáº½ Ä‘Æ°á»£c sá»­ dá»¥ng trong viá»‡c Ä‘Äƒng kÃ½ reducer vá»›i Redux store.

- `baseQuery` lÃ  má»™t fetch base query function Ä‘Æ°á»£c cung cáº¥p bá»Ÿi Redux Toolkit Query. Trong vÃ­ dá»¥ nÃ y, `fetchBaseQuery` Ä‘Æ°á»£c cáº¥u hÃ¬nh vá»›i `baseUrl` lÃ  `"/api"` trong nhá»¯ng trÆ°á»ng há»£p khÃ¡c cÃ³ `api tá»« server` thÃ¬ `baseUrl` lÃ  (http://localhost:4000/), Ä‘Ã¢y lÃ  Ä‘Æ°á»ng dáº«n gá»‘c mÃ  táº¥t cáº£ cÃ¡c yÃªu cáº§u truy váº¥n sáº½ Ä‘Æ°á»£c gá»­i Ä‘áº¿n.

- `endpoints` lÃ  má»™t hÃ m callback nháº­n vÃ o má»™t Ä‘á»‘i tÆ°á»£ng `builder`, Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ Ä‘á»‹nh nghÄ©a cÃ¡c endpoints cho API client. Trong vÃ­ dá»¥ nÃ y, chá»‰ cÃ³ má»™t endpoint lÃ  `getUsers` bÃªn trong API client. Endpoint nÃ y Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a dÆ°á»›i dáº¡ng má»™t query.

  - `builder.query()` lÃ  má»™t phÆ°Æ¡ng thá»©c cá»§a Ä‘á»‘i tÆ°á»£ng `builder` Ä‘á»ƒ Ä‘á»‹nh nghÄ©a má»™t query endpoint.
  - Trong trÆ°á»ng há»£p nÃ y, query endpoint `getUsers` khÃ´ng cÃ³ tham sá»‘ truyá»n vÃ o vÃ  sáº½ gá»­i má»™t yÃªu cáº§u truy váº¥n dá»¯ liá»‡u Ä‘áº¿n Ä‘Æ°á»ng dáº«n `"users"`.
  - HÃ m callback truyá»n vÃ o `query` tráº£ vá» giÃ¡ trá»‹ lÃ  `"users"`, Ä‘áº¡i diá»‡n cho Ä‘Æ°á»ng dáº«n cá»§a yÃªu cáº§u truy váº¥n dá»¯ liá»‡u.
  - Khi sá»­ dá»¥ng API client vÃ  gá»i `getUsers`, nÃ³ sáº½ gá»­i má»™t yÃªu cáº§u truy váº¥n dá»¯ liá»‡u Ä‘áº¿n Ä‘Æ°á»ng dáº«n `"users"` vÃ  tráº£ vá» káº¿t quáº£ cá»§a yÃªu cáº§u nÃ y.

- Káº¿t quáº£ cá»§a viá»‡c sá»­ dá»¥ng `createApi` lÃ  má»™t API client object cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ gá»­i cÃ¡c yÃªu cáº§u truy váº¥n dá»¯ liá»‡u tá»« server thÃ´ng qua cÃ¡c endpoints Ä‘Ã£ Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a.

```jsx
export const { useGetUsersQuery } = userApi;
```

âŒâŒâŒâŒ LÆ°u Ã½: hÃ£y hiá»ƒu rÃµ chá»— nÃ y nhÃ© !!! âŒâŒâŒâŒ

- ÄÃºng lÃ  trong Ä‘oáº¡n code trÃªn khÃ´ng cÃ³ Ä‘á»‹nh nghÄ©a `useGetUsersQuery` trá»±c tiáº¿p. Thá»±c táº¿, `useGetUsersQuery` Ä‘Æ°á»£c táº¡o tá»± Ä‘á»™ng bá»Ÿi RTK Query khi chÃºng ta sá»­ dá»¥ng `builder.query` Ä‘á»ƒ Ä‘á»‹nh nghÄ©a endpoint `getUsers`.

- Khi chÃºng ta sá»­ dá»¥ng `builder.query` Ä‘á»ƒ Ä‘á»‹nh nghÄ©a má»™t endpoint, RTK Query sáº½ tá»± Ä‘á»™ng táº¡o ra má»™t hook dá»±a trÃªn tÃªn cá»§a endpoint vÃ  Ä‘á»‹nh nghÄ©a cá»§a nÃ³. Trong trÆ°á»ng há»£p nÃ y, vÃ¬ chÃºng ta Ä‘Ã£ Ä‘á»‹nh nghÄ©a endpoint cÃ³ tÃªn lÃ  `getUsers`, RTK Query sáº½ tá»± Ä‘á»™ng táº¡o ra hook `useGetUsersQuery` Ä‘á»ƒ sá»­ dá»¥ng.

- Do Ä‘Ã³, khi chÃºng ta sá»­ dá»¥ng destructuring assignment nhÆ° `export const { useGetUsersQuery } = userApi;`, nÃ³ sáº½ giÃºp chÃºng ta truy cáº­p trá»±c tiáº¿p vÃ o hook `useGetUsersQuery` Ä‘Ã£ Ä‘Æ°á»£c táº¡o ra bá»Ÿi RTK Query, mÃ  khÃ´ng cáº§n pháº£i Ä‘á»‹nh nghÄ©a nÃ³ má»™t cÃ¡ch rÃµ rÃ ng trong mÃ£ nguá»“n cá»§a chÃºng ta.

- Äoáº¡n code trÃªn Ä‘á»‹nh nghÄ©a má»™t hÃ m hook cÃ³ tÃªn lÃ  `useGetUsersQuery` thÃ´ng qua API client `userApi`.

  - `useGetUsersQuery` lÃ  má»™t hÃ m hook Ä‘Æ°á»£c táº¡o tá»± Ä‘á»™ng bá»Ÿi RTK Query dá»±a trÃªn endpoint `getUsers` mÃ  chÃºng ta Ä‘Ã£ Ä‘á»‹nh nghÄ©a trÆ°á»›c Ä‘Ã³.
  - Khi sá»­ dá»¥ng `useGetUsersQuery`, ta cÃ³ thá»ƒ gá»i nÃ³ trong cÃ¡c thÃ nh pháº§n React Ä‘á»ƒ thá»±c hiá»‡n yÃªu cáº§u truy váº¥n dá»¯ liá»‡u vÃ  láº¥y káº¿t quáº£ tráº£ vá» tá»« API server.
  - HÃ m `useGetUsersQuery` sáº½ tá»± Ä‘á»™ng quáº£n lÃ½ tráº¡ng thÃ¡i yÃªu cáº§u cháº³ng háº¡n nhÆ° (loading, error, data) vÃ  cung cáº¥p cÃ¡c giÃ¡ trá»‹ liÃªn quan cho chÃºng, cho phÃ©p chÃºng ta dá»… dÃ ng sá»­ dá»¥ng káº¿t quáº£ truy váº¥n trong thÃ nh pháº§n React mÃ  khÃ´ng cáº§n pháº£i viáº¿t nhiá»u mÃ£ xá»­ lÃ½ tÃ¹y chá»‰nh.

âœ…âœ…âœ…âœ… Äoáº¡n code 3: âœ…âœ…âœ…âœ…

- Tiáº¿p theo, chÃºng ta cáº§n cáº¥u hÃ¬nh store Redux vÃ  káº¿t ná»‘i API cá»§a chÃºng ta:

```jsx
// store.js

import { configureStore } from "@reduxjs/toolkit";
import { userApi } from "./api";
import userReducer from "./user.slice";

export const store = configureStore({
  reducer: {
    users: userReducer,
    [userApi.reducerPath]: userApi.reducer,
  },
  middleware: (getDefaultMiddleware) =>
    getDefaultMiddleware().concat(userApi.middleware),
});

export default store;
```

âœ…âœ…âœ…âœ…âŒâŒ DÆ°á»›i Ä‘Ã¢y lÃ  phÃ¢n tÃ­ch vÃ  giáº£i thÃ­ch tá»«ng Ä‘oáº¡n code trÃªn âŒâŒâœ…âœ…âœ…âœ…

```jsx
import { configureStore } from "@reduxjs/toolkit";
import { userApi } from "./api";
import userReducer from "./user.slice";
```

- Äoáº¡n code trÃªn cÃ³ má»¥c Ä‘Ã­ch cáº¥u hÃ¬nh Redux store vÃ  káº¿t há»£p cÃ¡c pháº§n cáº§n thiáº¿t Ä‘á»ƒ sá»­ dá»¥ng RTK Query.

- `configureStore` lÃ  má»™t hÃ m Ä‘Æ°á»£c cung cáº¥p bá»Ÿi Redux Toolkit Ä‘á»ƒ táº¡o Redux store. NÃ³ nháº­n vÃ o má»™t Ä‘á»‘i tÆ°á»£ng cáº¥u hÃ¬nh vá»›i cÃ¡c thuá»™c tÃ­nh nhÆ° `reducer`, `middleware`, `preloadedState`, vÃ  cÃ¡c tÃ¹y chá»n khÃ¡c.

- `userApi` Ä‘Æ°á»£c import tá»« module `./api` vÃ  lÃ  má»™t instance cá»§a API Ä‘Æ°á»£c táº¡o ra bá»Ÿi RTK Query thÃ´ng qua hÃ m createApi. Äá»‘i tÆ°á»£ng nÃ y Ä‘á»‹nh nghÄ©a cÃ¡c endpoints Ä‘á»ƒ gá»­i cÃ¡c yÃªu cáº§u liÃªn quan Ä‘áº¿n ngÆ°á»i dÃ¹ng (vÃ­ dá»¥: `getUsers`).

- `userReducer` Ä‘Æ°á»£c import tá»« module `./user.slice` vÃ  lÃ  má»™t reducer Ä‘Æ°á»£c táº¡o ra báº±ng cÃ¡ch sá»­ dá»¥ng Redux Toolkit `createSlice`. Reducer nÃ y quáº£n lÃ½ tráº¡ng thÃ¡i cá»§a ngÆ°á»i dÃ¹ng trong Redux store.

```jsx
export const store = configureStore({
  reducer: {
    users: userReducer,
    [userApi.reducerPath]: userApi.reducer,
  },
  middleware: (getDefaultMiddleware) =>
    getDefaultMiddleware().concat(userApi.middleware),
});
```

- Äoáº¡n code trÃªn cÃ³ má»¥c Ä‘Ã­ch cáº¥u hÃ¬nh Redux store sá»­ dá»¥ng Redux Toolkit vÃ  tÃ­ch há»£p RTK Query vÃ o trong á»©ng dá»¥ng.

- `store` lÃ  má»™t biáº¿n lÆ°u trá»¯ Redux store Ä‘Æ°á»£c táº¡o ra báº±ng cÃ¡ch sá»­ dá»¥ng hÃ m `configureStore` cá»§a Redux Toolkit.

- Trong Ä‘á»‘i tÆ°á»£ng cáº¥u hÃ¬nh cá»§a `configureStore`, chÃºng ta Ä‘á»‹nh nghÄ©a thuá»™c tÃ­nh `reducer` vÃ  `middleware`.

  - Thuá»™c tÃ­nh `reducer` lÃ  má»™t Ä‘á»‘i tÆ°á»£ng mÃ´ táº£ cÃ¡c reducer trong á»©ng dá»¥ng. Trong trÆ°á»ng há»£p nÃ y, chÃºng ta cÃ³ má»™t reducer lÃ  `userReducer` quáº£n lÃ½ tráº¡ng thÃ¡i ngÆ°á»i dÃ¹ng. Äá»“ng thá»i, chÃºng ta sá»­ dá»¥ng `userApi.reducer` Ä‘á»ƒ quáº£n lÃ½ tráº¡ng thÃ¡i liÃªn quan Ä‘áº¿n RTK Query.
  - Thuá»™c tÃ­nh `[userApi.reducerPath]` lÃ  má»™t cÃº phÃ¡p Ä‘áº·c biá»‡t Ä‘á»ƒ xÃ¡c Ä‘á»‹nh tÃªn cá»§a reducer liÃªn quan Ä‘áº¿n RTK Query. Äiá»u nÃ y cho phÃ©p RTK Query quáº£n lÃ½ tráº¡ng thÃ¡i cá»§a cÃ¡c endpoints Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trong `userApi`.

- Thuá»™c tÃ­nh `middleware` lÃ  má»™t hÃ m nháº­n vÃ o `getDefaultMiddleware` vÃ  tráº£ vá» má»™t máº£ng cÃ¡c middleware. Trong trÆ°á»ng há»£p nÃ y, chÃºng ta sá»­ dá»¥ng `getDefaultMiddleware` Ä‘á»ƒ láº¥y danh sÃ¡ch cÃ¡c middleware máº·c Ä‘á»‹nh cá»§a Redux Toolkit. Sau Ä‘Ã³, chÃºng ta káº¿t há»£p cÃ¡c middleware máº·c Ä‘á»‹nh vá»›i `userApi.middleware` Ä‘á»ƒ tÃ­ch há»£p middleware cá»§a RTK Query vÃ o Redux store.

- Káº¿t quáº£ lÃ  `store` Ä‘Æ°á»£c táº¡o ra sáº½ cÃ³ cáº¥u hÃ¬nh sáºµn vá»›i reducer quáº£n lÃ½ tráº¡ng thÃ¡i ngÆ°á»i dÃ¹ng vÃ  tráº¡ng thÃ¡i liÃªn quan Ä‘áº¿n RTK Query, cÃ¹ng vá»›i `middleware` Ä‘á»ƒ xá»­ lÃ½ cÃ¡c `action` vÃ  gá»­i cÃ¡c yÃªu cáº§u liÃªn quan Ä‘áº¿n RTK Query.

```jsx
export default store;
```

- DÃ²ng code `export default store;` Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ xuáº¥t giÃ¡ trá»‹ cá»§a biáº¿n store ra khá»i module hiá»‡n táº¡i Ä‘á»ƒ cÃ³ thá»ƒ sá»­ dá»¥ng trong cÃ¡c module khÃ¡c.

- Khi má»™t module Ä‘Æ°á»£c xuáº¥t dÆ°á»›i dáº¡ng `default`, nghÄ©a lÃ  nÃ³ lÃ  giÃ¡ trá»‹ máº·c Ä‘á»‹nh cá»§a module Ä‘Ã³. Trong trÆ°á»ng há»£p nÃ y, `store` lÃ  giÃ¡ trá»‹ máº·c Ä‘á»‹nh cá»§a module vÃ  nÃ³ Ä‘Æ°á»£c xuáº¥t ra Ä‘á»ƒ cÃ³ thá»ƒ Ä‘Æ°á»£c import vÃ  sá»­ dá»¥ng trong cÃ¡c module khÃ¡c cá»§a á»©ng dá»¥ng.

âœ…âœ…âœ…âœ… Äoáº¡n code 4: âœ…âœ…âœ…âœ…

- Cuá»‘i cÃ¹ng, trong component React, chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng hook useGetUsersQuery Ä‘á»ƒ truy váº¥n dá»¯ liá»‡u tá»« API vÃ  hiá»ƒn thá»‹ danh sÃ¡ch ngÆ°á»i dÃ¹ng:

```jsx
// UserList.js

import React from "react";
import { useGetUsersQuery } from "./api";

const UserList = () => {
  const { data, error, isLoading } = useGetUsersQuery();

  if (isLoading) {
    return <div>Loading...</div>;
  }

  if (error) {
    return <div>Error: {error.message}</div>;
  }

  return (
    <ul>
      {data.map((user) => (
        <li key={user.id}>{user.name}</li>
      ))}
    </ul>
  );
};

export default UserList;
```

âœ…âœ…âœ…âœ…âŒâŒ DÆ°á»›i Ä‘Ã¢y lÃ  phÃ¢n tÃ­ch vÃ  giáº£i thÃ­ch tá»«ng Ä‘oáº¡n code trÃªn âŒâŒâœ…âœ…âœ…âœ…

- Äoáº¡n code trÃªn lÃ  má»™t React functional component Ä‘Æ°á»£c gá»i lÃ  `UserList`. NÃ³ sá»­ dá»¥ng hook `useGetUsersQuery` tá»« module `./api` Ä‘á»ƒ truy váº¥n danh sÃ¡ch ngÆ°á»i dÃ¹ng.

- CÃ¡ch useGetUsersQuery hoáº¡t Ä‘á»™ng trong code: khi `useGetUsersQuery` Ä‘Æ°á»£c gá»i, nÃ³ tráº£ vá» má»™t `object` cÃ³ cÃ¡c thuá»™c tÃ­nh nhÆ° `data`, `error`, vÃ  `isLoading` Ä‘á»ƒ quáº£n lÃ½ tráº¡ng thÃ¡i truy váº¥n. Trong trÆ°á»ng há»£p nÃ y:

  - `data` chá»©a dá»¯ liá»‡u tráº£ vá» tá»« truy váº¥n, Ä‘Ã¢y lÃ  má»™t máº£ng cÃ¡c Ä‘á»‘i tÆ°á»£ng ngÆ°á»i dÃ¹ng.
  - `error` chá»©a thÃ´ng tin lá»—i náº¿u truy váº¥n khÃ´ng thÃ nh cÃ´ng.
  - `isLoading` chá»‰ Ä‘á»‹nh xem truy váº¥n Ä‘ang trong quÃ¡ trÃ¬nh táº£i hay khÃ´ng.

- Dá»±a trÃªn cÃ¡c giÃ¡ trá»‹ trÃªn, component `UserList` render ra má»™t danh sÃ¡ch ngÆ°á»i dÃ¹ng. Náº¿u `isLoading` lÃ  `true`, component hiá»ƒn thá»‹ thÃ´ng bÃ¡o "Loading...". Náº¿u cÃ³ lá»—i xáº£y ra, component hiá»ƒn thá»‹ thÃ´ng bÃ¡o lá»—i vá»›i ná»™i dung tá»« `error.message`. Khi dá»¯ liá»‡u Ä‘Ã£ táº£i thÃ nh cÃ´ng, component hiá»ƒn thá»‹ danh sÃ¡ch ngÆ°á»i dÃ¹ng báº±ng cÃ¡ch láº·p qua máº£ng `data` vÃ  hiá»ƒn thá»‹ tÃªn cá»§a má»—i ngÆ°á»i dÃ¹ng.

- Cuá»‘i cÃ¹ng, component `UserList` Ä‘Æ°á»£c export máº·c Ä‘á»‹nh Ä‘á»ƒ cÃ³ thá»ƒ sá»­ dá»¥ng trong cÃ¡c module khÃ¡c cá»§a á»©ng dá»¥ng.

- ğŸ‘‰ Tá»•ng quan láº¡i: vá»›i vÃ­ dá»¥ trÃªn, chÃºng ta Ä‘Ã£ sá»­ dá»¥ng RTK Query Ä‘á»ƒ truy váº¥n danh sÃ¡ch ngÆ°á»i dÃ¹ng tá»« API vÃ  hiá»ƒn thá»‹ káº¿t quáº£ trong má»™t component React. RTK Query sáº½ tá»± Ä‘á»™ng quáº£n lÃ½ `caching` vÃ  `refetching` dá»¯ liá»‡u, giÃºp tá»‘i Æ°u hiá»‡u suáº¥t vÃ  tiáº¿t kiá»‡m cÃ´ng sá»©c trong viá»‡c truy váº¥n dá»¯ liá»‡u tá»« API.

## RTK Query sá»­ dá»¥ng trong trÆ°á»ng há»£p nÃ o ?

- `RTK Query` Ä‘Æ°á»£c sá»­ dá»¥ng trong cÃ¡c trÆ°á»ng há»£p sau:

- Truy váº¥n dá»¯ liá»‡u tá»« API: `RTK Query` cung cáº¥p má»™t cÃ¡ch tiá»‡n lá»£i Ä‘á»ƒ truy váº¥n dá»¯ liá»‡u tá»« API. Báº¡n cÃ³ thá»ƒ Ä‘á»‹nh nghÄ©a cÃ¡c endpoint vÃ  `RTK Query` sáº½ tá»± Ä‘á»™ng táº¡o ra cÃ¡c hÃ m truy váº¥n vÃ  cÃ¡c tráº¡ng thÃ¡i liÃªn quan Ä‘á»ƒ quáº£n lÃ½ dá»¯ liá»‡u vÃ  xá»­ lÃ½ cÃ¡c tráº¡ng thÃ¡i truy váº¥n.

- Caching dá»¯ liá»‡u: `RTK Query` há»— trá»£ tÃ­nh nÄƒng caching dá»¯ liá»‡u tá»± Ä‘á»™ng. Khi báº¡n truy váº¥n dá»¯ liá»‡u tá»« API, `RTK Query` sáº½ tá»± Ä‘á»™ng lÆ°u trá»¯ káº¿t quáº£ truy váº¥n vÃ  kiá»ƒm tra cÃ¡c phiÃªn báº£n cache Ä‘á»ƒ tráº£ vá» dá»¯ liá»‡u lÆ°u trá»¯ thay vÃ¬ gá»­i yÃªu cáº§u truy váº¥n má»›i Ä‘áº¿n API. Äiá»u nÃ y giÃºp tÄƒng tá»‘c Ä‘á»™ vÃ  giáº£m táº£i cho á»©ng dá»¥ng cá»§a báº¡n.

- Tá»± Ä‘á»™ng invalidation: `RTK Query` cung cáº¥p cÆ¡ cháº¿ tá»± Ä‘á»™ng invalidation khi dá»¯ liá»‡u háº¿t háº¡n hoáº·c khÃ´ng cÃ²n Ä‘Ãºng. Khi báº¡n thá»±c hiá»‡n cÃ¡c thao tÃ¡c sá»­a Ä‘á»•i dá»¯ liá»‡u (thÃªm (`POST`), cáº­p nháº­t (`PUT`), xÃ³a (`DELETE`)) thÃ´ng qua `RTK Query`, nÃ³ sáº½ tá»± Ä‘á»™ng xÃ³a dá»¯ liá»‡u cache tÆ°Æ¡ng á»©ng Ä‘á»ƒ Ä‘áº£m báº£o dá»¯ liá»‡u má»›i nháº¥t Ä‘Æ°á»£c truy váº¥n tá»« API. NÃ³i má»™t cÃ¡ch dá»… hiá»ƒu nÃ³ cÃ³ nghÄ©a lÃ : Tá»± Ä‘á»™ng gá»i API láº¡i khi cÃ³ cÃ¡c thay Ä‘á»•i liÃªn quan Ä‘áº¿n dá»¯ liá»‡u. NÃ³ lÃ  má»™t hÃ m cÃ³ tÃªn lÃ  `invalidatesTags`

- Quáº£n lÃ½ tráº¡ng thÃ¡i truy váº¥n: `RTK Query` quáº£n lÃ½ tráº¡ng thÃ¡i truy váº¥n tá»± Ä‘á»™ng. Báº¡n cÃ³ thá»ƒ dá»… dÃ ng kiá»ƒm tra tráº¡ng thÃ¡i truy váº¥n nhÆ° Ä‘ang loading, Ä‘Ã£ hoÃ n thÃ nh, hoáº·c cÃ³ lá»—i Ä‘á»ƒ Ä‘iá»u chá»‰nh hiá»ƒn thá»‹ vÃ  xá»­ lÃ½ trong giao diá»‡n ngÆ°á»i dÃ¹ng.

- TÃ­ch há»£p vá»›i Redux Toolkit: `RTK Query` Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ tÃ­ch há»£p sáºµn vá»›i Redux Toolkit, giÃºp Ä‘Æ¡n giáº£n hÃ³a viá»‡c quáº£n lÃ½ state vÃ  sá»­ dá»¥ng cÃ¡c cÃ´ng cá»¥ vÃ  tÃ­nh nÄƒng cá»§a Redux Toolkit.

=> TÃ³m láº¡i: `RTK Query` giÃºp cho viá»‡c xÃ¢y dá»±ng á»©ng dá»¥ng React cÃ³ tÆ°Æ¡ng tÃ¡c vá»›i API dá»… dÃ ng, hiá»‡u quáº£ vÃ  háº¡n cháº¿ Ä‘Æ°á»£c nhiá»u cÃ´ng viá»‡c láº·p láº¡i trong quÃ¡ trÃ¬nh quáº£n lÃ½ tráº¡ng thÃ¡i vÃ  truy váº¥n dá»¯ liá»‡u.

âœ…âœ…âœ…âœ… DÆ°á»›i Ä‘Ã¢y lÃ  docs cá»§a ÄÆ°á»£c Dev âœ…âœ…âœ…âœ…

# RTK query

## RTK query lÃ  gÃ¬?

RTK query lÃ  thÆ° viá»‡n thuá»™c há»‡ sinh thÃ¡i Redux giÃºp chÃºng ta quáº£n lÃ½ viá»‡c gá»i API vÃ  caching dá»… dÃ ng.

### LÃ½ do RTK query xuáº¥t hiá»‡n

GiÃºp chÃºng ta háº¡n cháº¿ nhá»¯ng viá»‡c láº·p Ä‘i láº·p láº¡i trong quÃ¡ trÃ¬nh fetch data.

Äá»ƒ fetch data trong React

- Khai bÃ¡o useEffect vÃ  gá»i API trong Ä‘Ã³
- Xá»­ lÃ½ cleanup function Ä‘á»ƒ trÃ¡nh viá»‡c gá»i duplicate data
- Tracking tráº¡ng thÃ¡i loading Ä‘á»ƒ hiá»ƒn thá»‹ skeleton
- Quáº£n lÃ½ thá»i gian cache khi user tÆ°Æ¡ng tÃ¡c vá»›i UI

Nhá»¯ng viá»‡c nÃ y khÃ´ng khÃ³, nhÆ°ng nÃ³ nhiá»u, náº¿u nhiá»u component cáº§n implement cÃ¡i nÃ y thÃ¬ khÃ¡ má»‡t. Náº¿u dÃ¹ng vá»›i Redux thÃ¬ má»‡t hÆ¡n ná»¯a khi má»—i láº§n gá»i API pháº£i khai bÃ¡o action, thunk cÃ¡c kiá»ƒu. Ngay cáº£ khi khi chÃºng ta sá»­ dá»¥ng `createAsyncThunk` cÃ¹ng vá»›i `createSlice` thÃ¬ váº«n cÃ²n nhá»¯ng háº¡n cháº¿ khi chÃºng ta pháº£i tá»± quáº£n lÃ½ state loading hay trÃ¡nh gá»i duplicate request.

Nhá»¯ng nÄƒm gáº§n Ä‘Ã¢y, cá»™ng Ä‘á»“ng React nháº­n ra ráº±ng **fetch data vÃ  caching cÅ©ng lÃ  má»™t ná»—i lo khÃ¡c cÃ¹ng vá»›i viá»‡c quáº£n lÃ½ state**.

RTK Query láº¥y cáº£m há»©ng tá»« nhá»¯ng thÆ° viá»‡n nhÆ° Apollo Client, React Query, Urql vÃ  SWR nhÆ°ng Ä‘Æ°á»£c build trÃªn Redux Toolkit

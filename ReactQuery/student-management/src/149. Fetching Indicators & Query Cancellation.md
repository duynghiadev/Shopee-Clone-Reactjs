## ÄÃ¢y lÃ  Docs tá»± Research:

- â“ ÄÃ¢y lÃ  cÃ¡c cÃ¢u há»i trong video:

- LÃ m sao Ä‘á»ƒ `getQueriesData` nÃ³ láº¥y dá»¯ liá»‡u má»›i nháº¥t nhá»‰, thÆ°á»ng nÃ³ chá»‰ láº¥y láº§n Ä‘áº§u `fetchapi` ?

  - ğŸ‘‰ Trong React Query, khi báº¡n gá»i phÆ°Æ¡ng thá»©c `getQueriesData` Ä‘á»ƒ láº¥y dá»¯ liá»‡u tá»« cache, nÃ³ sáº½ tráº£ vá» dá»¯ liá»‡u má»›i nháº¥t tá»« cache náº¿u cÃ³ sáºµn. Tuy nhiÃªn, náº¿u dá»¯ liá»‡u chÆ°a cÃ³ trong cache hoáº·c náº¿u cache Ä‘Ã£ háº¿t háº¡n (stale), React Query sáº½ tá»± Ä‘á»™ng thá»±c hiá»‡n má»™t cuá»™c gá»i máº¡ng Ä‘á»ƒ láº¥y dá»¯ liá»‡u má»›i nháº¥t tá»« nguá»“n dá»¯ liá»‡u (API cháº³ng háº¡n).

  - Khi báº¡n thá»±c hiá»‡n má»™t query láº§n Ä‘áº§u tiÃªn báº±ng cÃ¡ch sá»­ dá»¥ng hook `useQuery`, React Query sáº½ gá»­i má»™t yÃªu cáº§u máº¡ng Ä‘á»ƒ láº¥y dá»¯ liá»‡u tá»« nguá»“n dá»¯ liá»‡u vÃ  lÆ°u trá»¯ káº¿t quáº£ trong cache. Khi báº¡n gá»i `getQueriesData`, náº¿u dá»¯ liá»‡u trong cache váº«n cÃ²n há»£p lá»‡ (chÆ°a háº¿t háº¡n), React Query sáº½ tráº£ vá» dá»¯ liá»‡u Ä‘Ã³ mÃ  khÃ´ng gá»­i yÃªu cáº§u máº¡ng. Tuy nhiÃªn, náº¿u dá»¯ liá»‡u Ä‘Ã£ háº¿t háº¡n, React Query sáº½ tá»± Ä‘á»™ng gá»i API Ä‘á»ƒ láº¥y dá»¯ liá»‡u má»›i nháº¥t vÃ  cáº­p nháº­t cache trÆ°á»›c khi tráº£ vá» káº¿t quáº£ cho `getQueriesData`.

  - VÃ¬ váº­y, khi sá»­ dá»¥ng `getQueriesData`, báº¡n cÃ³ thá»ƒ yÃªn tÃ¢m ráº±ng dá»¯ liá»‡u tráº£ vá» sáº½ lÃ  phiÃªn báº£n má»›i nháº¥t tá»« nguá»“n dá»¯ liá»‡u, ngay cáº£ khi cache Ä‘Ã£ háº¿t háº¡n. React Query sáº½ tá»± Ä‘á»™ng quáº£n lÃ½ quÃ¡ trÃ¬nh cáº­p nháº­t dá»¯ liá»‡u vÃ  Ä‘áº£m báº£o báº¡n nháº­n Ä‘Æ°á»£c dá»¯ liá»‡u má»›i nháº¥t khi cáº§n thiáº¿t.

---

- â“ ChÆ°a hiá»ƒu cÃ¡ch tháº±ng react query nÃ y cÃ³ thá»ƒ thay tháº¿ cho redux chá»— nÃ o? Tháº±ng nÃ y dá»±a vÃ o key thÃ¬ quáº£n lÃ½ key kiá»ƒu gÃ¬ trong project cho khá»i loáº¡n Ä‘Ã¢y ?

  - ğŸ‘‰ Redux cÅ©ng dá»±a vÃ o key Ä‘á»ƒ phÃ¢n biá»‡t `action` mÃ , Váº¥n Ä‘á» redux lÃ  nÃ³ rÆ°á»m rÃ  (Ã½ kiáº¿n nÃ y á»Ÿ trong bÃ i há»c)

  - ğŸ‘‰ Tá»± Search: ğŸ‘ˆ

  - React Query khÃ´ng thay tháº¿ Redux hoÃ n toÃ n, nhÆ°ng nÃ³ cung cáº¥p má»™t giáº£i phÃ¡p hiá»‡u quáº£ cho viá»‡c quáº£n lÃ½ tráº¡ng thÃ¡i á»©ng dá»¥ng vÃ  tÆ°Æ¡ng tÃ¡c vá»›i nguá»“n dá»¯ liá»‡u.

  - Redux lÃ  má»™t thÆ° viá»‡n quáº£n lÃ½ tráº¡ng thÃ¡i toÃ n cá»¥c (global), thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ lÆ°u trá»¯ cÃ¡c tráº¡ng thÃ¡i quan trá»ng vÃ  chia sáº» chÃºng giá»¯a cÃ¡c thÃ nh pháº§n trong á»©ng dá»¥ng. Redux há»¯u Ã­ch khi báº¡n cáº§n quáº£n lÃ½ tráº¡ng thÃ¡i phá»©c táº¡p vÃ  cÃ³ nhu cáº§u sá»­ dá»¥ng cÃ¡c `middleware` hoáº·c `side effects`.

  - Trong khi Ä‘Ã³, React Query táº­p trung vÃ o quáº£n lÃ½ dá»¯ liá»‡u liÃªn quan Ä‘áº¿n truy váº¥n vÃ  xá»­ lÃ½ cÃ¡c tÃ¡c vá»¥ máº¡ng. NÃ³ giÃºp báº¡n thá»±c hiá»‡n cÃ¡c truy váº¥n dá»¯ liá»‡u, quáº£n lÃ½ cache vÃ  tá»± Ä‘á»™ng lÃ m má»›i dá»¯ liá»‡u theo thá»i gian thá»±c. React Query táº¡o ra má»™t lá»›p trá»«u tÆ°á»£ng Ä‘á»ƒ xá»­ lÃ½ cÃ¡c hoáº¡t Ä‘á»™ng liÃªn quan Ä‘áº¿n dá»¯ liá»‡u, giÃºp giáº£m bá»›t sá»± phá»©c táº¡p cá»§a viá»‡c quáº£n lÃ½ tráº¡ng thÃ¡i vÃ  tÆ°Æ¡ng tÃ¡c vá»›i dá»¯ liá»‡u tá»« nguá»“n.

  - React Query cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng káº¿t há»£p vá»›i Redux trong má»™t á»©ng dá»¥ng. Báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng Redux Ä‘á»ƒ quáº£n lÃ½ cÃ¡c tráº¡ng thÃ¡i toÃ n cá»¥c vÃ  React Query Ä‘á»ƒ quáº£n lÃ½ cÃ¡c truy váº¥n vÃ  cache dá»¯ liá»‡u. Äiá»u nÃ y giÃºp báº¡n táº­n dá»¥ng Ä‘Æ°á»£c lá»£i Ã­ch cá»§a cáº£ hai thÆ° viá»‡n vÃ  tuá»³ chá»‰nh theo nhu cáº§u cá»¥ thá»ƒ cá»§a dá»± Ã¡n.

  - Vá» viá»‡c quáº£n lÃ½ key trong React Query, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng báº¥t ká»³ loáº¡i key nÃ o phÃ¹ há»£p vá»›i dá»± Ã¡n cá»§a mÃ¬nh. Key thÆ°á»ng Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a dÆ°á»›i dáº¡ng má»™t máº£ng (`array`) hoáº·c má»™t chuá»—i (`string`) Ä‘áº¡i diá»‡n cho truy váº¥n cá»¥ thá»ƒ. Báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡c giÃ¡ trá»‹ duy nháº¥t nhÆ° `ID` ngÆ°á»i dÃ¹ng, tÃªn truy váº¥n, hoáº·c báº¥t ká»³ giÃ¡ trá»‹ nÃ o mÃ  báº¡n cho lÃ  phÃ¹ há»£p Ä‘á»ƒ Ä‘á»‹nh danh truy váº¥n. Äiá»u nÃ y giÃºp React Query xÃ¡c Ä‘á»‹nh vÃ  quáº£n lÃ½ cÃ¡c truy váº¥n riÃªng biá»‡t má»™t cÃ¡ch chÃ­nh xÃ¡c.

---

- ## â“â“â“ CÃ¡c cÃ¢u há»i tháº¯c máº¯c (tá»± research):

## Tá»•ng káº¿t láº¡i chÆ°Æ¡ng React Query ?

- React Query lÃ  má»™t thÆ° viá»‡n quáº£n lÃ½ tráº¡ng thÃ¡i vÃ  cache dá»¯ liá»‡u trong á»©ng dá»¥ng React. NÃ³ cung cáº¥p cÃ¡c khÃ¡i niá»‡m vÃ  API cho phÃ©p tÆ°Æ¡ng tÃ¡c dá»… dÃ ng vá»›i dá»¯ liá»‡u tá»« cÃ¡c nguá»“n khÃ¡c nhau nhÆ° API, localStorage, hay báº¥t ká»³ nguá»“n dá»¯ liá»‡u nÃ o khÃ¡c.

- DÆ°á»›i Ä‘Ã¢y lÃ  nhá»¯ng khÃ¡i niá»‡m chÃ­nh vÃ  tÃ­nh nÄƒng quan trá»ng cá»§a React Query:

1. `Query`: Má»™t query Ä‘áº¡i diá»‡n cho má»™t truy váº¥n dá»¯ liá»‡u tá»« má»™t nguá»“n nháº¥t Ä‘á»‹nh. React Query cung cáº¥p hook `useQuery` Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c truy váº¥n nÃ y.

2. `Mutations`: Mutations Ä‘áº¡i diá»‡n cho cÃ¡c hoáº¡t Ä‘á»™ng thay Ä‘á»•i dá»¯ liá»‡u nhÆ° táº¡o, cáº­p nháº­t hoáº·c xÃ³a. React Query cung cáº¥p hook `useMutation` Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c mutations.

3. `Query Invalidation`: React Query há»— trá»£ viá»‡c lÃ m má»›i (refresh) dá»¯ liá»‡u thÃ´ng qua phÆ°Æ¡ng thá»©c `invalidateQueries`, cho phÃ©p chÃºng ta xÃ³a cache cá»§a má»™t hoáº·c nhiá»u queries.

4. `Automatic Caching`: React Query tá»± Ä‘á»™ng lÆ°u trá»¯ dá»¯ liá»‡u truy váº¥n vÃ  quáº£n lÃ½ viá»‡c cáº­p nháº­t dá»¯ liá»‡u khi cÃ³ sá»± thay Ä‘á»•i. NÃ³ sá»­ dá»¥ng cÆ¡ cháº¿ cache thÃ´ng minh Ä‘á»ƒ táº­n dá»¥ng láº¡i dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c truy váº¥n trÆ°á»›c Ä‘Ã³ mÃ  khÃ´ng cáº§n gá»­i yÃªu cáº§u máº¡ng.

5. `Prefetching`: React Query cung cáº¥p tÃ­nh nÄƒng prefetching, cho phÃ©p chÃºng ta táº£i trÆ°á»›c dá»¯ liá»‡u trong background trÆ°á»›c khi nÃ³ Ä‘Æ°á»£c yÃªu cáº§u, tá»‘i Æ°u hÃ³a tráº£i nghiá»‡m ngÆ°á»i dÃ¹ng.

6. `Optimistic Updates`: TÃ­nh nÄƒng optimistic updates cho phÃ©p chÃºng ta cáº­p nháº­t giao diá»‡n ngay láº­p tá»©c mÃ  khÃ´ng cáº§n chá» Ä‘á»£i pháº£n há»“i tá»« server khi thá»±c hiá»‡n mutations.

- React Query giÃºp tÄƒng hiá»‡u suáº¥t á»©ng dá»¥ng, giáº£m sá»‘ láº§n gá»i máº¡ng khÃ´ng cáº§n thiáº¿t, cung cáº¥p kháº£ nÄƒng xá»­ lÃ½ lá»—i vÃ  cung cáº¥p má»™t cÃ¡ch tiáº¿p cáº­n dá»… dÃ¹ng vÃ  linh hoáº¡t trong quáº£n lÃ½ dá»¯ liá»‡u.

---

## Nhá»¯ng kiáº¿n thá»©c nháº­n Ä‘Æ°á»£c khi há»c xong khoÃ¡ React Query ?

- Khi hoÃ n thÃ nh viá»‡c há»c khoÃ¡ React Query, báº¡n sáº½ cÃ³ kiáº¿n thá»©c vá» cÃ¡c khÃ¡i niá»‡m vÃ  ká»¹ thuáº­t chÃ­nh sau:

1. `CÆ¡ báº£n vá» React Query`: Báº¡n sáº½ hiá»ƒu Ä‘Æ°á»£c React Query lÃ  gÃ¬, táº¡i sao nÃ³ há»¯u Ã­ch trong quáº£n lÃ½ tráº¡ng thÃ¡i vÃ  tÆ°Æ¡ng tÃ¡c dá»¯ liá»‡u trong á»©ng dá»¥ng React.

2. `CÃ¡ch sá»­ dá»¥ng useQuery hook`: Báº¡n sáº½ biáº¿t cÃ¡ch sá»­ dá»¥ng `useQuery` hook Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c truy váº¥n dá»¯ liá»‡u, quáº£n lÃ½ cache vÃ  xá»­ lÃ½ cÃ¡c tráº¡ng thÃ¡i khÃ¡c nhau (nhÆ° loading, error) cá»§a truy váº¥n.

3. `Quáº£n lÃ½ cache dá»¯ liá»‡u`: Báº¡n sáº½ hiá»ƒu cÃ¡ch React Query quáº£n lÃ½ cache dá»¯ liá»‡u vÃ  tá»± Ä‘á»™ng lÃ m má»›i dá»¯ liá»‡u theo thá»i gian thá»±c.

4. `TÃ­ch há»£p vá»›i mutation`: Báº¡n sáº½ biáº¿t cÃ¡ch sá»­ dá»¥ng mutation Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c thao tÃ¡c cáº­p nháº­t dá»¯ liá»‡u thÃªm, sá»­a, xÃ³a (POST, PUT, DELETE) vÃ  lÃ m má»›i cache. LÆ°u Ã½ chá»‰ cÃ³ láº¥y dá»¯ liá»‡u (GET) lÃ  sá»­ dá»¥ng query .

5. `Quáº£n lÃ½ dependencies`: Báº¡n sáº½ hiá»ƒu cÃ¡ch xÃ¡c Ä‘á»‹nh vÃ  quáº£n lÃ½ cÃ¡c phá»¥ thuá»™c giá»¯a cÃ¡c truy váº¥n, cho phÃ©p lÃ m má»›i tá»± Ä‘á»™ng cÃ¡c truy váº¥n liÃªn quan khi cÃ³ thay Ä‘á»•i.

6. `TÃ­ch há»£p vá»›i prefetching`: Báº¡n sáº½ biáº¿t cÃ¡ch sá»­ dá»¥ng tÃ­nh nÄƒng prefetching Ä‘á»ƒ táº£i dá»¯ liá»‡u trÆ°á»›c vÃ  cung cáº¥p tráº£i nghiá»‡m nhanh hÆ¡n cho ngÆ°á»i dÃ¹ng.

7. `TÆ°Æ¡ng tÃ¡c vá»›i cache trá»±c tiáº¿p`: Báº¡n sáº½ hiá»ƒu cÃ¡ch truy cáº­p vÃ  cáº­p nháº­t cache trá»±c tiáº¿p thÃ´ng qua `useQueryClient` hook.

8. `Xá»­ lÃ½ lá»—i vÃ  thÃ´ng bÃ¡o`: Báº¡n sáº½ biáº¿t cÃ¡ch xá»­ lÃ½ lá»—i trong React Query vÃ  hiá»ƒn thá»‹ thÃ´ng bÃ¡o cho ngÆ°á»i dÃ¹ng khi cÃ³ lá»—i xáº£y ra.

9. `Cáº¥u hÃ¬nh vÃ  tÃ¹y chá»‰nh`: Báº¡n sáº½ hiá»ƒu cÃ¡ch cáº¥u hÃ¬nh (config) vÃ  tÃ¹y chá»‰nh (custom) React Query theo nhu cáº§u dá»± Ã¡n, bao gá»“m thá»i gian stale, sá»‘ láº§n tÃ¡i thá»­, Ä‘á»™ Æ°u tiÃªn vÃ  cÃ¡c tÃ¹y chá»n khÃ¡c.

10. `Quáº£n lÃ½ tráº¡ng thÃ¡i á»©ng dá»¥ng`: Báº¡n sáº½ biáº¿t cÃ¡ch sá»­ dá»¥ng React Query Ä‘á»ƒ quáº£n lÃ½ tráº¡ng thÃ¡i á»©ng dá»¥ng vÃ  lÃ m viá»‡c vá»›i cÃ¡c truy váº¥n dá»¯ liá»‡u trong toÃ n bá»™ á»©ng dá»¥ng.

- Vá»›i nhá»¯ng kiáº¿n thá»©c nÃ y, báº¡n sáº½ cÃ³ kháº£ nÄƒng sá»­ dá»¥ng React Query Ä‘á»ƒ xÃ¢y dá»±ng cÃ¡c á»©ng dá»¥ng React hiá»‡u quáº£, quáº£n lÃ½ tráº¡ng thÃ¡i vÃ  tÆ°Æ¡ng tÃ¡c dá»¯ liá»‡u má»™t cÃ¡ch linh hoáº¡t vÃ  dá»… dÃ ng.

---

## Äiá»ƒm máº¡nh vÃ  Ä‘iá»ƒm yáº¿u cá»§a React Query ?

- React Query cÃ³ má»™t sá»‘ Ä‘iá»ƒm máº¡nh vÃ  Ä‘iá»ƒm yáº¿u sau Ä‘Ã¢y:

- âœ… Äiá»ƒm máº¡nh:

  - ÄÆ¡n giáº£n vÃ  dá»… sá»­ dá»¥ng: React Query cung cáº¥p cÃº phÃ¡p dá»… hiá»ƒu vÃ  gá»n nháº¹, giÃºp viá»‡c quáº£n lÃ½ dá»¯ liá»‡u vÃ  thá»±c hiá»‡n cÃ¡c truy váº¥n API trá»Ÿ nÃªn Ä‘Æ¡n giáº£n vÃ  dá»… dÃ ng.

  - Quáº£n lÃ½ bá»™ nhá»› cache máº¡nh máº½: React Query tá»± Ä‘á»™ng quáº£n lÃ½ bá»™ nhá»› cache cho dá»¯ liá»‡u truy váº¥n, giÃºp tÄƒng hiá»‡u suáº¥t vÃ  giáº£m sá»‘ lÆ°á»£ng cuá»™c gá»i API khÃ´ng cáº§n thiáº¿t. CÃ¡c truy váº¥n Ä‘Æ°á»£c lÆ°u trá»¯ trong bá»™ nhá»› cache vÃ  cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ¡i sá»­ dá»¥ng khi cáº§n thiáº¿t.

  - Há»— trá»£ cho táº¥t cáº£ cÃ¡c loáº¡i truy váº¥n: React Query há»— trá»£ cÃ¡c loáº¡i truy váº¥n phong phÃº nhÆ° GET, POST, PUT, DELETE vÃ  cung cáº¥p cÃ¡c phÆ°Æ¡ng thá»©c vÃ  tÃ­nh nÄƒng linh hoáº¡t Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c hoáº¡t Ä‘á»™ng truy váº¥n phá»©c táº¡p.

  - Cung cáº¥p cÃ¡c tÃ­nh nÄƒng tiÃªn tiáº¿n: React Query cung cáº¥p cÃ¡c tÃ­nh nÄƒng máº¡nh máº½ nhÆ° `prefetching`, `pagination`, `realtime` `updates`, vÃ  `optimistic updates`, giÃºp cáº£i thiá»‡n tráº£i nghiá»‡m ngÆ°á»i dÃ¹ng vÃ  tÄƒng kháº£ nÄƒng tÆ°Æ¡ng tÃ¡c cá»§a á»©ng dá»¥ng.

- âŒ Äiá»ƒm yáº¿u:

  - Há»c cÃº phÃ¡p ban Ä‘áº§u: React Query cÃ³ má»™t sá»‘ khÃ¡i niá»‡m má»›i vÃ  pháº£i há»c cÃº phÃ¡p vÃ  cÃ¡c API cá»§a nÃ³. Äiá»u nÃ y cÃ³ thá»ƒ Ä‘Ã²i há»i má»™t thá»i gian Ä‘á»ƒ lÃ m quen vÃ  hiá»ƒu rÃµ cÃ¡ch thá»©c hoáº¡t Ä‘á»™ng cá»§a nÃ³.

  - Phá»¥ thuá»™c vÃ o ká»¹ nÄƒng JavaScript: React Query lÃ  má»™t thÆ° viá»‡n JavaScript vÃ  yÃªu cáº§u báº¡n cÃ³ kiáº¿n thá»©c vá» JavaScript Ä‘á»ƒ sá»­ dá»¥ng hiá»‡u quáº£. Náº¿u báº¡n khÃ´ng quen vá»›i JavaScript, cÃ³ thá»ƒ máº¥t thá»i gian Ä‘á»ƒ lÃ m quen vÃ  thÃ­ch nghi vá»›i React Query.

  - TÃ­ch há»£p vá»›i cÃ¡c cÃ´ng nghá»‡ khÃ¡c: Máº·c dÃ¹ React Query cung cáº¥p cÃ¡c tÃ­nh nÄƒng vÃ  API máº¡nh máº½, nhÆ°ng cÃ³ thá»ƒ cáº§n tÃ­ch há»£p vá»›i cÃ¡c cÃ´ng nghá»‡ khÃ¡c nhÆ° Redux, React Router hoáº·c cÃ¡c thÆ° viá»‡n quáº£n lÃ½ tráº¡ng thÃ¡i khÃ¡c. Viá»‡c tÃ­ch há»£p nÃ y cÃ³ thá»ƒ Ä‘Ã²i há»i kiáº¿n thá»©c bá»• sung vÃ  sá»± Ä‘á»“ng bá»™ giá»¯a cÃ¡c cÃ´ng nghá»‡ khÃ¡c nhau.

  - TÃ³m láº¡i, React Query lÃ  má»™t thÆ° viá»‡n máº¡nh máº½ vÃ  tiá»‡n Ã­ch Ä‘á»ƒ quáº£n lÃ½ dá»¯ liá»‡u vÃ  truy váº¥n API trong á»©ng dá»¥ng React. Máº·c dÃ¹ cÃ³ má»™t sá»‘ Ä‘iá»ƒm yáº¿u, nhÆ°ng vá»›i nhá»¯ng Ä‘iá»ƒm máº¡nh cá»§a nÃ³, nÃ³ Ä‘Ã£ trá»Ÿ thÃ nh má»™t cÃ´ng cá»¥ phá»• biáº¿n cho viá»‡c phÃ¡t triá»ƒn á»©ng dá»¥ng React chuyÃªn nghiá»‡p.

---

## Cho cÃ¡c vÃ­ dá»¥ vá» React Query cÆ¡ báº£n ?

- DÆ°á»›i Ä‘Ã¢y lÃ  má»™t sá»‘ vÃ­ dá»¥ cÆ¡ báº£n vá» viá»‡c sá»­ dá»¥ng React Query:

## 1. Sá»­ dá»¥ng `useQuery` Ä‘á»ƒ truy váº¥n dá»¯ liá»‡u tá»« API:

```jsx
import { useQuery } from 'react-query'

function UserProfile({ userId }) {
  const { data, isLoading, error } = useQuery('userData', () => fetch(`/api/users/${userId}`).then((res) => res.json()))

  if (isLoading) {
    return <div>Loading...</div>
  }

  if (error) {
    return <div>Error: {error.message}</div>
  }

  return (
    <div>
      <h2>User Profile</h2>
      <p>Name: {data.name}</p>
      <p>Email: {data.email}</p>
    </div>
  )
}
```

â“ Giáº£i thÃ­ch code chi tiáº¿t:

- Äoáº¡n code trÃªn lÃ  má»™t vÃ­ dá»¥ cÆ¡ báº£n vá» viá»‡c sá»­ dá»¥ng React Query Ä‘á»ƒ truy váº¥n dá»¯ liá»‡u tá»« má»™t API. DÆ°á»›i Ä‘Ã¢y lÃ  cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a code:

1. Sá»­ dá»¥ng hook `useQuery` tá»« React Query Ä‘á»ƒ táº¡o má»™t truy váº¥n. Truyá»n vÃ o `userData` lÃ  key Ä‘á»ƒ xÃ¡c Ä‘á»‹nh truy váº¥n nÃ y.

2. Trong hÃ m callback cá»§a `useQuery`, chÃºng ta gá»i `fetch` API Ä‘á»ƒ láº¥y dá»¯ liá»‡u ngÆ°á»i dÃ¹ng tá»« `/api/users/${userId}`. Káº¿t quáº£ tráº£ vá» tá»« API Ä‘Æ°á»£c xá»­ lÃ½ báº±ng phÆ°Æ¡ng thá»©c `res.json()`.

3. Káº¿t quáº£ tráº£ vá» tá»« `useQuery` bao gá»“m `data`, `isLoading` vÃ  `error`.

- `data`: Dá»¯ liá»‡u cá»§a truy váº¥n, trong trÆ°á»ng há»£p nÃ y lÃ  thÃ´ng tin ngÆ°á»i dÃ¹ng nhÆ° name vÃ  email.
- `isLoading`: Tráº¡ng thÃ¡i Ä‘ang táº£i dá»¯ liá»‡u (`isLoading` lÃ  `true`). Náº¿u Ä‘ang táº£i, hiá»ƒn thá»‹ thÃ´ng bÃ¡o `"Loading..."`.
- `error`: Lá»—i xáº£y ra trong quÃ¡ trÃ¬nh truy váº¥n. Náº¿u cÃ³ lá»—i, hiá»ƒn thá»‹ thÃ´ng bÃ¡o lá»—i.

4. Dá»±a vÃ o tráº¡ng thÃ¡i `isLoading` vÃ  `error`, chÃºng ta hiá»ƒn thá»‹ giao diá»‡n tÆ°Æ¡ng á»©ng. Náº¿u Ä‘ang táº£i, hiá»ƒn thá»‹ thÃ´ng bÃ¡o `"Loading..."`. Náº¿u cÃ³ lá»—i, hiá»ƒn thá»‹ thÃ´ng bÃ¡o lá»—i. Náº¿u khÃ´ng cÃ³ lá»—i vÃ  dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c láº¥y thÃ nh cÃ´ng, hiá»ƒn thá»‹ thÃ´ng tin ngÆ°á»i dÃ¹ng bao gá»“m name vÃ  email.

- Vá»›i React Query, chÃºng ta cÃ³ thá»ƒ dá»… dÃ ng thá»±c hiá»‡n viá»‡c truy váº¥n dá»¯ liá»‡u tá»« API vÃ  quáº£n lÃ½ tráº¡ng thÃ¡i cá»§a truy váº¥n. React Query tá»± Ä‘á»™ng quáº£n lÃ½ viá»‡c caching, lÃ m má»›i dá»¯ liá»‡u vÃ  xá»­ lÃ½ cÃ¡c tráº¡ng thÃ¡i liÃªn quan Ä‘áº¿n truy váº¥n. Äiá»u nÃ y giÃºp tiáº¿t kiá»‡m cÃ´ng sá»©c vÃ  giáº£m bá»›t viá»‡c láº·p láº¡i code xá»­ lÃ½ truy váº¥n dá»¯ liá»‡u trong React components.

## 2. Sá»­ dá»¥ng `useMutation` Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c thao tÃ¡c táº¡o, cáº­p nháº­t hoáº·c xÃ³a dá»¯ liá»‡u:

```jsx
import { useMutation } from 'react-query'

function CreateUserForm() {
  const createUser = useMutation((formData) =>
    fetch('/api/users', {
      method: 'POST',
      body: JSON.stringify(formData)
    }).then((res) => res.json())
  )

  const handleSubmit = (e) => {
    e.preventDefault()
    const formData = new FormData(e.target)
    createUser.mutate(Object.fromEntries(formData))
  }

  return (
    <form onSubmit={handleSubmit}>
      <input type='text' name='name' placeholder='Name' required />
      <input type='email' name='email' placeholder='Email' required />
      <button type='submit' disabled={createUser.isLoading}>
        {createUser.isLoading ? 'Creating...' : 'Create User'}
      </button>
    </form>
  )
}
```

â“ Giáº£i thÃ­ch code chi tiáº¿t:

- Äoáº¡n code trÃªn lÃ  má»™t vÃ­ dá»¥ vá» viá»‡c sá»­ dá»¥ng `useMutation` tá»« React Query Ä‘á»ƒ thá»±c hiá»‡n má»™t mutation, cá»¥ thá»ƒ lÃ  táº¡o má»›i ngÆ°á»i dÃ¹ng thÃ´ng qua API.

- DÆ°á»›i Ä‘Ã¢y lÃ  cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a code:

1. Sá»­ dá»¥ng hook `useMutation` tá»« React Query Ä‘á»ƒ táº¡o má»™t mutation. Truyá»n vÃ o má»™t hÃ m callback, trong Ä‘Ã³ chÃºng ta sá»­ dá»¥ng `fetch` API Ä‘á»ƒ gá»­i má»™t yÃªu cáº§u POST Ä‘áº¿n `/api/users` vá»›i dá»¯ liá»‡u Ä‘Æ°á»£c láº¥y tá»« `formData`. Káº¿t quáº£ tráº£ vá» tá»« API Ä‘Æ°á»£c xá»­ lÃ½ báº±ng phÆ°Æ¡ng thá»©c `res.json()`.

2. `useMutation` tráº£ vá» má»™t Ä‘á»‘i tÆ°á»£ng cÃ³ cÃ¡c thuá»™c tÃ­nh vÃ  phÆ°Æ¡ng thá»©c liÃªn quan Ä‘áº¿n mutation:

- `mutate`: Má»™t phÆ°Æ¡ng thá»©c Ä‘á»ƒ thá»±c hiá»‡n mutation. Trong trÆ°á»ng há»£p nÃ y, chÃºng ta gá»i `createUser.mutate` Ä‘á»ƒ gá»­i yÃªu cáº§u táº¡o ngÆ°á»i dÃ¹ng vá»›i dá»¯ liá»‡u tá»« `formData`.
- `isLoading`: Tráº¡ng thÃ¡i Ä‘ang táº£i. ChÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng `createUser.isLoading` Ä‘á»ƒ kiá»ƒm tra xem mutation Ä‘ang tiáº¿n hÃ nh hay khÃ´ng.

3. Trong hÃ m `handleSubmit`, chÃºng ta xá»­ lÃ½ sá»± kiá»‡n submit cá»§a form. ChÃºng ta ngÄƒn cháº·n hÃ nh vi máº·c Ä‘á»‹nh cá»§a form báº±ng cÃ¡ch gá»i `e.preventDefault()`. Sau Ä‘Ã³, chÃºng ta táº¡o má»™t Ä‘á»‘i tÆ°á»£ng `formData` tá»« cÃ¡c trÆ°á»ng dá»¯ liá»‡u trong form sá»­ dá»¥ng `new FormData(e.target)`. Cuá»‘i cÃ¹ng, chÃºng ta gá»i `createUser.mutate` vá»›i Ä‘á»‘i sá»‘ lÃ  Ä‘á»‘i tÆ°á»£ng `formData` Ä‘Ã£ Ä‘Æ°á»£c chuyá»ƒn Ä‘á»•i thÃ nh má»™t Ä‘á»‘i tÆ°á»£ng JavaScript thÃ´ng qua `Object.fromEntries(formData)`.

4. Trong pháº§n render, chÃºng ta hiá»ƒn thá»‹ má»™t form vá»›i hai trÆ°á»ng nháº­p dá»¯ liá»‡u (name vÃ  email) vÃ  má»™t nÃºt "Create User" Ä‘á»ƒ gá»­i yÃªu cáº§u táº¡o má»›i ngÆ°á»i dÃ¹ng. NÃºt "Create User" sáº½ bá»‹ vÃ´ hiá»‡u hÃ³a (`disabled`) khi mutation Ä‘ang tiáº¿n hÃ nh (dá»±a trÃªn `createUser.isLoading`). VÄƒn báº£n cá»§a nÃºt cÅ©ng thay Ä‘á»•i tÃ¹y thuá»™c vÃ o tráº¡ng thÃ¡i táº£i (`createUser.isLoading`).

- Vá»›i React Query, chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng `useMutation` Ä‘á»ƒ dá»… dÃ ng thá»±c hiá»‡n cÃ¡c thao tÃ¡c mutation nhÆ° táº¡o, cáº­p nháº­t hoáº·c xÃ³a dá»¯ liá»‡u (POST, PUT, DELETE). React Query sáº½ tá»± Ä‘á»™ng quáº£n lÃ½ tráº¡ng thÃ¡i cá»§a mutation vÃ  cung cáº¥p cÃ¡c phÆ°Æ¡ng thá»©c vÃ  thuá»™c tÃ­nh Ä‘á»ƒ theo dÃµi vÃ  Ä‘iá»u khiá»ƒn quÃ¡ trÃ¬nh mutation.

## 3. Sá»­ dá»¥ng `useQueryClient` Ä‘á»ƒ xÃ³a bá»™ nhá»› cache hoáº·c lÃ m má»›i dá»¯ liá»‡u:

```jsx
import { useQueryClient } from 'react-query'

function ProfilePage({ userId }) {
  const queryClient = useQueryClient()

  const handleLogout = () => {
    // XÃ³a bá»™ nhá»› cache cá»§a táº¥t cáº£ cÃ¡c truy váº¥n
    queryClient.clear()

    // LÃ m má»›i dá»¯ liá»‡u truy váº¥n "userData"
    queryClient.invalidateQueries('userData')
  }

  return (
    <div>
      <h2>Welcome, User!</h2>
      <button onClick={handleLogout}>Logout</button>
    </div>
  )
}
```

â“ Giáº£i thÃ­ch code chi tiáº¿t:

- Äoáº¡n code trÃªn lÃ  má»™t vÃ­ dá»¥ vá» viá»‡c sá»­ dá»¥ng `useQueryClient` tá»« React Query Ä‘á»ƒ quáº£n lÃ½ bá»™ nhá»› cache vÃ  thá»±c hiá»‡n cÃ¡c tÃ¡c vá»¥ liÃªn quan Ä‘áº¿n quáº£n lÃ½ cache vÃ  truy váº¥n.

- DÆ°á»›i Ä‘Ã¢y lÃ  cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a code:

1. Sá»­ dá»¥ng hook `useQueryClient` tá»« React Query Ä‘á»ƒ nháº­n má»™t instance cá»§a `queryClient`, Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ quáº£n lÃ½ bá»™ nhá»› cache vÃ  thá»±c hiá»‡n cÃ¡c thao tÃ¡c liÃªn quan Ä‘áº¿n cache vÃ  truy váº¥n.

2. Trong hÃ m `handleLogout`, chÃºng ta thá»±c hiá»‡n hai tÃ¡c vá»¥:

- `queryClient.clear()`: XÃ³a bá»™ nhá»› cache cá»§a táº¥t cáº£ cÃ¡c truy váº¥n. PhÆ°Æ¡ng thá»©c nÃ y sáº½ xÃ³a háº¿t táº¥t cáº£ cÃ¡c truy váº¥n Ä‘Ã£ Ä‘Æ°á»£c lÆ°u trá»¯ trong cache, Ä‘áº£m báº£o ráº±ng dá»¯ liá»‡u cache Ä‘Æ°á»£c lÃ m má»›i hoÃ n toÃ n.
- `queryClient.invalidateQueries('userData')`: LÃ m má»›i dá»¯ liá»‡u cho truy váº¥n cÃ³ key lÃ  `'userData'`. PhÆ°Æ¡ng thá»©c nÃ y sáº½ xÃ³a cache cá»§a truy váº¥n `'userData'`, Ä‘á»“ng thá»i kÃ­ch hoáº¡t má»™t truy váº¥n má»›i Ä‘á»ƒ láº¥y dá»¯ liá»‡u má»›i nháº¥t tá»« nguá»“n dá»¯ liá»‡u. Äiá»u nÃ y Ä‘áº£m báº£o ráº±ng sau khi Ä‘Äƒng xuáº¥t, khi ngÆ°á»i dÃ¹ng Ä‘Äƒng nháº­p láº¡i, dá»¯ liá»‡u ngÆ°á»i dÃ¹ng má»›i nháº¥t sáº½ Ä‘Æ°á»£c táº£i láº¡i tá»« API.

3. Trong pháº§n render, chÃºng ta hiá»ƒn thá»‹ má»™t tiÃªu Ä‘á» chÃ o má»«ng ngÆ°á»i dÃ¹ng vÃ  má»™t nÃºt `"Logout"` Ä‘á»ƒ thá»±c hiá»‡n Ä‘Äƒng xuáº¥t. Khi ngÆ°á»i dÃ¹ng nháº¥p vÃ o nÃºt `"Logout"`, hÃ m `handleLogout` sáº½ Ä‘Æ°á»£c gá»i Ä‘á»ƒ xÃ³a cache vÃ  lÃ m má»›i dá»¯ liá»‡u truy váº¥n `'userData'`.

- Vá»›i React Query, chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng `useQueryClient` Ä‘á»ƒ truy cáº­p vÃ  quáº£n lÃ½ bá»™ nhá»› cache. ChÃºng ta cÃ³ thá»ƒ xÃ³a cache cá»§a cÃ¡c truy váº¥n cá»¥ thá»ƒ, lÃ m má»›i dá»¯ liá»‡u tá»« nguá»“n dá»¯ liá»‡u vÃ  thá»±c hiá»‡n cÃ¡c tÃ¡c vá»¥ quáº£n lÃ½ cache khÃ¡c.

- âœ… TrÃªn Ä‘Ã¢y lÃ  3 vÃ­ dá»¥ cÆ¡ báº£n Ä‘á»ƒ minh há»a viá»‡c sá»­ dá»¥ng React Query. CÃ³ ráº¥t nhiá»u tÃ­nh nÄƒng vÃ  kháº£ nÄƒng trong React Query Ä‘á»ƒ khÃ¡m phÃ¡ vÃ  tÃ¹y chá»‰nh theo nhu cáº§u cá»§a dá»± Ã¡n.

---

## Cho cÃ¡c vÃ­ dá»¥ vá» React Query nÃ¢ng cao ?

---

## Cho cÃ¡c vÃ­ dá»¥ vá» React Query trong thá»±c táº¿ ?

---

## React query cÃ³ thay tháº¿ redux khÃ´ng ?

---

## Trong cÃ¡c dá»± Ã¡n thÃ¬ cÃ´ng nghá»‡ React Query cÃ³ Ä‘Æ°á»£c sá»­ dá»¥ng nhiá»u khÃ´ng ?

---

## ÄÃ¢y lÃ  Docs cá»§a ÄÆ°á»£c Dev:

Cuá»‘i cÃ¹ng thÃ¬ chÃºng ta cÅ©ng Ä‘Ã£ Ä‘i Ä‘áº¿n video cuá»‘i cÃ¹ng trong series nÃ y, trong video nÃ y thÃ¬ mÃ¬nh sáº½ hÆ°á»›ng dáº«n cÃ¡c báº¡n nhá»¯ng kiáº¿n thá»©c cuá»‘i cÃ¹ng trong React Query. Yay ğŸ˜, hy vá»ng qua series nÃ y cÃ¡c báº¡n Ä‘Ã£ há»c Ä‘Æ°á»£c nhiá»u Ä‘iá»u thÃº vá»‹.

ğŸ’“Kiáº¿n thá»©c cÃ¡c báº¡n sáº½ Ä‘Æ°á»£c há»c trong video nÃ y:

ğŸ‰ Hiá»ƒu rÃµ hÆ¡n cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a fetching vá»›i staleTime
ğŸ‰ Táº¡o spinner loading global dá»±a trÃªn query vÃ  mutation
ğŸ‰ Biáº¿t Ä‘Æ°á»£c cÃ¡ch dÃ¹ng AbortController
ğŸ‰ Cancel Request trong React Query

ğŸ•°ï¸Ná»™i dung chÃ­nh

```bash
00:00 - Ã”n táº­p láº¡i staleTime
07:46 - Fetching Indicators
14:06 - Query Cancellation
```

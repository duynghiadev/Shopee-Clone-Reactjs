## ÄÃ¢y lÃ  Docs tá»± Research:

- â“ ÄÃ¢y lÃ  cÃ¡c cÃ¢u há»i trong video:

- LÃ m sao Ä‘á»ƒ `getQueriesData` nÃ³ láº¥y dá»¯ liá»‡u má»›i nháº¥t nhá»‰, thÆ°á»ng nÃ³ chá»‰ láº¥y láº§n Ä‘áº§u `fetchapi` ?

  - ğŸ‘‰ Trong React Query, khi báº¡n gá»i phÆ°Æ¡ng thá»©c `getQueriesData` Ä‘á»ƒ láº¥y dá»¯ liá»‡u tá»« cache, nÃ³ sáº½ tráº£ vá» dá»¯ liá»‡u má»›i nháº¥t tá»« cache náº¿u cÃ³ sáºµn. Tuy nhiÃªn, náº¿u dá»¯ liá»‡u chÆ°a cÃ³ trong cache hoáº·c náº¿u cache Ä‘Ã£ háº¿t háº¡n (stale), React Query sáº½ tá»± Ä‘á»™ng thá»±c hiá»‡n má»™t cuá»™c gá»i máº¡ng Ä‘á»ƒ láº¥y dá»¯ liá»‡u má»›i nháº¥t tá»« nguá»“n dá»¯ liá»‡u (API cháº³ng háº¡n).

  - Khi báº¡n thá»±c hiá»‡n má»™t query láº§n Ä‘áº§u tiÃªn báº±ng cÃ¡ch sá»­ dá»¥ng hook `useQuery`, React Query sáº½ gá»­i má»™t yÃªu cáº§u máº¡ng Ä‘á»ƒ láº¥y dá»¯ liá»‡u tá»« nguá»“n dá»¯ liá»‡u vÃ  lÆ°u trá»¯ káº¿t quáº£ trong cache. Khi báº¡n gá»i `getQueriesData`, náº¿u dá»¯ liá»‡u trong cache váº«n cÃ²n há»£p lá»‡ (chÆ°a háº¿t háº¡n), React Query sáº½ tráº£ vá» dá»¯ liá»‡u Ä‘Ã³ mÃ  khÃ´ng gá»­i yÃªu cáº§u máº¡ng. Tuy nhiÃªn, náº¿u dá»¯ liá»‡u Ä‘Ã£ háº¿t háº¡n, React Query sáº½ tá»± Ä‘á»™ng gá»i API Ä‘á»ƒ láº¥y dá»¯ liá»‡u má»›i nháº¥t vÃ  cáº­p nháº­t cache trÆ°á»›c khi tráº£ vá» káº¿t quáº£ cho `getQueriesData`.

  - VÃ¬ váº­y, khi sá»­ dá»¥ng `getQueriesData`, báº¡n cÃ³ thá»ƒ yÃªn tÃ¢m ráº±ng dá»¯ liá»‡u tráº£ vá» sáº½ lÃ  phiÃªn báº£n má»›i nháº¥t tá»« nguá»“n dá»¯ liá»‡u, ngay cáº£ khi cache Ä‘Ã£ háº¿t háº¡n. React Query sáº½ tá»± Ä‘á»™ng quáº£n lÃ½ quÃ¡ trÃ¬nh cáº­p nháº­t dá»¯ liá»‡u vÃ  Ä‘áº£m báº£o báº¡n nháº­n Ä‘Æ°á»£c dá»¯ liá»‡u má»›i nháº¥t khi cáº§n thiáº¿t.

---

- â“ ChÆ°a hiá»ƒu cÃ¡ch tháº±ng react query nÃ y cÃ³ thá»ƒ thay tháº¿ cho redux chá»— nÃ o? Tháº±ng nÃ y dá»±a vÃ o key thÃ¬ quáº£n lÃ½ key kiá»ƒu gÃ¬ trong project cho khá»i loáº¡n Ä‘Ã¢y ?

  - ğŸ‘‰ Redux cÅ©ng dá»±a vÃ o key Ä‘á»ƒ phÃ¢n biá»‡t `action` mÃ , Váº¥n Ä‘á» redux lÃ  nÃ³ rÆ°á»m rÃ  (Ã½ kiáº¿n nÃ y á»Ÿ trong bÃ i há»c)

  - ğŸ‘‰ Tá»± Search: ğŸ‘ˆ

  - React Query khÃ´ng thay tháº¿ Redux hoÃ n toÃ n, nhÆ°ng nÃ³ cung cáº¥p má»™t giáº£i phÃ¡p hiá»‡u quáº£ cho viá»‡c quáº£n lÃ½ tráº¡ng thÃ¡i á»©ng dá»¥ng vÃ  tÆ°Æ¡ng tÃ¡c vá»›i nguá»“n dá»¯ liá»‡u.

  - Redux lÃ  má»™t thÆ° viá»‡n quáº£n lÃ½ tráº¡ng thÃ¡i toÃ n cá»¥c (global), thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ lÆ°u trá»¯ cÃ¡c tráº¡ng thÃ¡i quan trá»ng vÃ  chia sáº» chÃºng giá»¯a cÃ¡c thÃ nh pháº§n trong á»©ng dá»¥ng. Redux há»¯u Ã­ch khi báº¡n cáº§n quáº£n lÃ½ tráº¡ng thÃ¡i phá»©c táº¡p vÃ  cÃ³ nhu cáº§u sá»­ dá»¥ng cÃ¡c `middleware` hoáº·c `side effects`.

  - Trong khi Ä‘Ã³, React Query táº­p trung vÃ o quáº£n lÃ½ dá»¯ liá»‡u liÃªn quan Ä‘áº¿n truy váº¥n vÃ  xá»­ lÃ½ cÃ¡c tÃ¡c vá»¥ máº¡ng. NÃ³ giÃºp báº¡n thá»±c hiá»‡n cÃ¡c truy váº¥n dá»¯ liá»‡u, quáº£n lÃ½ cache vÃ  tá»± Ä‘á»™ng lÃ m má»›i dá»¯ liá»‡u theo thá»i gian thá»±c. React Query táº¡o ra má»™t lá»›p trá»«u tÆ°á»£ng Ä‘á»ƒ xá»­ lÃ½ cÃ¡c hoáº¡t Ä‘á»™ng liÃªn quan Ä‘áº¿n dá»¯ liá»‡u, giÃºp giáº£m bá»›t sá»± phá»©c táº¡p cá»§a viá»‡c quáº£n lÃ½ tráº¡ng thÃ¡i vÃ  tÆ°Æ¡ng tÃ¡c vá»›i dá»¯ liá»‡u tá»« nguá»“n.

  - React Query cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng káº¿t há»£p vá»›i Redux trong má»™t á»©ng dá»¥ng. Báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng Redux Ä‘á»ƒ quáº£n lÃ½ cÃ¡c tráº¡ng thÃ¡i toÃ n cá»¥c vÃ  React Query Ä‘á»ƒ quáº£n lÃ½ cÃ¡c truy váº¥n vÃ  cache dá»¯ liá»‡u. Äiá»u nÃ y giÃºp báº¡n táº­n dá»¥ng Ä‘Æ°á»£c lá»£i Ã­ch cá»§a cáº£ hai thÆ° viá»‡n vÃ  tuá»³ chá»‰nh theo nhu cáº§u cá»¥ thá»ƒ cá»§a dá»± Ã¡n.

  - Vá» viá»‡c quáº£n lÃ½ key trong React Query, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng báº¥t ká»³ loáº¡i key nÃ o phÃ¹ há»£p vá»›i dá»± Ã¡n cá»§a mÃ¬nh. Key thÆ°á»ng Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a dÆ°á»›i dáº¡ng má»™t máº£ng (`array`) hoáº·c má»™t chuá»—i (`string`) Ä‘áº¡i diá»‡n cho truy váº¥n cá»¥ thá»ƒ. Báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡c giÃ¡ trá»‹ duy nháº¥t nhÆ° `ID` ngÆ°á»i dÃ¹ng, tÃªn truy váº¥n, hoáº·c báº¥t ká»³ giÃ¡ trá»‹ nÃ o mÃ  báº¡n cho lÃ  phÃ¹ há»£p Ä‘á»ƒ Ä‘á»‹nh danh truy váº¥n. Äiá»u nÃ y giÃºp React Query xÃ¡c Ä‘á»‹nh vÃ  quáº£n lÃ½ cÃ¡c truy váº¥n riÃªng biá»‡t má»™t cÃ¡ch chÃ­nh xÃ¡c.

---

- ## â“â“â“ CÃ¡c cÃ¢u há»i tháº¯c máº¯c (tá»± research):

## Tá»•ng káº¿t láº¡i chÆ°Æ¡ng React Query ?

- React Query lÃ  má»™t thÆ° viá»‡n quáº£n lÃ½ tráº¡ng thÃ¡i vÃ  cache dá»¯ liá»‡u trong á»©ng dá»¥ng React. NÃ³ cung cáº¥p cÃ¡c khÃ¡i niá»‡m vÃ  API cho phÃ©p tÆ°Æ¡ng tÃ¡c dá»… dÃ ng vá»›i dá»¯ liá»‡u tá»« cÃ¡c nguá»“n khÃ¡c nhau nhÆ° API, localStorage, hay báº¥t ká»³ nguá»“n dá»¯ liá»‡u nÃ o khÃ¡c.

- DÆ°á»›i Ä‘Ã¢y lÃ  nhá»¯ng khÃ¡i niá»‡m chÃ­nh vÃ  tÃ­nh nÄƒng quan trá»ng cá»§a React Query:

1. `Query`: Má»™t query Ä‘áº¡i diá»‡n cho má»™t truy váº¥n dá»¯ liá»‡u tá»« má»™t nguá»“n nháº¥t Ä‘á»‹nh. React Query cung cáº¥p hook `useQuery` Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c truy váº¥n nÃ y.

2. `Mutations`: Mutations Ä‘áº¡i diá»‡n cho cÃ¡c hoáº¡t Ä‘á»™ng thay Ä‘á»•i dá»¯ liá»‡u nhÆ° táº¡o, cáº­p nháº­t hoáº·c xÃ³a. React Query cung cáº¥p hook `useMutation` Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c mutations.

3. `Query Invalidation`: React Query há»— trá»£ viá»‡c lÃ m má»›i (refresh) dá»¯ liá»‡u thÃ´ng qua phÆ°Æ¡ng thá»©c `invalidateQueries`, cho phÃ©p chÃºng ta xÃ³a cache cá»§a má»™t hoáº·c nhiá»u queries.

4. `Automatic Caching`: React Query tá»± Ä‘á»™ng lÆ°u trá»¯ dá»¯ liá»‡u truy váº¥n vÃ  quáº£n lÃ½ viá»‡c cáº­p nháº­t dá»¯ liá»‡u khi cÃ³ sá»± thay Ä‘á»•i. NÃ³ sá»­ dá»¥ng cÆ¡ cháº¿ cache thÃ´ng minh Ä‘á»ƒ táº­n dá»¥ng láº¡i dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c truy váº¥n trÆ°á»›c Ä‘Ã³ mÃ  khÃ´ng cáº§n gá»­i yÃªu cáº§u máº¡ng.

5. `Prefetching`: React Query cung cáº¥p tÃ­nh nÄƒng prefetching, cho phÃ©p chÃºng ta táº£i trÆ°á»›c dá»¯ liá»‡u trong background trÆ°á»›c khi nÃ³ Ä‘Æ°á»£c yÃªu cáº§u, tá»‘i Æ°u hÃ³a tráº£i nghiá»‡m ngÆ°á»i dÃ¹ng.

6. `Optimistic Updates`: TÃ­nh nÄƒng optimistic updates cho phÃ©p chÃºng ta cáº­p nháº­t giao diá»‡n ngay láº­p tá»©c mÃ  khÃ´ng cáº§n chá» Ä‘á»£i pháº£n há»“i tá»« server khi thá»±c hiá»‡n mutations.

- React Query giÃºp tÄƒng hiá»‡u suáº¥t á»©ng dá»¥ng, giáº£m sá»‘ láº§n gá»i máº¡ng khÃ´ng cáº§n thiáº¿t, cung cáº¥p kháº£ nÄƒng xá»­ lÃ½ lá»—i vÃ  cung cáº¥p má»™t cÃ¡ch tiáº¿p cáº­n dá»… dÃ¹ng vÃ  linh hoáº¡t trong quáº£n lÃ½ dá»¯ liá»‡u.

---

## Nhá»¯ng kiáº¿n thá»©c nháº­n Ä‘Æ°á»£c khi há»c xong khoÃ¡ React Query ?

- Khi hoÃ n thÃ nh viá»‡c há»c khoÃ¡ React Query, báº¡n sáº½ cÃ³ kiáº¿n thá»©c vá» cÃ¡c khÃ¡i niá»‡m vÃ  ká»¹ thuáº­t chÃ­nh sau:

1. `CÆ¡ báº£n vá» React Query`: Báº¡n sáº½ hiá»ƒu Ä‘Æ°á»£c React Query lÃ  gÃ¬, táº¡i sao nÃ³ há»¯u Ã­ch trong quáº£n lÃ½ tráº¡ng thÃ¡i vÃ  tÆ°Æ¡ng tÃ¡c dá»¯ liá»‡u trong á»©ng dá»¥ng React.

2. `CÃ¡ch sá»­ dá»¥ng useQuery hook`: Báº¡n sáº½ biáº¿t cÃ¡ch sá»­ dá»¥ng `useQuery` hook Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c truy váº¥n dá»¯ liá»‡u, quáº£n lÃ½ cache vÃ  xá»­ lÃ½ cÃ¡c tráº¡ng thÃ¡i khÃ¡c nhau (nhÆ° loading, error) cá»§a truy váº¥n.

3. `Quáº£n lÃ½ cache dá»¯ liá»‡u`: Báº¡n sáº½ hiá»ƒu cÃ¡ch React Query quáº£n lÃ½ cache dá»¯ liá»‡u vÃ  tá»± Ä‘á»™ng lÃ m má»›i dá»¯ liá»‡u theo thá»i gian thá»±c.

4. `TÃ­ch há»£p vá»›i mutation`: Báº¡n sáº½ biáº¿t cÃ¡ch sá»­ dá»¥ng mutation Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c thao tÃ¡c cáº­p nháº­t dá»¯ liá»‡u thÃªm, sá»­a, xÃ³a (POST, PUT, DELETE) vÃ  lÃ m má»›i cache. LÆ°u Ã½ chá»‰ cÃ³ láº¥y dá»¯ liá»‡u (GET) lÃ  sá»­ dá»¥ng query .

5. `Quáº£n lÃ½ dependencies`: Báº¡n sáº½ hiá»ƒu cÃ¡ch xÃ¡c Ä‘á»‹nh vÃ  quáº£n lÃ½ cÃ¡c phá»¥ thuá»™c giá»¯a cÃ¡c truy váº¥n, cho phÃ©p lÃ m má»›i tá»± Ä‘á»™ng cÃ¡c truy váº¥n liÃªn quan khi cÃ³ thay Ä‘á»•i.

6. `TÃ­ch há»£p vá»›i prefetching`: Báº¡n sáº½ biáº¿t cÃ¡ch sá»­ dá»¥ng tÃ­nh nÄƒng prefetching Ä‘á»ƒ táº£i dá»¯ liá»‡u trÆ°á»›c vÃ  cung cáº¥p tráº£i nghiá»‡m nhanh hÆ¡n cho ngÆ°á»i dÃ¹ng.

7. `TÆ°Æ¡ng tÃ¡c vá»›i cache trá»±c tiáº¿p`: Báº¡n sáº½ hiá»ƒu cÃ¡ch truy cáº­p vÃ  cáº­p nháº­t cache trá»±c tiáº¿p thÃ´ng qua `useQueryClient` hook.

8. `Xá»­ lÃ½ lá»—i vÃ  thÃ´ng bÃ¡o`: Báº¡n sáº½ biáº¿t cÃ¡ch xá»­ lÃ½ lá»—i trong React Query vÃ  hiá»ƒn thá»‹ thÃ´ng bÃ¡o cho ngÆ°á»i dÃ¹ng khi cÃ³ lá»—i xáº£y ra.

9. `Cáº¥u hÃ¬nh vÃ  tÃ¹y chá»‰nh`: Báº¡n sáº½ hiá»ƒu cÃ¡ch cáº¥u hÃ¬nh (config) vÃ  tÃ¹y chá»‰nh (custom) React Query theo nhu cáº§u dá»± Ã¡n, bao gá»“m thá»i gian stale, sá»‘ láº§n tÃ¡i thá»­, Ä‘á»™ Æ°u tiÃªn vÃ  cÃ¡c tÃ¹y chá»n khÃ¡c.

10. `Quáº£n lÃ½ tráº¡ng thÃ¡i á»©ng dá»¥ng`: Báº¡n sáº½ biáº¿t cÃ¡ch sá»­ dá»¥ng React Query Ä‘á»ƒ quáº£n lÃ½ tráº¡ng thÃ¡i á»©ng dá»¥ng vÃ  lÃ m viá»‡c vá»›i cÃ¡c truy váº¥n dá»¯ liá»‡u trong toÃ n bá»™ á»©ng dá»¥ng.

- Vá»›i nhá»¯ng kiáº¿n thá»©c nÃ y, báº¡n sáº½ cÃ³ kháº£ nÄƒng sá»­ dá»¥ng React Query Ä‘á»ƒ xÃ¢y dá»±ng cÃ¡c á»©ng dá»¥ng React hiá»‡u quáº£, quáº£n lÃ½ tráº¡ng thÃ¡i vÃ  tÆ°Æ¡ng tÃ¡c dá»¯ liá»‡u má»™t cÃ¡ch linh hoáº¡t vÃ  dá»… dÃ ng.

---

## Äiá»ƒm máº¡nh vÃ  Ä‘iá»ƒm yáº¿u cá»§a React Query ?

- React Query cÃ³ má»™t sá»‘ Ä‘iá»ƒm máº¡nh vÃ  Ä‘iá»ƒm yáº¿u sau Ä‘Ã¢y:

- âœ… Äiá»ƒm máº¡nh:

  - ÄÆ¡n giáº£n vÃ  dá»… sá»­ dá»¥ng: React Query cung cáº¥p cÃº phÃ¡p dá»… hiá»ƒu vÃ  gá»n nháº¹, giÃºp viá»‡c quáº£n lÃ½ dá»¯ liá»‡u vÃ  thá»±c hiá»‡n cÃ¡c truy váº¥n API trá»Ÿ nÃªn Ä‘Æ¡n giáº£n vÃ  dá»… dÃ ng.

  - Quáº£n lÃ½ bá»™ nhá»› cache máº¡nh máº½: React Query tá»± Ä‘á»™ng quáº£n lÃ½ bá»™ nhá»› cache cho dá»¯ liá»‡u truy váº¥n, giÃºp tÄƒng hiá»‡u suáº¥t vÃ  giáº£m sá»‘ lÆ°á»£ng cuá»™c gá»i API khÃ´ng cáº§n thiáº¿t. CÃ¡c truy váº¥n Ä‘Æ°á»£c lÆ°u trá»¯ trong bá»™ nhá»› cache vÃ  cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ¡i sá»­ dá»¥ng khi cáº§n thiáº¿t.

  - Há»— trá»£ cho táº¥t cáº£ cÃ¡c loáº¡i truy váº¥n: React Query há»— trá»£ cÃ¡c loáº¡i truy váº¥n phong phÃº nhÆ° GET, POST, PUT, DELETE vÃ  cung cáº¥p cÃ¡c phÆ°Æ¡ng thá»©c vÃ  tÃ­nh nÄƒng linh hoáº¡t Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c hoáº¡t Ä‘á»™ng truy váº¥n phá»©c táº¡p.

  - Cung cáº¥p cÃ¡c tÃ­nh nÄƒng tiÃªn tiáº¿n: React Query cung cáº¥p cÃ¡c tÃ­nh nÄƒng máº¡nh máº½ nhÆ° `prefetching`, `pagination`, `realtime` `updates`, vÃ  `optimistic updates`, giÃºp cáº£i thiá»‡n tráº£i nghiá»‡m ngÆ°á»i dÃ¹ng vÃ  tÄƒng kháº£ nÄƒng tÆ°Æ¡ng tÃ¡c cá»§a á»©ng dá»¥ng.

- âŒ Äiá»ƒm yáº¿u:

  - Há»c cÃº phÃ¡p ban Ä‘áº§u: React Query cÃ³ má»™t sá»‘ khÃ¡i niá»‡m má»›i vÃ  pháº£i há»c cÃº phÃ¡p vÃ  cÃ¡c API cá»§a nÃ³. Äiá»u nÃ y cÃ³ thá»ƒ Ä‘Ã²i há»i má»™t thá»i gian Ä‘á»ƒ lÃ m quen vÃ  hiá»ƒu rÃµ cÃ¡ch thá»©c hoáº¡t Ä‘á»™ng cá»§a nÃ³.

  - Phá»¥ thuá»™c vÃ o ká»¹ nÄƒng JavaScript: React Query lÃ  má»™t thÆ° viá»‡n JavaScript vÃ  yÃªu cáº§u báº¡n cÃ³ kiáº¿n thá»©c vá» JavaScript Ä‘á»ƒ sá»­ dá»¥ng hiá»‡u quáº£. Náº¿u báº¡n khÃ´ng quen vá»›i JavaScript, cÃ³ thá»ƒ máº¥t thá»i gian Ä‘á»ƒ lÃ m quen vÃ  thÃ­ch nghi vá»›i React Query.

  - TÃ­ch há»£p vá»›i cÃ¡c cÃ´ng nghá»‡ khÃ¡c: Máº·c dÃ¹ React Query cung cáº¥p cÃ¡c tÃ­nh nÄƒng vÃ  API máº¡nh máº½, nhÆ°ng cÃ³ thá»ƒ cáº§n tÃ­ch há»£p vá»›i cÃ¡c cÃ´ng nghá»‡ khÃ¡c nhÆ° Redux, React Router hoáº·c cÃ¡c thÆ° viá»‡n quáº£n lÃ½ tráº¡ng thÃ¡i khÃ¡c. Viá»‡c tÃ­ch há»£p nÃ y cÃ³ thá»ƒ Ä‘Ã²i há»i kiáº¿n thá»©c bá»• sung vÃ  sá»± Ä‘á»“ng bá»™ giá»¯a cÃ¡c cÃ´ng nghá»‡ khÃ¡c nhau.

  - TÃ³m láº¡i, React Query lÃ  má»™t thÆ° viá»‡n máº¡nh máº½ vÃ  tiá»‡n Ã­ch Ä‘á»ƒ quáº£n lÃ½ dá»¯ liá»‡u vÃ  truy váº¥n API trong á»©ng dá»¥ng React. Máº·c dÃ¹ cÃ³ má»™t sá»‘ Ä‘iá»ƒm yáº¿u, nhÆ°ng vá»›i nhá»¯ng Ä‘iá»ƒm máº¡nh cá»§a nÃ³, nÃ³ Ä‘Ã£ trá»Ÿ thÃ nh má»™t cÃ´ng cá»¥ phá»• biáº¿n cho viá»‡c phÃ¡t triá»ƒn á»©ng dá»¥ng React chuyÃªn nghiá»‡p.

---

## Cho cÃ¡c vÃ­ dá»¥ vá» React Query cÆ¡ báº£n ?

- DÆ°á»›i Ä‘Ã¢y lÃ  má»™t sá»‘ vÃ­ dá»¥ cÆ¡ báº£n vá» viá»‡c sá»­ dá»¥ng React Query:

## 1. Sá»­ dá»¥ng `useQuery` Ä‘á»ƒ truy váº¥n dá»¯ liá»‡u tá»« API:

```jsx
import { useQuery } from 'react-query'

function UserProfile({ userId }) {
  const { data, isLoading, error } = useQuery('userData', () => fetch(`/api/users/${userId}`).then((res) => res.json()))

  if (isLoading) {
    return <div>Loading...</div>
  }

  if (error) {
    return <div>Error: {error.message}</div>
  }

  return (
    <div>
      <h2>User Profile</h2>
      <p>Name: {data.name}</p>
      <p>Email: {data.email}</p>
    </div>
  )
}
```

â“ Giáº£i thÃ­ch code chi tiáº¿t:

- Äoáº¡n code trÃªn lÃ  má»™t vÃ­ dá»¥ cÆ¡ báº£n vá» viá»‡c sá»­ dá»¥ng React Query Ä‘á»ƒ truy váº¥n dá»¯ liá»‡u tá»« má»™t API. DÆ°á»›i Ä‘Ã¢y lÃ  cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a code:

1. Sá»­ dá»¥ng hook `useQuery` tá»« React Query Ä‘á»ƒ táº¡o má»™t truy váº¥n. Truyá»n vÃ o `userData` lÃ  key Ä‘á»ƒ xÃ¡c Ä‘á»‹nh truy váº¥n nÃ y.

2. Trong hÃ m callback cá»§a `useQuery`, chÃºng ta gá»i `fetch` API Ä‘á»ƒ láº¥y dá»¯ liá»‡u ngÆ°á»i dÃ¹ng tá»« `/api/users/${userId}`. Káº¿t quáº£ tráº£ vá» tá»« API Ä‘Æ°á»£c xá»­ lÃ½ báº±ng phÆ°Æ¡ng thá»©c `res.json()`.

3. Káº¿t quáº£ tráº£ vá» tá»« `useQuery` bao gá»“m `data`, `isLoading` vÃ  `error`.

- `data`: Dá»¯ liá»‡u cá»§a truy váº¥n, trong trÆ°á»ng há»£p nÃ y lÃ  thÃ´ng tin ngÆ°á»i dÃ¹ng nhÆ° name vÃ  email.
- `isLoading`: Tráº¡ng thÃ¡i Ä‘ang táº£i dá»¯ liá»‡u (`isLoading` lÃ  `true`). Náº¿u Ä‘ang táº£i, hiá»ƒn thá»‹ thÃ´ng bÃ¡o `"Loading..."`.
- `error`: Lá»—i xáº£y ra trong quÃ¡ trÃ¬nh truy váº¥n. Náº¿u cÃ³ lá»—i, hiá»ƒn thá»‹ thÃ´ng bÃ¡o lá»—i.

4. Dá»±a vÃ o tráº¡ng thÃ¡i `isLoading` vÃ  `error`, chÃºng ta hiá»ƒn thá»‹ giao diá»‡n tÆ°Æ¡ng á»©ng. Náº¿u Ä‘ang táº£i, hiá»ƒn thá»‹ thÃ´ng bÃ¡o `"Loading..."`. Náº¿u cÃ³ lá»—i, hiá»ƒn thá»‹ thÃ´ng bÃ¡o lá»—i. Náº¿u khÃ´ng cÃ³ lá»—i vÃ  dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c láº¥y thÃ nh cÃ´ng, hiá»ƒn thá»‹ thÃ´ng tin ngÆ°á»i dÃ¹ng bao gá»“m name vÃ  email.

- Vá»›i React Query, chÃºng ta cÃ³ thá»ƒ dá»… dÃ ng thá»±c hiá»‡n viá»‡c truy váº¥n dá»¯ liá»‡u tá»« API vÃ  quáº£n lÃ½ tráº¡ng thÃ¡i cá»§a truy váº¥n. React Query tá»± Ä‘á»™ng quáº£n lÃ½ viá»‡c caching, lÃ m má»›i dá»¯ liá»‡u vÃ  xá»­ lÃ½ cÃ¡c tráº¡ng thÃ¡i liÃªn quan Ä‘áº¿n truy váº¥n. Äiá»u nÃ y giÃºp tiáº¿t kiá»‡m cÃ´ng sá»©c vÃ  giáº£m bá»›t viá»‡c láº·p láº¡i code xá»­ lÃ½ truy váº¥n dá»¯ liá»‡u trong React components.

## 2. Sá»­ dá»¥ng `useMutation` Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c thao tÃ¡c táº¡o, cáº­p nháº­t hoáº·c xÃ³a dá»¯ liá»‡u:

```jsx
import { useMutation } from 'react-query'

function CreateUserForm() {
  const createUser = useMutation((formData) =>
    fetch('/api/users', {
      method: 'POST',
      body: JSON.stringify(formData)
    }).then((res) => res.json())
  )

  const handleSubmit = (e) => {
    e.preventDefault()
    const formData = new FormData(e.target)
    createUser.mutate(Object.fromEntries(formData))
  }

  return (
    <form onSubmit={handleSubmit}>
      <input type='text' name='name' placeholder='Name' required />
      <input type='email' name='email' placeholder='Email' required />
      <button type='submit' disabled={createUser.isLoading}>
        {createUser.isLoading ? 'Creating...' : 'Create User'}
      </button>
    </form>
  )
}
```

â“ Giáº£i thÃ­ch code chi tiáº¿t:

- Äoáº¡n code trÃªn lÃ  má»™t vÃ­ dá»¥ vá» viá»‡c sá»­ dá»¥ng `useMutation` tá»« React Query Ä‘á»ƒ thá»±c hiá»‡n má»™t mutation, cá»¥ thá»ƒ lÃ  táº¡o má»›i ngÆ°á»i dÃ¹ng thÃ´ng qua API.

- DÆ°á»›i Ä‘Ã¢y lÃ  cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a code:

1. Sá»­ dá»¥ng hook `useMutation` tá»« React Query Ä‘á»ƒ táº¡o má»™t mutation. Truyá»n vÃ o má»™t hÃ m callback, trong Ä‘Ã³ chÃºng ta sá»­ dá»¥ng `fetch` API Ä‘á»ƒ gá»­i má»™t yÃªu cáº§u POST Ä‘áº¿n `/api/users` vá»›i dá»¯ liá»‡u Ä‘Æ°á»£c láº¥y tá»« `formData`. Káº¿t quáº£ tráº£ vá» tá»« API Ä‘Æ°á»£c xá»­ lÃ½ báº±ng phÆ°Æ¡ng thá»©c `res.json()`.

2. `useMutation` tráº£ vá» má»™t Ä‘á»‘i tÆ°á»£ng cÃ³ cÃ¡c thuá»™c tÃ­nh vÃ  phÆ°Æ¡ng thá»©c liÃªn quan Ä‘áº¿n mutation:

- `mutate`: Má»™t phÆ°Æ¡ng thá»©c Ä‘á»ƒ thá»±c hiá»‡n mutation. Trong trÆ°á»ng há»£p nÃ y, chÃºng ta gá»i `createUser.mutate` Ä‘á»ƒ gá»­i yÃªu cáº§u táº¡o ngÆ°á»i dÃ¹ng vá»›i dá»¯ liá»‡u tá»« `formData`.
- `isLoading`: Tráº¡ng thÃ¡i Ä‘ang táº£i. ChÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng `createUser.isLoading` Ä‘á»ƒ kiá»ƒm tra xem mutation Ä‘ang tiáº¿n hÃ nh hay khÃ´ng.

3. Trong hÃ m `handleSubmit`, chÃºng ta xá»­ lÃ½ sá»± kiá»‡n submit cá»§a form. ChÃºng ta ngÄƒn cháº·n hÃ nh vi máº·c Ä‘á»‹nh cá»§a form báº±ng cÃ¡ch gá»i `e.preventDefault()`. Sau Ä‘Ã³, chÃºng ta táº¡o má»™t Ä‘á»‘i tÆ°á»£ng `formData` tá»« cÃ¡c trÆ°á»ng dá»¯ liá»‡u trong form sá»­ dá»¥ng `new FormData(e.target)`. Cuá»‘i cÃ¹ng, chÃºng ta gá»i `createUser.mutate` vá»›i Ä‘á»‘i sá»‘ lÃ  Ä‘á»‘i tÆ°á»£ng `formData` Ä‘Ã£ Ä‘Æ°á»£c chuyá»ƒn Ä‘á»•i thÃ nh má»™t Ä‘á»‘i tÆ°á»£ng JavaScript thÃ´ng qua `Object.fromEntries(formData)`.

4. Trong pháº§n render, chÃºng ta hiá»ƒn thá»‹ má»™t form vá»›i hai trÆ°á»ng nháº­p dá»¯ liá»‡u (name vÃ  email) vÃ  má»™t nÃºt "Create User" Ä‘á»ƒ gá»­i yÃªu cáº§u táº¡o má»›i ngÆ°á»i dÃ¹ng. NÃºt "Create User" sáº½ bá»‹ vÃ´ hiá»‡u hÃ³a (`disabled`) khi mutation Ä‘ang tiáº¿n hÃ nh (dá»±a trÃªn `createUser.isLoading`). VÄƒn báº£n cá»§a nÃºt cÅ©ng thay Ä‘á»•i tÃ¹y thuá»™c vÃ o tráº¡ng thÃ¡i táº£i (`createUser.isLoading`).

- Vá»›i React Query, chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng `useMutation` Ä‘á»ƒ dá»… dÃ ng thá»±c hiá»‡n cÃ¡c thao tÃ¡c mutation nhÆ° táº¡o, cáº­p nháº­t hoáº·c xÃ³a dá»¯ liá»‡u (POST, PUT, DELETE). React Query sáº½ tá»± Ä‘á»™ng quáº£n lÃ½ tráº¡ng thÃ¡i cá»§a mutation vÃ  cung cáº¥p cÃ¡c phÆ°Æ¡ng thá»©c vÃ  thuá»™c tÃ­nh Ä‘á»ƒ theo dÃµi vÃ  Ä‘iá»u khiá»ƒn quÃ¡ trÃ¬nh mutation.

## 3. Sá»­ dá»¥ng `useQueryClient` Ä‘á»ƒ xÃ³a bá»™ nhá»› cache hoáº·c lÃ m má»›i dá»¯ liá»‡u:

```jsx
import { useQueryClient } from 'react-query'

function ProfilePage({ userId }) {
  const queryClient = useQueryClient()

  const handleLogout = () => {
    // XÃ³a bá»™ nhá»› cache cá»§a táº¥t cáº£ cÃ¡c truy váº¥n
    queryClient.clear()

    // LÃ m má»›i dá»¯ liá»‡u truy váº¥n "userData"
    queryClient.invalidateQueries('userData')
  }

  return (
    <div>
      <h2>Welcome, User!</h2>
      <button onClick={handleLogout}>Logout</button>
    </div>
  )
}
```

â“ Giáº£i thÃ­ch code chi tiáº¿t:

- Äoáº¡n code trÃªn lÃ  má»™t vÃ­ dá»¥ vá» viá»‡c sá»­ dá»¥ng `useQueryClient` tá»« React Query Ä‘á»ƒ quáº£n lÃ½ bá»™ nhá»› cache vÃ  thá»±c hiá»‡n cÃ¡c tÃ¡c vá»¥ liÃªn quan Ä‘áº¿n quáº£n lÃ½ cache vÃ  truy váº¥n.

- DÆ°á»›i Ä‘Ã¢y lÃ  cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a code:

1. Sá»­ dá»¥ng hook `useQueryClient` tá»« React Query Ä‘á»ƒ nháº­n má»™t instance cá»§a `queryClient`, Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ quáº£n lÃ½ bá»™ nhá»› cache vÃ  thá»±c hiá»‡n cÃ¡c thao tÃ¡c liÃªn quan Ä‘áº¿n cache vÃ  truy váº¥n.

2. Trong hÃ m `handleLogout`, chÃºng ta thá»±c hiá»‡n hai tÃ¡c vá»¥:

- `queryClient.clear()`: XÃ³a bá»™ nhá»› cache cá»§a táº¥t cáº£ cÃ¡c truy váº¥n. PhÆ°Æ¡ng thá»©c nÃ y sáº½ xÃ³a háº¿t táº¥t cáº£ cÃ¡c truy váº¥n Ä‘Ã£ Ä‘Æ°á»£c lÆ°u trá»¯ trong cache, Ä‘áº£m báº£o ráº±ng dá»¯ liá»‡u cache Ä‘Æ°á»£c lÃ m má»›i hoÃ n toÃ n.
- `queryClient.invalidateQueries('userData')`: LÃ m má»›i dá»¯ liá»‡u cho truy váº¥n cÃ³ key lÃ  `'userData'`. PhÆ°Æ¡ng thá»©c nÃ y sáº½ xÃ³a cache cá»§a truy váº¥n `'userData'`, Ä‘á»“ng thá»i kÃ­ch hoáº¡t má»™t truy váº¥n má»›i Ä‘á»ƒ láº¥y dá»¯ liá»‡u má»›i nháº¥t tá»« nguá»“n dá»¯ liá»‡u. Äiá»u nÃ y Ä‘áº£m báº£o ráº±ng sau khi Ä‘Äƒng xuáº¥t, khi ngÆ°á»i dÃ¹ng Ä‘Äƒng nháº­p láº¡i, dá»¯ liá»‡u ngÆ°á»i dÃ¹ng má»›i nháº¥t sáº½ Ä‘Æ°á»£c táº£i láº¡i tá»« API.

3. Trong pháº§n render, chÃºng ta hiá»ƒn thá»‹ má»™t tiÃªu Ä‘á» chÃ o má»«ng ngÆ°á»i dÃ¹ng vÃ  má»™t nÃºt `"Logout"` Ä‘á»ƒ thá»±c hiá»‡n Ä‘Äƒng xuáº¥t. Khi ngÆ°á»i dÃ¹ng nháº¥p vÃ o nÃºt `"Logout"`, hÃ m `handleLogout` sáº½ Ä‘Æ°á»£c gá»i Ä‘á»ƒ xÃ³a cache vÃ  lÃ m má»›i dá»¯ liá»‡u truy váº¥n `'userData'`.

- Vá»›i React Query, chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng `useQueryClient` Ä‘á»ƒ truy cáº­p vÃ  quáº£n lÃ½ bá»™ nhá»› cache. ChÃºng ta cÃ³ thá»ƒ xÃ³a cache cá»§a cÃ¡c truy váº¥n cá»¥ thá»ƒ, lÃ m má»›i dá»¯ liá»‡u tá»« nguá»“n dá»¯ liá»‡u vÃ  thá»±c hiá»‡n cÃ¡c tÃ¡c vá»¥ quáº£n lÃ½ cache khÃ¡c.

- âœ… TrÃªn Ä‘Ã¢y lÃ  3 vÃ­ dá»¥ cÆ¡ báº£n Ä‘á»ƒ minh há»a viá»‡c sá»­ dá»¥ng React Query. CÃ³ ráº¥t nhiá»u tÃ­nh nÄƒng vÃ  kháº£ nÄƒng trong React Query Ä‘á»ƒ khÃ¡m phÃ¡ vÃ  tÃ¹y chá»‰nh theo nhu cáº§u cá»§a dá»± Ã¡n.

---

## Cho cÃ¡c vÃ­ dá»¥ vá» React Query nÃ¢ng cao ?

âŒâŒ DÆ°á»›i Ä‘Ã¢y lÃ  má»™t sá»‘ vÃ­ dá»¥ vá» cÃ¡ch sá»­ dá»¥ng React Query trong cÃ¡c tÃ¬nh huá»‘ng nÃ¢ng cao:

1. Caching vÃ  LÆ°u trá»¯ dá»¯ liá»‡u:

- Sá»­ dá»¥ng React Query Ä‘á»ƒ lÆ°u trá»¯ dá»¯ liá»‡u trÃªn client-side vÃ  táº­n dá»¥ng cache Ä‘á»ƒ trÃ¡nh viá»‡c gá»i API liÃªn tá»¥c khi dá»¯ liá»‡u khÃ´ng thay Ä‘á»•i.
- Sá»­ dá»¥ng cÃ¡c tÃ¹y chá»n nhÆ° `staleTime` vÃ  `cacheTime` Ä‘á»ƒ xÃ¡c Ä‘á»‹nh thá»i gian háº¿t háº¡n cá»§a dá»¯ liá»‡u trong cache vÃ  cÃ¡ch cáº­p nháº­t dá»¯ liá»‡u má»›i.

- DÆ°á»›i Ä‘Ã¢y lÃ  má»™t vÃ­ dá»¥ vá» viá»‡c sá»­ dá»¥ng caching vÃ  lÆ°u trá»¯ dá»¯ liá»‡u trong React Query:

```jsx
import { useQuery } from 'react-query'

function UserProfile({ userId }) {
  const { data, isLoading } = useQuery(
    ['userData', userId],
    () => fetch(`/api/users/${userId}`).then((res) => res.json()),
    {
      // Caching dá»¯ liá»‡u trong 5 giÃ¢y
      staleTime: 5000
    }
  )

  if (isLoading) {
    return <div>Loading...</div>
  }

  return (
    <div>
      <h2>User Profile</h2>
      <p>Name: {data.name}</p>
      <p>Email: {data.email}</p>
    </div>
  )
}
```

- Trong vÃ­ dá»¥ nÃ y, chÃºng ta sá»­ dá»¥ng `useQuery` Ä‘á»ƒ láº¥y dá»¯ liá»‡u ngÆ°á»i dÃ¹ng tá»« API. ChÃºng ta sá»­ dá»¥ng má»™t máº£ng `['userData', userId]` lÃ m khÃ³a query Ä‘á»ƒ Ä‘á»‹nh danh query. Náº¿u khÃ³a query nÃ y khÃ´ng thay Ä‘á»•i, React Query sáº½ tráº£ vá» dá»¯ liá»‡u Ä‘Ã£ lÆ°u trá»¯ trong bá»™ nhá»› cache mÃ  khÃ´ng thá»±c hiá»‡n cuá»™c gá»i máº¡ng má»›i.

- NgoÃ i ra, chÃºng ta cÅ©ng Ä‘áº·t tÃ¹y chá»n `staleTime` lÃ  5000 (tÃ­nh báº±ng millisecond) Ä‘á»ƒ chá»‰ Ä‘á»‹nh thá»i gian dá»¯ liá»‡u cÃ³ thá»ƒ Ä‘Æ°á»£c coi lÃ  "cÅ©" trÆ°á»›c khi nÃ³ Ä‘Æ°á»£c coi lÃ  "háº¿t háº¡n" vÃ  cáº§n Ä‘Æ°á»£c cáº­p nháº­t tá»« API. Trong trÆ°á»ng há»£p nÃ y, náº¿u dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c lÆ°u trá»¯ trong cache vÃ  chÆ°a háº¿t háº¡n (thá»i gian staleTime chÆ°a trÃ´i qua), React Query sáº½ tráº£ vá» dá»¯ liá»‡u tá»« cache mÃ  khÃ´ng gá»i API.

- Äiá»u nÃ y giÃºp tÄƒng hiá»‡u suáº¥t á»©ng dá»¥ng báº±ng cÃ¡ch trÃ¡nh cÃ¡c cuá»™c gá»i máº¡ng khÃ´ng cáº§n thiáº¿t vÃ  sá»­ dá»¥ng dá»¯ liá»‡u Ä‘Ã£ lÆ°u trá»¯ trong cache Ä‘á»ƒ hiá»ƒn thá»‹ cho ngÆ°á»i dÃ¹ng nhanh chÃ³ng.

---

2. Pagination:

- Sá»­ dá»¥ng React Query Ä‘á»ƒ thá»±c hiá»‡n viá»‡c truy váº¥n dá»¯ liá»‡u phÃ¢n trang (`pagination`) tá»« API.
- Sá»­ dá»¥ng `useInfiniteQuery` Ä‘á»ƒ táº£i dá»¯ liá»‡u phÃ¢n trang vÃ´ háº¡n vÃ  tá»± Ä‘á»™ng láº¥y dá»¯ liá»‡u má»›i khi ngÆ°á»i dÃ¹ng cuá»™n trang.

- âŒâŒ DÆ°á»›i Ä‘Ã¢y lÃ  má»™t vÃ­ dá»¥ vá» viá»‡c sá»­ dá»¥ng `pagination` (cÆ¡ báº£n) trong React Query:

```jsx
import { useQuery } from 'react-query'

function UserList() {
  const PAGE_SIZE = 10 // KÃ­ch thÆ°á»›c trang

  const { data, isLoading } = useQuery('userList', () =>
    fetch(`/api/users?page=1&pageSize=${PAGE_SIZE}`).then((res) => res.json())
  )

  if (isLoading) {
    return <div>Loading...</div>
  }

  return (
    <div>
      <h2>User List</h2>
      {data.users.map((user) => (
        <div key={user.id}>
          <p>Name: {user.name}</p>
          <p>Email: {user.email}</p>
        </div>
      ))}
    </div>
  )
}
```

- Trong vÃ­ dá»¥ nÃ y, chÃºng ta sá»­ dá»¥ng `useQuery` Ä‘á»ƒ láº¥y danh sÃ¡ch ngÆ°á»i dÃ¹ng tá»« API vá»›i trang Ä‘áº§u tiÃªn vÃ  kÃ­ch thÆ°á»›c trang Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a lÃ  `PAGE_SIZE`. ChÃºng ta sá»­ dá»¥ng khÃ³a query lÃ  `'userList'` Ä‘á»ƒ Ä‘á»‹nh danh query.

- Trang hiá»‡n táº¡i vÃ  kÃ­ch thÆ°á»›c trang Ä‘Æ°á»£c truyá»n vÃ o URL cá»§a API (`/api/users?page=1&pageSize=${PAGE_SIZE}`) Ä‘á»ƒ chá»‰ Ä‘á»‹nh trang vÃ  kÃ­ch thÆ°á»›c dá»¯ liá»‡u tráº£ vá» tá»« API.

- Sau khi dá»¯ liá»‡u Ä‘Æ°á»£c tráº£ vá», chÃºng ta cÃ³ thá»ƒ láº·p qua máº£ng `data.users` Ä‘á»ƒ hiá»ƒn thá»‹ thÃ´ng tin ngÆ°á»i dÃ¹ng. Má»—i ngÆ°á»i dÃ¹ng Ä‘Æ°á»£c hiá»ƒn thá»‹ trong má»™t pháº§n tá»­ `<div>`, vá»›i thÃ´ng tin nhÆ° name vÃ  email.

- Äá»ƒ triá»ƒn khai chá»©c nÄƒng phÃ¢n trang, chÃºng ta cÃ³ thá»ƒ thay Ä‘á»•i giÃ¡ trá»‹ page trong URL vÃ  gá»i láº¡i `useQuery` Ä‘á»ƒ láº¥y dá»¯ liá»‡u trang má»›i. ChÃºng ta cÅ©ng cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡c nÃºt hoáº·c cÃ¡c thÃ nh pháº§n Ä‘iá»u hÆ°á»›ng khÃ¡c Ä‘á»ƒ cho phÃ©p ngÆ°á»i dÃ¹ng Ä‘iá»u hÆ°á»›ng giá»¯a cÃ¡c trang.

- âŒâŒ VÃ­ dá»¥ Pagination (nÃ¢ng cao) cÃ³ thÃªm cÃ¡c nÃºt `nextPage` vÃ  nÃºt `prevPage`

- Äá»ƒ thÃªm chá»©c nÄƒng Ä‘iá»u hÆ°á»›ng giá»¯a cÃ¡c trang trong chá»©c nÄƒng phÃ¢n trang, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng React Query Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c truy váº¥n má»›i khi ngÆ°á»i dÃ¹ng chuyá»ƒn Ä‘á»•i giá»¯a cÃ¡c trang. DÆ°á»›i Ä‘Ã¢y lÃ  má»™t vÃ­ dá»¥ vá» viá»‡c sá»­ dá»¥ng nÃºt `"Previous"` vÃ  `"Next"` Ä‘á»ƒ Ä‘iá»u hÆ°á»›ng giá»¯a cÃ¡c trang, bao gá»“m chá»©c nÄƒng tÃ¹y chá»n Ä‘á»ƒ hiá»ƒn thá»‹ chá»‰ má»¥c cá»§a tá»«ng ngÆ°á»i dÃ¹ng vÃ  cho phÃ©p ngÆ°á»i dÃ¹ng Ä‘iá»u hÆ°á»›ng trá»±c tiáº¿p Ä‘áº¿n má»™t trang cá»¥ thá»ƒ:

```jsx
import { useState } from 'react'
import { useQuery, useQueryClient } from 'react-query'

function UserList() {
  const PAGE_SIZE = 10 // KÃ­ch thÆ°á»›c trang
  const queryClient = useQueryClient()
  const [pageIndex, setPageIndex] = useState(1)

  const { data, isLoading } = useQuery(['userList', pageIndex], () =>
    fetch(`/api/users?page=${pageIndex}&pageSize=${PAGE_SIZE}`).then((res) => res.json())
  )

  const handlePreviousPage = () => {
    const prevPageIndex = pageIndex - 1
    setPageIndex(prevPageIndex)
    queryClient.prefetchQuery(['userList', prevPageIndex])
  }

  const handleNextPage = () => {
    const nextPageIndex = pageIndex + 1
    setPageIndex(nextPageIndex)
    queryClient.prefetchQuery(['userList', nextPageIndex])
  }

  const handleGoToPage = (pageNumber) => {
    setPageIndex(pageNumber)
    queryClient.prefetchQuery(['userList', pageNumber])
  }

  if (isLoading) {
    return <div>Loading...</div>
  }

  return (
    <div>
      <h2>User List</h2>
      {data.users.map((user, index) => (
        <div key={user.id}>
          <p>
            {(pageIndex - 1) * PAGE_SIZE + index + 1}. Name: {user.name}
          </p>
          <p>Email: {user.email}</p>
        </div>
      ))}
      <div>
        <button onClick={handlePreviousPage} disabled={pageIndex === 1}>
          Previous
        </button>
        <button onClick={handleNextPage} disabled={pageIndex === data.totalPages}>
          Next
        </button>
      </div>
      <div>
        {Array.from({ length: data.totalPages }, (_, index) => index + 1).map((pageNumber) => (
          <button key={pageNumber} onClick={() => handleGoToPage(pageNumber)}>
            {pageNumber}
          </button>
        ))}
      </div>
    </div>
  )
}
```

- Trong phiÃªn báº£n nÃ y, chÃºng ta sá»­ dá»¥ng state `pageIndex` Ä‘á»ƒ theo dÃµi trang hiá»‡n táº¡i mÃ  ngÆ°á»i dÃ¹ng Ä‘ang xem. HÃ m `handleGoToPage` cho phÃ©p ngÆ°á»i dÃ¹ng Ä‘iá»u hÆ°á»›ng trá»±c tiáº¿p Ä‘áº¿n má»™t trang cá»¥ thá»ƒ báº±ng cÃ¡ch cáº­p nháº­t `pageIndex` vÃ  gá»i `queryClient.prefetchQuery` Ä‘á»ƒ táº£i dá»¯ liá»‡u trang má»›i.

- NgoÃ i ra, chÃºng ta cÅ©ng hiá»ƒn thá»‹ chá»‰ má»¥c cá»§a tá»«ng ngÆ°á»i dÃ¹ng báº±ng cÃ¡ch tÃ­nh toÃ¡n `((pageIndex - 1) * PAGE_SIZE) + index + 1`. Äiá»u nÃ y cho phÃ©p chÃºng ta hiá»ƒn thá»‹ sá»‘ thá»© tá»± duy nháº¥t cho tá»«ng ngÆ°á»i dÃ¹ng trong toÃ n bá»™ danh sÃ¡ch.

- Cuá»‘i cÃ¹ng, chÃºng ta cÅ©ng hiá»ƒn thá»‹ cÃ¡c nÃºt sá»‘ trang Ä‘á»ƒ ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ Ä‘iá»u hÆ°á»›ng trá»±c tiáº¿p Ä‘áº¿n má»™t trang cá»¥ thá»ƒ. Má»—i nÃºt sá»‘ trang sáº½ gá»i `handleGoToPage` vá»›i sá»‘ trang tÆ°Æ¡ng á»©ng khi ngÆ°á»i dÃ¹ng nháº¥p vÃ o.

## âŒâŒ Giáº£i thÃ­ch chi tiáº¿t Ä‘oáº¡n code trÃªn:

- Trong Ä‘oáº¡n code trÃªn, chÃºng ta sá»­ dá»¥ng React Query Ä‘á»ƒ phÃ¢n trang danh sÃ¡ch ngÆ°á»i dÃ¹ng. DÆ°á»›i Ä‘Ã¢y lÃ  cÃ¡c pháº§n quan trá»ng trong Ä‘oáº¡n code:

- Khai bÃ¡o vÃ  khá»Ÿi táº¡o cÃ¡c biáº¿n:

  - `PAGE_SIZE`: KÃ­ch thÆ°á»›c trang, xÃ¡c Ä‘á»‹nh sá»‘ lÆ°á»£ng ngÆ°á»i dÃ¹ng hiá»ƒn thá»‹ trÃªn má»—i trang (trong vÃ­ dá»¥ nÃ y lÃ  10 ngÆ°á»i trÃªn 1 page).
  - `queryClient`: Sá»­ dá»¥ng hook `useQueryClient` Ä‘á»ƒ táº¡o má»™t instance cá»§a `queryClient`, Ä‘áº¡i diá»‡n cho quáº£n lÃ½ tráº¡ng thÃ¡i cá»§a React Query.
  - `pageIndex` vÃ  `setPageIndex`: Sá»­ dá»¥ng hook `useState` Ä‘á»ƒ lÆ°u trá»¯ trang hiá»‡n táº¡i mÃ  ngÆ°á»i dÃ¹ng Ä‘ang xem vÃ  cáº­p nháº­t giÃ¡ trá»‹ cá»§a `pageIndex`.

- Sá»­ dá»¥ng hook `useQuery` Ä‘á»ƒ láº¥y dá»¯ liá»‡u danh sÃ¡ch ngÆ°á»i dÃ¹ng:

  - ChÃºng ta sá»­ dá»¥ng key `['userList', pageIndex]` Ä‘á»ƒ xÃ¡c Ä‘á»‹nh truy váº¥n vÃ  tráº¡ng thÃ¡i cá»§a nÃ³.
  - Trong hÃ m callback, chÃºng ta sá»­ dá»¥ng `fetch` Ä‘á»ƒ gá»­i yÃªu cáº§u Ä‘áº¿n API vÃ  láº¥y dá»¯ liá»‡u ngÆ°á»i dÃ¹ng theo `pageIndex` vÃ  `PAGE_SIZE`.
  - Káº¿t quáº£ tráº£ vá» tá»« API sáº½ Ä‘Æ°á»£c gÃ¡n vÃ o biáº¿n `data`, vÃ  tráº¡ng thÃ¡i `isLoading` sáº½ chá»‰ ra liá»‡u dá»¯ liá»‡u Ä‘ang Ä‘Æ°á»£c táº£i hay khÃ´ng.

- Xá»­ lÃ½ phÃ¢n trang vÃ  hiá»ƒn thá»‹ danh sÃ¡ch ngÆ°á»i dÃ¹ng:

  - Trong pháº§n render, chÃºng ta hiá»ƒn thá»‹ thÃ´ng tin danh sÃ¡ch ngÆ°á»i dÃ¹ng vÃ  sá»‘ trang.
  - Má»—i ngÆ°á»i dÃ¹ng Ä‘Æ°á»£c hiá»ƒn thá»‹ vá»›i tÃªn vÃ  email cá»§a há».
  - ChÃºng ta tÃ­nh toÃ¡n chá»‰ má»¥c cá»§a tá»«ng ngÆ°á»i dÃ¹ng báº±ng cÃ´ng thá»©c `((pageIndex - 1) * PAGE_SIZE) + index + 1` Ä‘á»ƒ hiá»ƒn thá»‹ sá»‘ thá»© tá»± duy nháº¥t cho tá»«ng ngÆ°á»i dÃ¹ng trong toÃ n bá»™ danh sÃ¡ch.
  - ChÃºng ta cung cáº¥p hai nÃºt `"Previous"` vÃ  `"Next"` Ä‘á»ƒ ngÆ°á»i dÃ¹ng Ä‘iá»u hÆ°á»›ng giá»¯a cÃ¡c trang trÆ°á»›c vÃ  sau. NÃºt `"Previous"` sáº½ Ä‘Æ°á»£c vÃ´ hiá»‡u hÃ³a náº¿u ngÆ°á»i dÃ¹ng Ä‘ang á»Ÿ trang Ä‘áº§u tiÃªn, vÃ  nÃºt `"Next"` sáº½ Ä‘Æ°á»£c vÃ´ hiá»‡u hÃ³a náº¿u ngÆ°á»i dÃ¹ng Ä‘ang á»Ÿ trang cuá»‘i cÃ¹ng.
  - ChÃºng ta sá»­ dá»¥ng má»™t máº£ng Ä‘á»ƒ hiá»ƒn thá»‹ cÃ¡c nÃºt sá»‘ trang, má»—i nÃºt sáº½ cÃ³ sá»‘ trang tÆ°Æ¡ng á»©ng. Khi ngÆ°á»i dÃ¹ng nháº¥p vÃ o má»™t nÃºt sá»‘ trang, chÃºng ta gá»i hÃ m `handleGoToPage` vá»›i sá»‘ trang tÆ°Æ¡ng á»©ng Ä‘á»ƒ ngÆ°á»i dÃ¹ng Ä‘iá»u hÆ°á»›ng Ä‘áº¿n trang Ä‘Ã³.
  - CÃ¡c nÃºt sá»‘ trang cÅ©ng Ä‘Æ°á»£c kÃ­ch hoáº¡t theo tráº¡ng thÃ¡i hiá»‡n táº¡i cá»§a `pageIndex` vÃ  `data.totalPages`.

- Xá»­ lÃ½ sá»± kiá»‡n vÃ  prefetch truy váº¥n:

  - Khi ngÆ°á»i dÃ¹ng nháº¥p vÃ o nÃºt `"Previous"` hoáº·c `"Next"`, chÃºng ta cáº­p nháº­t `pageIndex` vÃ  sá»­ dá»¥ng `queryClient.prefetchQuery` Ä‘á»ƒ prefetch truy váº¥n cho trang trÆ°á»›c hoáº·c sau Ä‘Ã³.
  - Khi ngÆ°á»i dÃ¹ng nháº¥p vÃ o má»™t nÃºt sá»‘ trang, chÃºng ta cÅ©ng cáº­p nháº­t `pageIndex` vÃ  prefetch truy váº¥n cho trang Ä‘Ã³.
  - Viá»‡c prefetch truy váº¥n giÃºp táº£i trÆ°á»›c dá»¯ liá»‡u cho cÃ¡c trang tiáº¿p theo, cáº£i thiá»‡n tráº£i nghiá»‡m ngÆ°á»i dÃ¹ng khi há» chuyá»ƒn Ä‘áº¿n cÃ¡c trang má»›i.

## â“â“ `((pageIndex - 1) * PAGE_SIZE) + index + 1`. TÃ´i chÆ°a hiá»ƒu cÃ¡ch tÃ­nh chá»‰ má»¥c hiá»‡n sá»‘ thá»© tá»± cá»§a ngÆ°á»i dÃ¹ng, hÃ£y giáº£i thÃ­ch cÃ´ng thá»©c Ä‘Ã³ ?

- CÃ´ng thá»©c `((pageIndex - 1) * PAGE_SIZE) + index + 1` Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tÃ­nh chá»‰ má»¥c hoáº·c sá»‘ thá»© tá»± cá»§a má»™t ngÆ°á»i dÃ¹ng trong má»™t danh sÃ¡ch phÃ¢n trang.

- Giáº£ sá»­ báº¡n Ä‘ang lÃ m viá»‡c vá»›i má»™t danh sÃ¡ch ngÆ°á»i dÃ¹ng Ä‘Æ°á»£c chia thÃ nh cÃ¡c trang cÃ³ kÃ­ch thÆ°á»›c lÃ  `PAGE_SIZE` (sá»‘ lÆ°á»£ng ngÆ°á»i dÃ¹ng trÃªn má»—i trang). CÃ´ng thá»©c nÃ y sáº½ tÃ­nh toÃ¡n chá»‰ má»¥c cá»§a ngÆ°á»i dÃ¹ng trong danh sÃ¡ch tá»•ng thá»ƒ, khÃ´ng phá»¥ thuá»™c vÃ o trang hiá»‡n táº¡i.

- CÃ¡ch tÃ­nh toÃ¡n nhÆ° sau:

  - `pageIndex` lÃ  chá»‰ má»¥c cá»§a trang hiá»‡n táº¡i, báº¯t Ä‘áº§u tá»« 1. VÃ­ dá»¥, trang Ä‘áº§u tiÃªn sáº½ cÃ³ `pageIndex = 1`, trang thá»© hai sáº½ cÃ³ `pageIndex = 2`, vÃ  cá»© tiáº¿p tá»¥c nhÆ° váº­y.
  - `PAGE_SIZE` lÃ  sá»‘ lÆ°á»£ng ngÆ°á»i dÃ¹ng trÃªn má»—i trang.
  - `index` lÃ  chá»‰ má»¥c cá»§a ngÆ°á»i dÃ¹ng trong pháº¡m vi trang hiá»‡n táº¡i, báº¯t Ä‘áº§u tá»« 0. VÃ­ dá»¥, ngÆ°á»i dÃ¹ng Ä‘áº§u tiÃªn trÃªn trang sáº½ cÃ³ `index = 0`, ngÆ°á»i dÃ¹ng thá»© hai sáº½ cÃ³ `index = 1`, vÃ  cá»© tiáº¿p tá»¥c nhÆ° váº­y.

- CÃ´ng thá»©c sáº½ tÃ­nh toÃ¡n chá»‰ má»¥c cá»§a ngÆ°á»i dÃ¹ng trong danh sÃ¡ch tá»•ng thá»ƒ nhÆ° sau:

  - `(pageIndex - 1) * PAGE_SIZE`: TÃ­nh toÃ¡n sá»‘ lÆ°á»£ng ngÆ°á»i dÃ¹ng Ä‘Ã£ xuáº¥t hiá»‡n trÆ°á»›c trang hiá»‡n táº¡i. VÃ­ dá»¥, náº¿u `pageIndex = 2` vÃ  `PAGE_SIZE = 10`, thÃ¬ cÃ³ 10 ngÆ°á»i dÃ¹ng Ä‘Ã£ xuáº¥t hiá»‡n trÃªn trang Ä‘áº§u tiÃªn, nÃªn cÃ´ng thá»©c nÃ y sáº½ tráº£ vá» 10.
  - `index + 1`: Cá»™ng thÃªm chá»‰ má»¥c cá»§a ngÆ°á»i dÃ¹ng trong pháº¡m vi trang hiá»‡n táº¡i (tÃ­nh tá»« 0), sau Ä‘Ã³ tÄƒng thÃªm 1 Ä‘á»ƒ Ä‘Æ°a vá» sá»‘ thá»© tá»±. VÃ­ dá»¥, náº¿u `index = 3`, thÃ¬ cÃ´ng thá»©c nÃ y sáº½ tráº£ vá» 4.

- Káº¿t quáº£ cá»§a cÃ´ng thá»©c lÃ  chá»‰ má»¥c hoáº·c sá»‘ thá»© tá»± cá»§a ngÆ°á»i dÃ¹ng trong danh sÃ¡ch tá»•ng thá»ƒ, báº¯t Ä‘áº§u tá»« 1.

## â“â“ TÃ´i chÆ°a hÃ¬nh dung ra. HÃ£y cho vÃ­ dá»¥ tÃ­nh thá»­ ?

- ChÃºng ta sáº½ láº¥y vÃ­ dá»¥ vá»›i `PAGE_SIZE = 10`, tá»©c lÃ  cÃ³ 10 ngÆ°á»i dÃ¹ng trÃªn má»—i trang. Giáº£ sá»­ chÃºng ta Ä‘ang á»Ÿ `pageIndex = 3` (trang thá»© 3) vÃ  xem xÃ©t ngÆ°á»i dÃ¹ng cÃ³ `index = 5` (ngÆ°á»i dÃ¹ng thá»© 6 trÃªn trang hiá»‡n táº¡i).

- Ãp dá»¥ng cÃ´ng thá»©c `((pageIndex - 1) * PAGE_SIZE) + index + 1`, ta cÃ³:

- (3 - 1) \* 10 = 20: CÃ³ 20 ngÆ°á»i dÃ¹ng Ä‘Ã£ xuáº¥t hiá»‡n trÆ°á»›c trang hiá»‡n táº¡i (2 trang Ä‘áº§u).
- 5 + 1 = 6: NgÆ°á»i dÃ¹ng thá»© 6 trÃªn trang hiá»‡n táº¡i.

- Káº¿t há»£p hai giÃ¡ trá»‹ nÃ y, ta tÃ­nh Ä‘Æ°á»£c chá»‰ má»¥c hoáº·c sá»‘ thá»© tá»± cá»§a ngÆ°á»i dÃ¹ng trong danh sÃ¡ch tá»•ng thá»ƒ:

- 20 + 6 = 26: NgÆ°á»i dÃ¹ng nÃ y lÃ  ngÆ°á»i dÃ¹ng thá»© 26 trong danh sÃ¡ch tá»•ng thá»ƒ.

- Váº­y, trong trÆ°á»ng há»£p nÃ y, ngÆ°á»i dÃ¹ng thá»© 6 trÃªn trang 3 sáº½ cÃ³ chá»‰ má»¥c hoáº·c sá»‘ thá»© tá»± lÃ  26.

---

3. Synchronization (Äá»“ng bá»™ hÃ³a):

- Sá»­ dá»¥ng React Query Ä‘á»ƒ Ä‘á»“ng bá»™ hÃ³a dá»¯ liá»‡u giá»¯a cÃ¡c thÃ nh pháº§n vÃ  trang trong á»©ng dá»¥ng.
- Sá»­ dá»¥ng `useQueryClient` Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c tÃ¡c vá»¥ nhÆ° ghi dá»¯ liá»‡u má»›i vÃ o cache, xÃ³a cache vÃ  lÃ m má»›i dá»¯ liá»‡u.

- Äá»ƒ minh há»a vÃ­ dá»¥ vá» Ä‘á»“ng bá»™ hÃ³a trong React Query, ta cÃ³ thá»ƒ tÆ°á»Ÿng tÆ°á»£ng má»™t á»©ng dá»¥ng chat real-time. Khi ngÆ°á»i dÃ¹ng gá»­i má»™t tin nháº¯n má»›i, ta muá»‘n tin nháº¯n Ä‘Ã³ xuáº¥t hiá»‡n ngay láº­p tá»©c trÃªn giao diá»‡n cá»§a ngÆ°á»i nháº­n mÃ  khÃ´ng cáº§n pháº£i `refresh` láº¡i trang.

- DÆ°á»›i Ä‘Ã¢y lÃ  má»™t vÃ­ dá»¥ giáº£n Ä‘Æ¡n vá» Ä‘á»“ng bá»™ hÃ³a tin nháº¯n trong má»™t á»©ng dá»¥ng chat sá»­ dá»¥ng React Query:

```jsx
import { useEffect } from 'react'
import { useQuery, useMutation, useQueryClient } from 'react-query'

function ChatRoom() {
  const queryClient = useQueryClient()

  const { data: messages, isLoading } = useQuery('messages', () => fetch('/api/messages').then((res) => res.json()))

  const addMessage = useMutation((newMessage) =>
    fetch('/api/messages', {
      method: 'POST',
      body: JSON.stringify(newMessage)
    }).then((res) => res.json())
  )

  useEffect(() => {
    const subscription = subscribeToRealtimeMessages((newMessage) => {
      // Khi nháº­n Ä‘Æ°á»£c má»™t tin nháº¯n real-time má»›i
      queryClient.setQueryData('messages', (oldMessages) => [...oldMessages, newMessage])
    })

    return () => {
      // Há»§y Ä‘Äƒng kÃ½ khi component bá»‹ unmount
      subscription.unsubscribe()
    }
  }, [])

  const handleSendMessage = (message) => {
    addMessage.mutate(message)
  }

  if (isLoading) {
    return <div>Loading...</div>
  }

  return (
    <div>
      <h2>Chat Room</h2>
      <MessageList messages={messages} />
      <SendMessageForm onSendMessage={handleSendMessage} />
    </div>
  )
}

function MessageList({ messages }) {
  return (
    <ul>
      {messages.map((message) => (
        <li key={message.id}>{message.text}</li>
      ))}
    </ul>
  )
}

function SendMessageForm({ onSendMessage }) {
  const handleSubmit = (e) => {
    e.preventDefault()
    const message = e.target.elements.message.value
    onSendMessage(message)
    e.target.reset()
  }

  return (
    <form onSubmit={handleSubmit}>
      <input type='text' name='message' placeholder='Type a message' required />
      <button type='submit'>Send</button>
    </form>
  )
}
```

- Trong vÃ­ dá»¥ trÃªn, chÃºng ta sá»­ dá»¥ng `useQuery` Ä‘á»ƒ láº¥y danh sÃ¡ch tin nháº¯n tá»« API. Khi cÃ³ tin nháº¯n má»›i Ä‘Æ°á»£c thÃªm vÃ o thÃ´ng qua mutation `addMessage`, chÃºng ta sá»­ dá»¥ng `setQueryData` Ä‘á»ƒ cáº­p nháº­t dá»¯ liá»‡u cá»§a truy váº¥n `'messages'`. Äiá»u nÃ y sáº½ gÃ¢y ra viá»‡c re-render (kÃ­ch hoáº¡t viá»‡c render láº¡i) tá»± Ä‘á»™ng vÃ  tin nháº¯n má»›i sáº½ Ä‘Æ°á»£c hiá»ƒn thá»‹ ngay láº­p tá»©c trÃªn giao diá»‡n cá»§a ngÆ°á»i nháº­n.

- ThÃªm vÃ o Ä‘Ã³, chÃºng ta sá»­ dá»¥ng `useEffect` Ä‘á»ƒ Ä‘Äƒng kÃ½ má»™t `subscription` Ä‘á»ƒ láº¯ng nghe tin nháº¯n real-time má»›i. Khi cÃ³ tin nháº¯n má»›i Ä‘áº¿n, chÃºng ta sá»­ dá»¥ng `setQueryData` Ä‘á»ƒ cáº­p nháº­t dá»¯ liá»‡u cá»§a truy váº¥n `'messages'`, tá»« Ä‘Ã³ kÃ­ch hoáº¡t viá»‡c re-render (kÃ­ch hoáº¡t viá»‡c render láº¡i) vÃ  tin nháº¯n má»›i sáº½ Ä‘Æ°á»£c hiá»ƒn thá»‹ ngay láº­p tá»©c.

- Äiá»u nÃ y cho phÃ©p á»©ng dá»¥ng chat cá»§a chÃºng ta Ä‘á»“ng bá»™ hÃ³a tin nháº¯n giá»¯a cÃ¡c ngÆ°á»i dÃ¹ng vÃ  hiá»ƒn thá»‹ nhanh chÃ³ng cÃ¡c tin nháº¯n má»›i.

## ğŸ‘‰ Giáº£i thÃ­ch chi tiáº¿t Ä‘oáº¡n code trÃªn:

- Trong Ä‘oáº¡n mÃ£ trÃªn, chÃºng ta cÃ³ má»™t thÃ nh pháº§n (component) `ChatRoom` lÃ  má»™t component React chá»‹u trÃ¡ch nhiá»‡m hiá»ƒn thá»‹ má»™t phÃ²ng chat. HÃ£y giáº£i thÃ­ch tá»«ng pháº§n cá»§a mÃ£ nÃ y:

- Import dependencies: ChÃºng ta import hook `useEffect` tá»« thÆ° viá»‡n React vÃ  cÃ¡c hook `useQuery`, `useMutation`, `useQueryClient` tá»« thÆ° viá»‡n React Query Ä‘á»ƒ sá»­ dá»¥ng trong component.

- Khá»Ÿi táº¡o vÃ  sá»­ dá»¥ng hook `useQueryClient` vÃ  `useQuery`: ChÃºng ta sá»­ dá»¥ng hook `useQueryClient` Ä‘á»ƒ láº¥y instance cá»§a `queryClient`, má»™t Ä‘á»‘i tÆ°á»£ng Ä‘Æ°á»£c cung cáº¥p bá»Ÿi React Query Ä‘á»ƒ quáº£n lÃ½ cache vÃ  thá»±c hiá»‡n cÃ¡c tÃ¡c vá»¥ liÃªn quan Ä‘áº¿n truy váº¥n. ChÃºng ta cÅ©ng sá»­ dá»¥ng hook `useQuery` Ä‘á»ƒ gá»­i má»™t truy váº¥n Ä‘áº¿n `/api/messages` Ä‘á»ƒ láº¥y dá»¯ liá»‡u tin nháº¯n tá»« server. Káº¿t quáº£ cá»§a truy váº¥n Ä‘Æ°á»£c lÆ°u trong biáº¿n `messages`.

- Khá»Ÿi táº¡o vÃ  sá»­ dá»¥ng hook `useMutation`: ChÃºng ta sá»­ dá»¥ng hook `useMutation` Ä‘á»ƒ táº¡o má»™t mutation `addMessage`. Mutation nÃ y Ä‘áº¡i diá»‡n cho hÃ nh Ä‘á»™ng gá»­i tin nháº¯n má»›i lÃªn server thÃ´ng qua phÆ°Æ¡ng thá»©c POST cá»§a endpoint `/api/messages`. Khi gá»i hÃ m `addMessage.mutate(message)`, nÃ³ sáº½ gá»­i tin nháº¯n má»›i lÃªn server vÃ  tráº£ vá» káº¿t quáº£ tá»« server.

- Sá»­ dá»¥ng hook `useEffect` Ä‘á»ƒ Ä‘Äƒng kÃ½ vÃ  há»§y Ä‘Äƒng kÃ½ sá»± kiá»‡n real-time: Trong `useEffect`, chÃºng ta Ä‘Äƒng kÃ½ má»™t `subscription` Ä‘á»ƒ láº¯ng nghe cÃ¡c tin nháº¯n real-time má»›i. Khi nháº­n Ä‘Æ°á»£c má»™t tin nháº¯n má»›i, chÃºng ta sá»­ dá»¥ng `queryClient.setQueryData` Ä‘á»ƒ cáº­p nháº­t dá»¯ liá»‡u trong cache. Báº±ng cÃ¡ch truyá»n vÃ o key `messages` vÃ  má»™t hÃ m callback, chÃºng ta thÃªm tin nháº¯n má»›i vÃ o danh sÃ¡ch tin nháº¯n hiá»‡n cÃ³.

- Xá»­ lÃ½ sá»± kiá»‡n gá»­i tin nháº¯n: Khi ngÆ°á»i dÃ¹ng gá»­i tin nháº¯n thÃ´ng qua form `SendMessageForm`, chÃºng ta gá»i hÃ m `handleSendMessage` vÃ  truyá»n ná»™i dung tin nháº¯n vÃ o. HÃ m nÃ y sá»­ dá»¥ng mutation `addMessage.mutate` Ä‘á»ƒ gá»­i tin nháº¯n lÃªn server.

- Xá»­ lÃ½ tráº¡ng thÃ¡i táº£i: Náº¿u Ä‘ang táº£i dá»¯ liá»‡u (`isLoading` lÃ  `true`), chÃºng ta hiá»ƒn thá»‹ thÃ´ng bÃ¡o `"Loading..."`.

- Render giao diá»‡n: Tráº£ vá» má»™t giao diá»‡n phÃ²ng chat, bao gá»“m tiÃªu Ä‘á» `"Chat Room"`, component `MessageList` Ä‘á»ƒ hiá»ƒn thá»‹ danh sÃ¡ch tin nháº¯n vÃ  component `SendMessageForm` Ä‘á»ƒ cho phÃ©p ngÆ°á»i dÃ¹ng gá»­i tin nháº¯n.

- `Component MessageList`: Nháº­n danh sÃ¡ch tin nháº¯n (`messages`) vÃ  hiá»ƒn thá»‹ chÃºng dÆ°á»›i dáº¡ng danh sÃ¡ch (`ul`). Má»—i tin nháº¯n Ä‘Æ°á»£c hiá»ƒn thá»‹ báº±ng má»™t má»¥c (`li`) vá»›i key lÃ  `message.id` vÃ  hiá»ƒn thá»‹ ná»™i dung tin nháº¯n (`message.text`).

- `Component SendMessageForm`:

  - Nháº­n hÃ m `onSendMessage` Ä‘á»ƒ xá»­ lÃ½ viá»‡c gá»­i tin nháº¯n má»›i. Khi ngÆ°á»i dÃ¹ng submit form, chÃºng ta láº¥y ná»™i dung tin nháº¯n tá»« `input` vÃ  gá»i hÃ m `onSendMessage` Ä‘á»ƒ gá»­i tin nháº¯n. Form sáº½ Ä‘Æ°á»£c reset sau khi gá»­i tin nháº¯n thÃ nh cÃ´ng.

  - `onSendMessage` lÃ  má»™t prop cá»§a component `SendMessageForm`. Khi ngÆ°á»i dÃ¹ng nháº¥n submit trong form, hÃ m `handleSubmit` Ä‘Æ°á»£c gá»i vÃ  nÃ³ láº¥y ná»™i dung tin nháº¯n tá»« input. Sau Ä‘Ã³, hÃ m `onSendMessage` Ä‘Æ°á»£c gá»i vÃ  truyá»n ná»™i dung tin nháº¯n tá»›i Ä‘Ã³. Trong trÆ°á»ng há»£p nÃ y, `onSendMessage={handleSendMessage}` Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ gÃ¡n hÃ m `handleSendMessage` vÃ o prop `onSendMessage` cá»§a component `SendMessageForm`, vÃ¬ váº­y khi ngÆ°á»i dÃ¹ng nháº¥n submit, hÃ m `handleSendMessage` sáº½ Ä‘Æ°á»£c gá»i Ä‘á»ƒ xá»­ lÃ½ viá»‡c gá»­i tin nháº¯n má»›i.

- âœ… Äoáº¡n mÃ£ trÃªn mÃ´ táº£ má»™t cÃ¡ch sá»­ dá»¥ng React Query Ä‘á»ƒ quáº£n lÃ½ tráº¡ng thÃ¡i vÃ  tÆ°Æ¡ng tÃ¡c vá»›i dá»¯ liá»‡u tin nháº¯n trong má»™t á»©ng dá»¥ng chat.

## â“â“ á» trong vÃ­ dá»¥ Ä‘Ã³, khi re-render láº¡i cÃ³ lÃ m cho trang load láº¡i khÃ´ng ?

- Trong vÃ­ dá»¥ trÃªn, khi cÃ³ tin nháº¯n má»›i Ä‘Æ°á»£c thÃªm vÃ o vÃ  dá»¯ liá»‡u truy váº¥n 'messages' Ä‘Æ°á»£c cáº­p nháº­t báº±ng cÃ¡ch sá»­ dá»¥ng `setQueryData`, React Query sáº½ tá»± Ä‘á»™ng re-render cÃ¡c thÃ nh pháº§n liÃªn quan Ä‘áº¿n truy váº¥n Ä‘Ã³. Tuy nhiÃªn, viá»‡c re-render nÃ y khÃ´ng gÃ¢y ra viá»‡c load láº¡i toÃ n bá»™ trang.

- React Query sá»­ dá»¥ng cÆ¡ cháº¿ virtual DOM Ä‘á»ƒ chá»‰ cáº­p nháº­t cÃ¡c thÃ nh pháº§n bá»‹ thay Ä‘á»•i trong cÃ¢y DOM thá»±c táº¿, mÃ  khÃ´ng lÃ m reload láº¡i toÃ n bá»™ trang web. NhÆ° váº­y, chá»‰ cÃ³ pháº§n giao diá»‡n liÃªn quan Ä‘áº¿n danh sÃ¡ch tin nháº¯n (component `MessageList`) sáº½ Ä‘Æ°á»£c re-render, trong khi cÃ¡c thÃ nh pháº§n khÃ¡c váº«n Ä‘Æ°á»£c giá»¯ nguyÃªn tráº¡ng thÃ¡i vÃ  khÃ´ng bá»‹ load láº¡i.

- Äiá»u nÃ y giÃºp tá»‘i Æ°u hÃ³a hiá»‡u suáº¥t á»©ng dá»¥ng vÃ  Ä‘áº£m báº£o ráº±ng viá»‡c cáº­p nháº­t dá»¯ liá»‡u má»›i khÃ´ng lÃ m máº¥t Ä‘i tráº¡ng thÃ¡i hiá»‡n táº¡i cá»§a cÃ¡c thÃ nh pháº§n khÃ¡c trÃªn trang.

- âŒâŒ VÃ­ dá»¥ vá» Ä‘á»“ng bá»™ vÃ  gá»­i tin nháº¯n nÃ¢ng cao hÆ¡n vá» React Query:

- DÆ°á»›i Ä‘Ã¢y lÃ  má»™t vÃ­ dá»¥ nÃ¢ng cao hÆ¡n vá» Ä‘á»“ng bá»™ hÃ³a vÃ  gá»­i tin nháº¯n trong React Query:

```jsx
import { useState } from 'react'
import { useQuery, useMutation, useQueryClient } from 'react-query'

function ChatRoom() {
  const queryClient = useQueryClient()
  const [messageInput, setMessageInput] = useState('')

  // Truy váº¥n Ä‘á»ƒ láº¥y danh sÃ¡ch tin nháº¯n
  const { data: messages, isLoading: isLoadingMessages } = useQuery('messages', () =>
    fetch('/api/messages').then((res) => res.json())
  )

  // Mutation Ä‘á»ƒ gá»­i tin nháº¯n má»›i
  const sendMessage = useMutation((newMessage) =>
    fetch('/api/messages', {
      method: 'POST',
      body: JSON.stringify(newMessage)
    }).then((res) => res.json())
  )

  const handleSendMessage = async () => {
    if (messageInput.trim() === '') {
      return
    }

    const newMessage = { content: messageInput }
    await sendMessage.mutateAsync(newMessage)

    // Sau khi gá»­i tin nháº¯n thÃ nh cÃ´ng, ta sáº½ cáº­p nháº­t danh sÃ¡ch tin nháº¯n
    queryClient.invalidateQueries('messages')

    setMessageInput('')
  }

  if (isLoadingMessages) {
    return <div>Loading messages...</div>
  }

  return (
    <div>
      <h2>Chat Room</h2>
      <div>
        {messages.map((message) => (
          <div key={message.id}>
            <p>{message.content}</p>
            <p>Sent by: {message.sender}</p>
          </div>
        ))}
      </div>
      <div>
        <input type='text' value={messageInput} onChange={(e) => setMessageInput(e.target.value)} />
        <button onClick={handleSendMessage}>Send</button>
      </div>
    </div>
  )
}
```

- Trong vÃ­ dá»¥ nÃ y, chÃºng ta sá»­ dá»¥ng truy váº¥n `useQuery` Ä‘á»ƒ láº¥y danh sÃ¡ch tin nháº¯n tá»« API vÃ  mutation `useMutation` Ä‘á»ƒ gá»­i tin nháº¯n má»›i. Khi ngÆ°á»i dÃ¹ng gá»­i tin nháº¯n, chÃºng ta sá»­ dá»¥ng `mutateAsync` Ä‘á»ƒ gá»i API gá»­i tin nháº¯n vÃ  sau Ä‘Ã³ cáº­p nháº­t danh sÃ¡ch tin nháº¯n báº±ng cÃ¡ch sá»­ dá»¥ng `invalidateQueries`. Äiá»u nÃ y Ä‘áº£m báº£o ráº±ng danh sÃ¡ch tin nháº¯n sáº½ Ä‘Æ°á»£c Ä‘á»“ng bá»™ hÃ³a vá»›i dá»¯ liá»‡u má»›i nháº¥t.

- ThÃªm vÃ o Ä‘Ã³, chÃºng ta kiá»ƒm tra xem `messageInput` cÃ³ giÃ¡ trá»‹ trá»‘ng hay khÃ´ng trÆ°á»›c khi gá»­i tin nháº¯n Ä‘á»ƒ Ä‘áº£m báº£o tÃ­nh há»£p lá»‡ cá»§a dá»¯ liá»‡u nháº­p.

- Vá»›i vÃ­ dá»¥ nÃ y, báº¡n cÃ³ thá»ƒ nÃ¢ng cao báº±ng cÃ¡ch thÃªm chá»©c nÄƒng nhÆ° xÃ³a tin nháº¯n, chá»‰nh sá»­a tin nháº¯n, gá»­i tin nháº¯n riÃªng tÆ° cho ngÆ°á»i dÃ¹ng khÃ¡c, vÃ  cÃ¡c chá»©c nÄƒng phá»©c táº¡p hÆ¡n ná»¯a tÃ¹y thuá»™c vÃ o yÃªu cáº§u cá»¥ thá»ƒ cá»§a á»©ng dá»¥ng cá»§a báº¡n.

## ğŸ‘‰ Giáº£i thÃ­ch Ä‘oáº¡n code chi tiáº¿t:

-

- âŒâŒ ThÃªm 1 vÃ i chá»©c nÄƒng nÃ¢ng cao hÆ¡n:

- DÆ°á»›i Ä‘Ã¢y lÃ  má»™t phiÃªn báº£n phÃ¡t triá»ƒn cá»§a vÃ­ dá»¥ trÆ°á»›c Ä‘Ã³, bao gá»“m chá»©c nÄƒng xÃ³a tin nháº¯n, chá»‰nh sá»­a tin nháº¯n vÃ  gá»­i tin nháº¯n riÃªng tÆ° cho ngÆ°á»i dÃ¹ng khÃ¡c:

```jsx
import { useState } from 'react'
import { useQuery, useMutation, useQueryClient } from 'react-query'

function ChatRoom() {
  const queryClient = useQueryClient()
  const [messageInput, setMessageInput] = useState('')
  const [editingMessageId, setEditingMessageId] = useState(null)

  // Truy váº¥n Ä‘á»ƒ láº¥y danh sÃ¡ch tin nháº¯n
  const { data: messages, isLoading: isLoadingMessages } = useQuery('messages', () =>
    fetch('/api/messages').then((res) => res.json())
  )

  // Mutation Ä‘á»ƒ gá»­i tin nháº¯n má»›i
  const sendMessage = useMutation((newMessage) =>
    fetch('/api/messages', {
      method: 'POST',
      body: JSON.stringify(newMessage)
    }).then((res) => res.json())
  )

  // Mutation Ä‘á»ƒ xÃ³a tin nháº¯n
  const deleteMessage = useMutation((messageId) =>
    fetch(`/api/messages/${messageId}`, {
      method: 'DELETE'
    }).then((res) => res.json())
  )

  // Mutation Ä‘á»ƒ cáº­p nháº­t tin nháº¯n
  const updateMessage = useMutation((updatedMessage) =>
    fetch(`/api/messages/${updatedMessage.id}`, {
      method: 'PUT',
      body: JSON.stringify(updatedMessage)
    }).then((res) => res.json())
  )

  const handleSendMessage = async () => {
    if (messageInput.trim() === '') {
      return
    }

    const newMessage = { content: messageInput }
    await sendMessage.mutateAsync(newMessage)

    // Sau khi gá»­i tin nháº¯n thÃ nh cÃ´ng, ta sáº½ cáº­p nháº­t danh sÃ¡ch tin nháº¯n
    queryClient.invalidateQueries('messages')

    setMessageInput('')
  }

  const handleDeleteMessage = async (messageId) => {
    await deleteMessage.mutateAsync(messageId)

    // Sau khi xÃ³a tin nháº¯n thÃ nh cÃ´ng, ta sáº½ cáº­p nháº­t danh sÃ¡ch tin nháº¯n
    queryClient.invalidateQueries('messages')
  }

  const handleEditMessage = (messageId) => {
    setEditingMessageId(messageId)
  }

  const handleUpdateMessage = async (updatedContent) => {
    const updatedMessage = { id: editingMessageId, content: updatedContent }
    await updateMessage.mutateAsync(updatedMessage)

    // Sau khi cáº­p nháº­t tin nháº¯n thÃ nh cÃ´ng, ta sáº½ cáº­p nháº­t danh sÃ¡ch tin nháº¯n
    queryClient.invalidateQueries('messages')

    setEditingMessageId(null)
  }

  if (isLoadingMessages) {
    return <div>Loading messages...</div>
  }

  return (
    <div>
      <h2>Chat Room</h2>
      <div>
        {messages.map((message) => (
          <div key={message.id}>
            {editingMessageId === message.id ? (
              <div>
                <input type='text' value={message.content} onChange={(e) => handleUpdateMessage(e.target.value)} />
                <button onClick={() => setEditingMessageId(null)}>Cancel</button>
              </div>
            ) : (
              <div>
                <p>{message.content}</p>
                <p>Sent by: {message.sender}</p>
                <button onClick={() => handleDeleteMessage(message.id)}>Delete</button>
                <button onClick={() => handleEditMessage(message.id)}>Edit</button>
              </div>
            )}
          </div>
        ))}
      </div>
      <div>
        <input type='text' value={messageInput} onChange={(e) => setMessageInput(e.target.value)} />
        <button onClick={handleSendMessage}>Send</button>
      </div>
    </div>
  )
}
```

- Trong vÃ­ dá»¥ trÃªn, chÃºng ta Ä‘Ã£ sá»­ dá»¥ng hai mutation Ä‘á»ƒ xá»­ lÃ½ cÃ¡c hÃ nh Ä‘á»™ng xÃ³a vÃ  cáº­p nháº­t tin nháº¯n. Khi xÃ³a tin nháº¯n, chÃºng ta gá»i mutation `deleteMessage` vÃ  sau Ä‘Ã³ cáº­p nháº­t danh sÃ¡ch tin nháº¯n báº±ng cÃ¡ch gá»i `queryClient.invalidateQueries('messages')`. TÆ°Æ¡ng tá»±, khi cáº­p nháº­t tin nháº¯n, chÃºng ta gá»i mutation `updateMessage` vÃ  sau Ä‘Ã³ cáº­p nháº­t danh sÃ¡ch tin nháº¯n báº±ng cÃ¡ch gá»i `queryClient.invalidateQueries('messages')`. Äiá»u nÃ y Ä‘áº£m báº£o ráº±ng dá»¯ liá»‡u tin nháº¯n sáº½ Ä‘Æ°á»£c cáº­p nháº­t vÃ  Ä‘á»“ng bá»™ hÃ³a Ä‘Ãºng khi cÃ³ sá»± thay Ä‘á»•i.

- ThÃªm vÃ o Ä‘Ã³, chÃºng ta Ä‘Ã£ thÃªm chá»©c nÄƒng chá»‰nh sá»­a tin nháº¯n báº±ng cÃ¡ch cho phÃ©p ngÆ°á»i dÃ¹ng nháº¥p vÃ o nÃºt `"Edit"` Ä‘á»ƒ kÃ­ch hoáº¡t cháº¿ Ä‘á»™ chá»‰nh sá»­a vÃ  cáº­p nháº­t ná»™i dung tin nháº¯n. Khi ngÆ°á»i dÃ¹ng nháº¥p vÃ o nÃºt `"Cancel"`, chÃºng ta há»§y bá» cháº¿ Ä‘á»™ chá»‰nh sá»­a.

- NgoÃ i ra, chÃºng ta cÅ©ng Ä‘Ã£ thÃªm chá»©c nÄƒng gá»­i tin nháº¯n riÃªng tÆ° cho ngÆ°á»i dÃ¹ng khÃ¡c. NgÆ°á»i dÃ¹ng cÃ³ thá»ƒ nháº­p ná»™i dung tin nháº¯n vÃ o Ã´ input vÃ  nháº¥p vÃ o nÃºt `"Send"` Ä‘á»ƒ gá»­i tin nháº¯n má»›i. Sau khi gá»­i tin nháº¯n thÃ nh cÃ´ng, chÃºng ta cáº­p nháº­t danh sÃ¡ch tin nháº¯n báº±ng cÃ¡ch gá»i `queryClient.invalidateQueries('messages')`.

- Vá»›i cÃ¡c chá»©c nÄƒng nÃ y, chÃºng ta cÃ³ má»™t chat room Ä‘Æ¡n giáº£n nhÆ°ng Ä‘áº§y Ä‘á»§ vá»›i kháº£ nÄƒng gá»­i, xÃ³a, chá»‰nh sá»­a vÃ  Ä‘á»“ng bá»™ hÃ³a tin nháº¯n.

## ğŸ‘‰ Giáº£i thÃ­ch Ä‘oáº¡n code chi tiáº¿t:

---

4. Mutations (Thay Ä‘á»•i dá»¯ liá»‡u):

- Sá»­ dá»¥ng React Query Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c thay Ä‘á»•i dá»¯ liá»‡u nhÆ° táº¡o má»›i, cáº­p nháº­t hoáº·c xÃ³a dá»¯ liá»‡u thÃ´ng qua mutations.
- Sá»­ dá»¥ng `useMutation` Ä‘á»ƒ gá»­i cÃ¡c yÃªu cáº§u thay Ä‘á»•i dá»¯ liá»‡u Ä‘áº¿n API vÃ  quáº£n lÃ½ tráº¡ng thÃ¡i cá»§a yÃªu cáº§u.

---

5. Real-time Data (Dá»¯ liá»‡u thá»i gian thá»±c):

- Sá»­ dá»¥ng React Query káº¿t há»£p vá»›i `WebSocket` hoáº·c cÃ´ng nghá»‡ khÃ¡c Ä‘á»ƒ nháº­n dá»¯ liá»‡u thá»i gian thá»±c tá»« server vÃ  tá»± Ä‘á»™ng cáº­p nháº­t dá»¯ liá»‡u trÃªn giao diá»‡n ngÆ°á»i dÃ¹ng.

---

6. Error Handling (Xá»­ lÃ½ lá»—i):

- Sá»­ dá»¥ng React Query Ä‘á»ƒ xá»­ lÃ½ lá»—i khi gá»i API vÃ  hiá»ƒn thá»‹ thÃ´ng bÃ¡o lá»—i cho ngÆ°á»i dÃ¹ng.
- Sá»­ dá»¥ng `onError` option hoáº·c `useErrorBoundary` Ä‘á»ƒ xá»­ lÃ½ lá»—i vÃ  thá»±c hiá»‡n cÃ¡c hÃ nh Ä‘á»™ng phÃ¹ há»£p.

---

## React query cÃ³ thay tháº¿ redux khÃ´ng ?

---

## Trong cÃ¡c dá»± Ã¡n thÃ¬ cÃ´ng nghá»‡ React Query cÃ³ Ä‘Æ°á»£c sá»­ dá»¥ng nhiá»u khÃ´ng ?

---

## âœ…âœ… Nháº¯c láº¡i kiáº¿n thá»©c cÅ©:

ğŸ‘‰ `invalidateQueries` lÃ m cho vÃ´ hiá»‡u cache lÃ  sao ? TÃ´i chÆ°a hiá»ƒu láº¯m ? HÃ£y giáº£i thÃ­ch nhiá»u hÆ¡n, chi tiáº¿t hÆ¡n, vÃ  rÃµ rÃ ng hÆ¡n ?

- Äá»ƒ hiá»ƒu rÃµ `invalidateQueries` lÃ m gÃ¬, chÃºng ta cáº§n hiá»ƒu cache lÃ  gÃ¬ vÃ  nÃ³ hoáº¡t Ä‘á»™ng nhÆ° tháº¿ nÃ o trong React Query.

- Cache lÃ  má»™t kho dá»¯ liá»‡u táº¡m thá»i Ä‘Æ°á»£c lÆ°u trá»¯ Ä‘á»ƒ phá»¥c vá»¥ cho viá»‡c truy xuáº¥t dá»¯ liá»‡u nhanh hÆ¡n. Thay vÃ¬ pháº£i táº£i dá»¯ liá»‡u tá»« API má»—i láº§n, React Query sáº½ lÆ°u káº¿t quáº£ cá»§a query vÃ o cache.

- Khi báº¡n thá»±c hiá»‡n query tiáº¿p theo, React Query sáº½ kiá»ƒm tra xem nÃ³ cÃ³ náº±m trong cache hay khÃ´ng. Náº¿u cÃ³, nÃ³ sáº½ tráº£ vá» dá»¯ liá»‡u tá»« cache thay vÃ¬ gá»i API. Äiá»u nÃ y giÃºp cáº£i thiá»‡n hiá»‡u nÄƒng á»©ng dá»¥ng.

- Tuy nhiÃªn, náº¿u dá»¯ liá»‡u bá»‹ thay Ä‘á»•i bá»Ÿi má»™t mutation, dá»¯ liá»‡u trong cache sáº½ lá»—i thá»i. Äá»ƒ kháº¯c phá»¥c, chÃºng ta cáº§n vÃ´ hiá»‡u hÃ³a (invalidate) cache.

- `invalidateQueries` sáº½:

- XoÃ¡ dá»¯ liá»‡u cá»§a cÃ¡c query Ä‘Ã£ chá»‰ Ä‘á»‹nh khá»i cache
- Buá»™c React Query pháº£i gá»i API Ä‘á»ƒ láº¥y dá»¯ liá»‡u má»›i nháº¥t cho nhá»¯ng query Ä‘Ã³
- Cáº­p nháº­t káº¿t quáº£ má»›i vÃ o cache.

- NÃ³i cÃ¡ch khÃ¡c, `invalidateQueries` Ä‘áº£m báº£o ráº±ng dá»¯ liá»‡u Ä‘Æ°á»£c tráº£ vá» tá»« cache luÃ´n lÃ  dá»¯ liá»‡u má»›i nháº¥t, Ä‘Ã£ Ä‘Æ°á»£c cáº­p nháº­t.

- VÃ­ dá»¥, náº¿u báº¡n cáº­p nháº­t má»™t todo, báº¡n cáº§n gá»i `invalidateQueries('todos')` Ä‘á»ƒ buá»™c todos query pháº£i láº¥y dá»¯ liá»‡u má»›i nháº¥t vÃ  cáº­p nháº­t cache.

- Hi vá»ng Ä‘iá»u nÃ y giÃºp báº¡n hiá»ƒu rÃµ hÆ¡n vá» `invalidateQueries` vÃ  cache trong React Query!

## ÄÃ¢y lÃ  Docs cá»§a ÄÆ°á»£c Dev:

Cuá»‘i cÃ¹ng thÃ¬ chÃºng ta cÅ©ng Ä‘Ã£ Ä‘i Ä‘áº¿n video cuá»‘i cÃ¹ng trong series nÃ y, trong video nÃ y thÃ¬ mÃ¬nh sáº½ hÆ°á»›ng dáº«n cÃ¡c báº¡n nhá»¯ng kiáº¿n thá»©c cuá»‘i cÃ¹ng trong React Query. Yay ğŸ˜, hy vá»ng qua series nÃ y cÃ¡c báº¡n Ä‘Ã£ há»c Ä‘Æ°á»£c nhiá»u Ä‘iá»u thÃº vá»‹.

ğŸ’“Kiáº¿n thá»©c cÃ¡c báº¡n sáº½ Ä‘Æ°á»£c há»c trong video nÃ y:

ğŸ‰ Hiá»ƒu rÃµ hÆ¡n cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a fetching vá»›i staleTime
ğŸ‰ Táº¡o spinner loading global dá»±a trÃªn query vÃ  mutation
ğŸ‰ Biáº¿t Ä‘Æ°á»£c cÃ¡ch dÃ¹ng AbortController
ğŸ‰ Cancel Request trong React Query

ğŸ•°ï¸Ná»™i dung chÃ­nh

```bash
00:00 - Ã”n táº­p láº¡i staleTime
07:46 - Fetching Indicators
14:06 - Query Cancellation
```

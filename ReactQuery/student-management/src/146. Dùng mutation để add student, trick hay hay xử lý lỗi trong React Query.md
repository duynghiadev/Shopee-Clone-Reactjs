## ÄÃ¢y lÃ  Docs tá»± research:

## Náº¿u useQuery dÃ¹ng Ä‘á»ƒ GET thÃ¬ useMutation dÃ¹ng Ä‘á»ƒ POST, PUT, DELETE ? HÃ£y nÃªu sá»± khÃ¡c nhau ?

- ÄÃºng, trong React Query, `useMutation` Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c thao tÃ¡c POST, PUT vÃ  DELETE (thay Ä‘á»•i dá»¯ liá»‡u) liÃªn quan Ä‘áº¿n viá»‡c gá»­i yÃªu cáº§u tá»›i server. DÆ°á»›i Ä‘Ã¢y lÃ  sá»± khÃ¡c nhau chÃ­nh giá»¯a `useQuery` vÃ  `useMutation`:

1. `TÃ¡c Ä‘á»™ng lÃªn dá»¯ liá»‡u:` `useQuery` chá»‰ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ truy váº¥n dá»¯ liá»‡u (GET) tá»« server, trong khi `useMutation` Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c thao tÃ¡c thay Ä‘á»•i dá»¯ liá»‡u nhÆ° táº¡o má»›i (POST), cáº­p nháº­t (PUT) vÃ  xÃ³a (DELETE) dá»¯ liá»‡u trÃªn server.

2. `HÃ nh Ä‘á»™ng:` `useQuery` táº¡o ra má»™t `instance` truy váº¥n dá»¯ liá»‡u, giÃºp ta láº¥y dá»¯ liá»‡u tá»« server vÃ  lÆ°u trá»¯ vÃ o cache. Trong khi Ä‘Ã³, `useMutation` táº¡o ra má»™t `instance` thá»±c hiá»‡n thao tÃ¡c thay Ä‘á»•i dá»¯ liá»‡u, giÃºp ta gá»­i yÃªu cáº§u thay Ä‘á»•i dá»¯ liá»‡u tá»›i server vÃ  xá»­ lÃ½ káº¿t quáº£ tráº£ vá».

3. `TÃ­nh nÄƒng cung cáº¥p:` `useQuery` cung cáº¥p cÃ¡c tÃ­nh nÄƒng nhÆ° caching, tá»± Ä‘á»™ng fetch láº¡i dá»¯ liá»‡u khi cáº§n thiáº¿t, background fetching, vÃ  nhiá»u tÃ¹y chá»n khÃ¡c liÃªn quan Ä‘áº¿n truy váº¥n dá»¯ liá»‡u. Trong khi Ä‘Ã³, `useMutation` cung cáº¥p cÃ¡c tÃ­nh nÄƒng nhÆ° tá»± Ä‘á»™ng lÃ m má»›i cache sau khi thao tÃ¡c thay Ä‘á»•i dá»¯ liá»‡u thÃ nh cÃ´ng, xá»­ lÃ½ lá»—i vÃ  thÃ nh cÃ´ng, vÃ  nhiá»u tÃ¹y chá»n khÃ¡c liÃªn quan Ä‘áº¿n thao tÃ¡c thay Ä‘á»•i dá»¯ liá»‡u.

4. `Callback functions:` Trong `useMutation`, ta cÃ³ thá»ƒ Ä‘á»‹nh nghÄ©a cÃ¡c callback functions nhÆ° `onSuccess`, `onError`, `onSettled` Ä‘á»ƒ xá»­ lÃ½ káº¿t quáº£ vÃ  cÃ¡c tráº¡ng thÃ¡i cá»§a thao tÃ¡c thay Ä‘á»•i dá»¯ liá»‡u.

- TÃ³m láº¡i, `useMutation` lÃ  má»™t hook trong React Query Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c thao tÃ¡c thay Ä‘á»•i dá»¯ liá»‡u (POST, PUT, DELETE) vÃ  cung cáº¥p cÃ¡c tÃ­nh nÄƒng vÃ  tÃ¹y chá»n liÃªn quan Ä‘áº¿n thao tÃ¡c thay Ä‘á»•i dá»¯ liá»‡u.

- Tiáº¿p tá»¥c vá»›i sá»± khÃ¡c nhau giá»¯a `useQuery` vÃ  `useMutation` trong React Query:

1. `Tham sá»‘ Ä‘áº§u vÃ o:` Khi sá»­ dá»¥ng `useQuery`, ta truyá»n `queryKey` vÃ  `queryFn` Ä‘á»ƒ xÃ¡c Ä‘á»‹nh key cá»§a truy váº¥n vÃ  hÃ m Ä‘á»ƒ láº¥y dá»¯ liá»‡u tá»« server. Trong khi Ä‘Ã³, khi sá»­ dá»¥ng `useMutation`, ta truyá»n `mutationFn` Ä‘á»ƒ xÃ¡c Ä‘á»‹nh hÃ m thá»±c hiá»‡n thao tÃ¡c thay Ä‘á»•i dá»¯ liá»‡u.

2. `Tráº¡ng thÃ¡i vÃ  káº¿t quáº£:` `useQuery` cung cáº¥p cÃ¡c tráº¡ng thÃ¡i nhÆ° `isLoading`, `isError`, `isSuccess` Ä‘á»ƒ xÃ¡c Ä‘á»‹nh tráº¡ng thÃ¡i cá»§a truy váº¥n dá»¯ liá»‡u vÃ  `data` Ä‘á»ƒ lÆ°u trá»¯ káº¿t quáº£ tráº£ vá» tá»« server. Trong khi Ä‘Ã³, `useMutation` cung cáº¥p cÃ¡c tráº¡ng thÃ¡i nhÆ° `isLoading`, `isError`, `isSuccess` Ä‘á»ƒ xÃ¡c Ä‘á»‹nh tráº¡ng thÃ¡i cá»§a thao tÃ¡c thay Ä‘á»•i dá»¯ liá»‡u vÃ  khÃ´ng tráº£ vá» káº¿t quáº£ tá»« server.

- Khi sá»­ dá»¥ng hook `useQuery`, báº¡n cÃ³ thá»ƒ thá»±c hiá»‡n truy váº¥n dá»¯ liá»‡u tá»« mÃ¡y chá»§.
- Khi sá»­ dá»¥ng hook `useMutation`, báº¡n cÃ³ thá»ƒ thá»±c hiá»‡n cÃ¡c thao tÃ¡c thay Ä‘á»•i dá»¯ liá»‡u, cháº³ng háº¡n nhÆ° táº¡o, cáº­p nháº­t hoáº·c xÃ³a dá»¯ liá»‡u trÃªn mÃ¡y chá»§.

3. `Cáº­p nháº­t cache:` Khi sá»­ dá»¥ng `useQuery`, React Query tá»± Ä‘á»™ng cáº­p nháº­t cache khi cÃ³ dá»¯ liá»‡u má»›i tá»« server hoáº·c khi cache háº¿t háº¡n. Trong khi Ä‘Ã³, khi sá»­ dá»¥ng `useMutation`, ta cáº§n xá»­ lÃ½ cáº­p nháº­t cache thá»§ cÃ´ng sau khi thao tÃ¡c thay Ä‘á»•i dá»¯ liá»‡u thÃ nh cÃ´ng.

4. `Tá»‘i Æ°u hÃ³a:` `useQuery` cung cáº¥p cÃ¡c tÃ­nh nÄƒng tá»‘i Æ°u hÃ³a nhÆ° `caching`, `background fetching` vÃ  `refetching` tá»± Ä‘á»™ng dá»±a trÃªn cÃ¡c tÆ°Æ¡ng tÃ¡c cá»§a ngÆ°á»i dÃ¹ng. Trong khi Ä‘Ã³, `useMutation` táº­p trung vÃ o viá»‡c thá»±c hiá»‡n thao tÃ¡c thay Ä‘á»•i dá»¯ liá»‡u má»™t cÃ¡ch Ä‘Ã¡ng tin cáº­y vÃ  xá»­ lÃ½ káº¿t quáº£ tÆ°Æ¡ng á»©ng.

- TÃ³m láº¡i, `useQuery` vÃ  `useMutation` lÃ  hai hook trong React Query Ä‘Æ°á»£c sá»­ dá»¥ng cho má»¥c Ä‘Ã­ch khÃ¡c nhau. `useQuery` Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ truy váº¥n dá»¯ liá»‡u (GET) tá»« server vÃ  cung cáº¥p cÃ¡c tÃ­nh nÄƒng liÃªn quan Ä‘áº¿n truy váº¥n dá»¯ liá»‡u. `useMutation` Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c thao tÃ¡c thay Ä‘á»•i dá»¯ liá»‡u (POST, PUT, DELETE) vÃ  cung cáº¥p cÃ¡c tÃ­nh nÄƒng liÃªn quan Ä‘áº¿n thao tÃ¡c thay Ä‘á»•i dá»¯ liá»‡u.

## ThÃªm student vá»›i useMutation trong React Query ?

- Äá»ƒ thÃªm má»™t sinh viÃªn má»›i sá»­ dá»¥ng `useMutation` trong React Query, báº¡n cÃ³ thá»ƒ thá»±c hiá»‡n cÃ¡c bÆ°á»›c sau:

1. Äá»‹nh nghÄ©a hÃ m thá»±c hiá»‡n thao tÃ¡c thÃªm sinh viÃªn (`POST`) lÃªn server:

```jsx
const addStudent = async (newStudent) => {
  const response = await fetch('api/students', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify(newStudent)
  })

  if (!response.ok) {
    throw new Error('Failed to add student')
  }

  const data = await response.json()
  return data
}
```

2. Sá»­ dá»¥ng `useMutation` Ä‘á»ƒ táº¡o má»™t mutation hook Ä‘á»ƒ thá»±c hiá»‡n thao tÃ¡c thÃªm sinh viÃªn:

```jsx
import { useMutation } from 'react-query'

const AddStudentForm = () => {
  const mutation = useMutation(addStudent)

  const handleSubmit = (event) => {
    event.preventDefault()
    const formData = new FormData(event.target)
    const newStudent = Object.fromEntries(formData.entries())
    mutation.mutate(newStudent)
  }

  return (
    <form onSubmit={handleSubmit}>
      <input type='text' name='name' placeholder='Name' required />
      <input type='text' name='age' placeholder='Age' required />
      <button type='submit' disabled={mutation.isLoading}>
        {mutation.isLoading ? 'Adding...' : 'Add Student'}
      </button>
      {mutation.isError && <div>Error: {mutation.error.message}</div>}
      {mutation.isSuccess && <div>Student added successfully!</div>}
    </form>
  )
}
```

- Trong vÃ­ dá»¥ trÃªn, `mutation` lÃ  má»™t object Ä‘Æ°á»£c tráº£ vá» tá»« hook `useMutation`. Báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng `mutation.mutate` Ä‘á»ƒ kÃ­ch hoáº¡t thao tÃ¡c thÃªm sinh viÃªn khi form Ä‘Æ°á»£c submit. `mutation.isLoading`, `mutation.isError`, vÃ  `mutation.isSuccess` lÃ  cÃ¡c tráº¡ng thÃ¡i Ä‘á»ƒ xá»­ lÃ½ giao diá»‡n khi thao tÃ¡c Ä‘ang diá»…n ra, gáº·p lá»—i, hoáº·c thÃ nh cÃ´ng.

- LÆ°u Ã½ ráº±ng, viá»‡c xá»­ lÃ½ cáº­p nháº­t cache sau khi thÃªm sinh viÃªn thÃ nh cÃ´ng cáº§n phá»¥ thuá»™c vÃ o cáº¥u hÃ¬nh vÃ  quyáº¿t Ä‘á»‹nh cá»§a báº¡n. Báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡c phÆ°Æ¡ng thá»©c nhÆ° `queryClient.invalidateQueries` Ä‘á»ƒ cáº­p nháº­t cache cho danh sÃ¡ch sinh viÃªn hoáº·c trang chi tiáº¿t sinh viÃªn.

- ÄÃ¢y chá»‰ lÃ  má»™t vÃ­ dá»¥ cÆ¡ báº£n vá» viá»‡c sá»­ dá»¥ng `useMutation` Ä‘á»ƒ thÃªm sinh viÃªn. Báº¡n cÃ³ thá»ƒ tÃ¹y chá»‰nh vÃ  bá»• sung thÃªm theo nhu cáº§u cá»§a á»©ng dá»¥ng cá»§a mÃ¬nh.

## Giáº£i thÃ­ch chi tiáº¿t Ä‘oáº¡n code trÃªn:

```jsx
const addStudent = async (newStudent) => {
  const response = await fetch('api/students', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify(newStudent)
  })

  if (!response.ok) {
    throw new Error('Failed to add student')
  }

  const data = await response.json()
  return data
}
```

- Äoáº¡n code trÃªn Ä‘á»‹nh nghÄ©a má»™t hÃ m `addStudent` Ä‘á»ƒ thá»±c hiá»‡n thao tÃ¡c thÃªm sinh viÃªn má»›i (POST) lÃªn server thÃ´ng qua API endpoint `'api/students`'.

- HÃ m `addStudent` sá»­ dá»¥ng `fetch` Ä‘á»ƒ gá»­i má»™t request POST Ä‘áº¿n endpoint `'api/students'` vá»›i cÃ¡c thÃ´ng tin cá»§a sinh viÃªn má»›i Ä‘Æ°á»£c Ä‘Æ°a vÃ o trong body cá»§a request dÆ°á»›i dáº¡ng JSON. Äá»ƒ thá»±c hiá»‡n Ä‘iá»u nÃ y, `fetch` Ä‘Æ°á»£c gá»i vá»›i cÃ¡c tham sá»‘ nhÆ° sau:

- `method: 'POST':` Thuá»™c tÃ­nh `method` xÃ¡c Ä‘á»‹nh phÆ°Æ¡ng thá»©c HTTP Ä‘Æ°á»£c sá»­ dá»¥ng trong yÃªu cáº§u. Trong trÆ°á»ng há»£p nÃ y, phÆ°Æ¡ng thá»©c Ä‘Æ°á»£c sá»­ dá»¥ng lÃ  POST. PhÆ°Æ¡ng thá»©c POST Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ gá»­i dá»¯ liá»‡u tá»« client lÃªn mÃ¡y chá»§ Ä‘á»ƒ táº¡o hoáº·c cáº­p nháº­t tÃ i nguyÃªn.

- `headers: {'Content-Type': 'application/json'}:` Thuá»™c tÃ­nh `headers` Ä‘á»‹nh nghÄ©a cÃ¡c tiÃªu Ä‘á» (headers) cá»§a yÃªu cáº§u HTTP. Trong trÆ°á»ng há»£p nÃ y, Ä‘oáº¡n mÃ£ chá»‰ Ä‘á»‹nh má»™t tiÃªu Ä‘á» `'Content-Type'` vá»›i giÃ¡ trá»‹ `'application/json'`. TiÃªu Ä‘á» nÃ y cho biáº¿t ráº±ng dá»¯ liá»‡u trong yÃªu cáº§u Ä‘Æ°á»£c gá»­i dÆ°á»›i dáº¡ng JSON. Äiá»u nÃ y giÃºp mÃ¡y chá»§ hiá»ƒu cÃ¡ch xá»­ lÃ½ vÃ  phÃ¢n tÃ­ch ná»™i dung yÃªu cáº§u.

- `body: JSON.stringify(newStudent):` Thuá»™c tÃ­nh `body` Ä‘á»‹nh nghÄ©a ná»™i dung cá»§a yÃªu cáº§u HTTP. Trong trÆ°á»ng há»£p nÃ y, `JSON.stringify(newStudent)` Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ chuyá»ƒn Ä‘á»•i Ä‘á»‘i tÆ°á»£ng (object) `newStudent` thÃ nh chuá»—i JSON (JSON String). Chuá»—i JSON nÃ y sau Ä‘Ã³ Ä‘Æ°á»£c gÃ¡n cho thuá»™c tÃ­nh `body`. Äiá»u nÃ y Ä‘áº£m báº£o ráº±ng dá»¯ liá»‡u cá»§a `newStudent` Ä‘Æ°á»£c gá»­i Ä‘i dÆ°á»›i dáº¡ng chuá»—i JSON trong yÃªu cáº§u POST.

- Khi yÃªu cáº§u HTTP POST nÃ y Ä‘Æ°á»£c gá»­i Ä‘i, nÃ³ sáº½ chá»©a má»™t tiÃªu Ä‘á» `'Content-Type': 'application/json'` Ä‘á»ƒ chá»‰ Ä‘á»‹nh kiá»ƒu ná»™i dung lÃ  JSON vÃ  má»™t pháº§n body chá»©a dá»¯ liá»‡u cá»§a `newStudent` Ä‘Ã£ Ä‘Æ°á»£c chuyá»ƒn Ä‘á»•i thÃ nh chuá»—i JSON.

- `if (!response.ok):` ÄÃ¢y lÃ  má»™t cÃ¢u Ä‘iá»u kiá»‡n kiá»ƒm tra xem pháº£n há»“i tá»« mÃ¡y chá»§ cÃ³ thÃ nh cÃ´ng hay khÃ´ng. Pháº£n há»“i Ä‘Æ°á»£c coi lÃ  thÃ nh cÃ´ng náº¿u tráº¡ng thÃ¡i HTTP lÃ  trong khoáº£ng tá»« 200 Ä‘áº¿n 299 (bao gá»“m cáº£ 200 vÃ  299). Äiá»u kiá»‡n `!response.ok` kiá»ƒm tra xem tráº¡ng thÃ¡i HTTP cÃ³ náº±m ngoÃ i khoáº£ng thÃ nh cÃ´ng hay khÃ´ng.

- `throw new Error('Failed to add student'):` Náº¿u pháº£n há»“i khÃ´ng thÃ nh cÃ´ng, má»™t ngoáº¡i lá»‡ (exception) Ä‘Æ°á»£c nÃ©m báº±ng cÃ¡ch sá»­ dá»¥ng `throw`. Trong trÆ°á»ng há»£p nÃ y, má»™t Ä‘á»‘i tÆ°á»£ng lá»—i má»›i Ä‘Æ°á»£c táº¡o vá»›i thÃ´ng bÃ¡o `'Failed to add student'`. Ngoáº¡i lá»‡ nÃ y sáº½ Ä‘Æ°á»£c truyá»n cho pháº§n xá»­ lÃ½ lá»—i bÃªn ngoÃ i hÃ m hiá»‡n táº¡i Ä‘á»ƒ xá»­ lÃ½ tiáº¿p theo.

- `const data = await response.json():` Náº¿u pháº£n há»“i thÃ nh cÃ´ng, dá»¯ liá»‡u trong pháº£n há»“i Ä‘Æ°á»£c Ä‘á»c vÃ  chuyá»ƒn Ä‘á»•i tá»« Ä‘á»‹nh dáº¡ng JSON sang Ä‘á»‘i tÆ°á»£ng JavaScript báº±ng cÃ¡ch sá»­ dá»¥ng phÆ°Æ¡ng thá»©c `response.json()`. Káº¿t quáº£ cá»§a phÆ°Æ¡ng thá»©c nÃ y lÃ  má»™t lá»i há»©a (promise) Ä‘Æ°á»£c giáº£i quyáº¿t (resolved) khi dá»¯ liá»‡u JSON Ä‘Ã£ Ä‘Æ°á»£c chuyá»ƒn Ä‘á»•i thÃ nh Ä‘á»‘i tÆ°á»£ng JavaScript.

- `return data:` Káº¿t quáº£ cá»§a hÃ m lÃ  Ä‘á»‘i tÆ°á»£ng dá»¯ liá»‡u (`data`). Náº¿u má»i thá»© thÃ nh cÃ´ng, dá»¯ liá»‡u nÃ y sáº½ Ä‘Æ°á»£c tráº£ vá» cho ngÆ°á»i gá»i hÃ m Ä‘á»ƒ sá»­ dá»¥ng tiáº¿p.

- TÃ³m láº¡i, Ä‘oáº¡n mÃ£ trÃªn kiá»ƒm tra vÃ  xá»­ lÃ½ pháº£n há»“i tá»« mÃ¡y chá»§ sau má»™t yÃªu cáº§u HTTP. Náº¿u pháº£n há»“i thÃ nh cÃ´ng, nÃ³ tráº£ vá» dá»¯ liá»‡u tá»« pháº£n há»“i dÆ°á»›i dáº¡ng Ä‘á»‘i tÆ°á»£ng JavaScript. Náº¿u pháº£n há»“i khÃ´ng thÃ nh cÃ´ng, nÃ³ nÃ©m má»™t ngoáº¡i lá»‡ Ä‘á»ƒ xá»­ lÃ½ lá»—i.

## âŒâŒ LÆ°u Ã½: Táº¡i sao khÃ´ng dÃ¹ng `response.parse()` mÃ  láº¡i sá»­ dá»¥ng `response.json()`. Trong khi 2 dáº¡ng Ä‘Ã³ Ä‘á»u tráº£ vá» dáº¡ng Ä‘á»‘i tÆ°á»£ng jsvascript ?

- Tháº­t Ä‘Ãºng lÃ  cÃ³ má»™t sá»± khÃ¡c biá»‡t giá»¯a `response.parse()` vÃ  `response.json()`, vÃ  trong háº§u háº¿t cÃ¡c trÆ°á»ng há»£p, chÃºng ta sáº½ sá»­ dá»¥ng `response.json()` Ä‘á»ƒ chuyá»ƒn Ä‘á»•i pháº£n há»“i tá»« JSON sang Ä‘á»‘i tÆ°á»£ng JavaScript. DÆ°á»›i Ä‘Ã¢y lÃ  sá»± khÃ¡c biá»‡t chÃ­nh giá»¯a hai phÆ°Æ¡ng thá»©c nÃ y:

1. `response.parse():` PhÆ°Æ¡ng thá»©c `parse()` khÃ´ng tá»“n táº¡i trong Ä‘á»‘i tÆ°á»£ng `response` cá»§a má»™t yÃªu cáº§u HTTP. Thay vÃ o Ä‘Ã³, phÆ°Æ¡ng thá»©c `parse()` lÃ  má»™t phÆ°Æ¡ng thá»©c cá»§a Ä‘á»‘i tÆ°á»£ng `JSON` trong JavaScript. NÃ³ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ chuyá»ƒn Ä‘á»•i má»™t chuá»—i JSON thÃ nh má»™t Ä‘á»‘i tÆ°á»£ng JavaScript.

2. `response.json():` PhÆ°Æ¡ng thá»©c `json()` lÃ  má»™t phÆ°Æ¡ng thá»©c cá»§a Ä‘á»‘i tÆ°á»£ng `response` trong JavaScript. Khi gá»i phÆ°Æ¡ng thá»©c nÃ y trÃªn Ä‘á»‘i tÆ°á»£ng `response`, nÃ³ tráº£ vá» má»™t lá»i há»©a (promise) mÃ  khi giáº£i quyáº¿t (resolved), nÃ³ tráº£ vá» dá»¯ liá»‡u JSON Ä‘Æ°á»£c chuyá»ƒn Ä‘á»•i thÃ nh Ä‘á»‘i tÆ°á»£ng JavaScript.

- Sá»± khÃ¡c biá»‡t chÃ­nh giá»¯a hai phÆ°Æ¡ng thá»©c nÃ y lÃ  `response.json()` khÃ´ng chá»‰ chuyá»ƒn Ä‘á»•i JSON thÃ nh Ä‘á»‘i tÆ°á»£ng JavaScript, mÃ  nÃ³ cÅ©ng xá»­ lÃ½ viá»‡c Ä‘á»c vÃ  xá»­ lÃ½ dá»¯ liá»‡u tá»« pháº£n há»“i HTTP. NÃ³ tá»± Ä‘á»™ng Ä‘á»c vÃ  chuyá»ƒn Ä‘á»•i pháº£n há»“i thÃ nh dá»¯ liá»‡u JSON vÃ  tráº£ vá» má»™t há»©a chá»©a Ä‘á»‘i tÆ°á»£ng JavaScript Ä‘Ã£ chuyá»ƒn Ä‘á»•i.

- VÃ¬ váº­y, khi lÃ m viá»‡c vá»›i pháº£n há»“i tá»« má»™t yÃªu cáº§u HTTP, chÃºng ta sá»­ dá»¥ng `response.json()` Ä‘á»ƒ thuáº­n tiá»‡n Ä‘á»c vÃ  chuyá»ƒn Ä‘á»•i dá»¯ liá»‡u JSON thÃ nh Ä‘á»‘i tÆ°á»£ng JavaScript.

```jsx
import { useMutation } from 'react-query'

const AddStudentForm = () => {
  const mutation = useMutation(addStudent)

  const handleSubmit = (event) => {
    event.preventDefault()
    const formData = new FormData(event.target)
    const newStudent = Object.fromEntries(formData.entries())
    mutation.mutate(newStudent)
  }

  return (
    <form onSubmit={handleSubmit}>
      <input type='text' name='name' placeholder='Name' required />
      <input type='text' name='age' placeholder='Age' required />
      <button type='submit' disabled={mutation.isLoading}>
        {mutation.isLoading ? 'Adding...' : 'Add Student'}
      </button>
      {mutation.isError && <div>Error: {mutation.error.message}</div>}
      {mutation.isSuccess && <div>Student added successfully!</div>}
    </form>
  )
}
```

- Äoáº¡n code trÃªn Ä‘á»‹nh nghÄ©a má»™t component `AddStudentForm` sá»­ dá»¥ng `useMutation` tá»« React Query Ä‘á»ƒ thá»±c hiá»‡n thao tÃ¡c thÃªm sinh viÃªn má»›i.

- Trong component `AddStudentForm`, hÃ m `useMutation` Ä‘Æ°á»£c gá»i vá»›i Ä‘á»‘i sá»‘ lÃ  hÃ m `addStudent` (Ä‘Ã£ Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trÆ°á»›c Ä‘Ã³) Ä‘á»ƒ táº¡o ra má»™t Ä‘á»‘i tÆ°á»£ng `mutation`. Äá»‘i tÆ°á»£ng `mutation` chá»©a cÃ¡c phÆ°Æ¡ng thá»©c vÃ  tráº¡ng thÃ¡i liÃªn quan Ä‘áº¿n viá»‡c thá»±c hiá»‡n mutation (POST) vÃ  xá»­ lÃ½ káº¿t quáº£.

- Trong hÃ m `handleSubmit`, khi ngÆ°á»i dÃ¹ng gá»­i form báº±ng cÃ¡ch nháº¥n nÃºt `submit`, sá»± kiá»‡n `submit` Ä‘Æ°á»£c kÃ­ch hoáº¡t. HÃ m `handleSubmit` Ä‘Æ°á»£c gá»i vÃ  truyá»n vÃ o Ä‘á»‘i tÆ°á»£ng sá»± kiá»‡n event nhÆ° tham sá»‘.

- Äá»ƒ trÃ¡nh viá»‡c trÃ¬nh duyá»‡t gá»­i request vÃ  refresh trang, hÃ m `event.preventDefault()` Ä‘Æ°á»£c gá»i Ä‘á»ƒ ngÄƒn cháº·n hÃ nh vi máº·c Ä‘á»‹nh cá»§a form.

- Sau Ä‘Ã³, thÃ´ng tin tá»« form Ä‘Æ°á»£c láº¥y báº±ng cÃ¡ch táº¡o má»™t Ä‘á»‘i tÆ°á»£ng `formData` tá»« `event.target`, Ä‘áº¡i diá»‡n cho form Ä‘Æ°á»£c gá»­i Ä‘i. `FormData` lÃ  má»™t Ä‘á»‘i tÆ°á»£ng tÃ­ch há»£p sáºµn trong JavaScript cho phÃ©p truy cáº­p vÃ  xá»­ lÃ½ dá»¯ liá»‡u form.

- Tiáº¿p theo, `formData.entries()` tráº£ vá» má»™t iterator chá»©a táº¥t cáº£ cáº·p khÃ³a-giÃ¡ trá»‹ (key-value) trong form data. `Object.fromEntries()` Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ chuyá»ƒn Ä‘á»•i iterator nÃ y thÃ nh má»™t Ä‘á»‘i tÆ°á»£ng JSON `newStudent`, trong Ä‘Ã³ khÃ³a lÃ  tÃªn cá»§a cÃ¡c trÆ°á»ng form vÃ  giÃ¡ trá»‹ lÃ  giÃ¡ trá»‹ Ä‘Ã£ nháº­p.

- Cuá»‘i cÃ¹ng, `mutation.mutate(newStudent)` Ä‘Æ°á»£c gá»i Ä‘á»ƒ kÃ­ch hoáº¡t quÃ¡ trÃ¬nh mutation (POST) vá»›i Ä‘á»‘i tÆ°á»£ng `newStudent` lÃ  dá»¯ liá»‡u cáº§n thÃªm. QuÃ¡ trÃ¬nh nÃ y sáº½ Ä‘Æ°á»£c xá»­ lÃ½ bá»Ÿi React Query, bao gá»“m gá»­i request lÃªn server, xá»­ lÃ½ káº¿t quáº£ vÃ  cáº­p nháº­t cache náº¿u cáº§n.

- Äoáº¡n code trÃªn giÃºp káº¿t ná»‘i form vÃ  viá»‡c thá»±c hiá»‡n thao tÃ¡c thÃªm sinh viÃªn má»›i thÃ´ng qua `useMutation`, vÃ  cho phÃ©p xá»­ lÃ½ cÃ¡c tÆ°Æ¡ng tÃ¡c vá»›i form vÃ  quÃ¡ trÃ¬nh mutation má»™t cÃ¡ch dá»… dÃ ng trong React.

## âŒâŒ HÃ£y Ä‘á»‹nh nghÄ©a phÆ°Æ¡ng thá»©c entries() trong JavaScript lÃ  gÃ¬ ?

- PhÆ°Æ¡ng thá»©c `entries()` lÃ  má»™t phÆ°Æ¡ng thá»©c cá»§a Ä‘á»‘i tÆ°á»£ng `Object` trong JavaScript. NÃ³ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tráº£ vá» má»™t máº£ng chá»©a cÃ¡c cáº·p khÃ³a-giÃ¡ trá»‹ (`key-value`) cá»§a má»™t Ä‘á»‘i tÆ°á»£ng.

- Khi Ã¡p dá»¥ng phÆ°Æ¡ng thá»©c `entries()` lÃªn má»™t Ä‘á»‘i tÆ°á»£ng, nÃ³ sáº½ táº¡o ra má»™t máº£ng cÃ¡c cáº·p khÃ³a-giÃ¡ trá»‹, trong Ä‘Ã³ má»—i cáº·p bao gá»“m má»™t khÃ³a (key) vÃ  giÃ¡ trá»‹ (value) cá»§a thuá»™c tÃ­nh trong Ä‘á»‘i tÆ°á»£ng.

- VÃ­ dá»¥, xÃ©t má»™t Ä‘á»‘i tÆ°á»£ng `person` nhÆ° sau:

```jsx
const person = {
  name: 'John',
  age: 30,
  occupation: 'Engineer'
}
```

- Khi Ã¡p dá»¥ng `Object.entries(person)`, káº¿t quáº£ sáº½ lÃ  má»™t máº£ng chá»©a cÃ¡c cáº·p khÃ³a-giÃ¡ trá»‹ nhÆ° sau:

```jsx
;[
  ['name', 'John'],
  ['age', 30],
  ['occupation', 'Engineer']
]
```

- Má»—i pháº§n tá»­ trong máº£ng lÃ  má»™t máº£ng con chá»©a má»™t cáº·p khÃ³a-giÃ¡ trá»‹, trong Ä‘Ã³ pháº§n tá»­ Ä‘áº§u tiÃªn lÃ  khÃ³a vÃ  pháº§n tá»­ thá»© hai lÃ  giÃ¡ trá»‹ tÆ°Æ¡ng á»©ng.

- PhÆ°Æ¡ng thá»©c `entries()` ráº¥t há»¯u Ã­ch khi báº¡n muá»‘n láº·p qua cÃ¡c thuá»™c tÃ­nh cá»§a má»™t Ä‘á»‘i tÆ°á»£ng vÃ  thá»±c hiá»‡n cÃ¡c thao tÃ¡c trÃªn tá»«ng cáº·p khÃ³a-giÃ¡ trá»‹ trong Ä‘á»‘i tÆ°á»£ng Ä‘Ã³.

## âŒâŒ VÃ­ dá»¥ vá» entries() trong JavaScript ?

- Äá»ƒ minh há»a cÃ¡ch sá»­ dá»¥ng phÆ°Æ¡ng thá»©c `entries()`, hÃ£y xem xÃ©t vÃ­ dá»¥ sau:

```jsx
const person = {
  name: 'John',
  age: 30,
  occupation: 'Engineer'
}

// Sá»­ dá»¥ng phÆ°Æ¡ng thá»©c entries() Ä‘á»ƒ láº·p qua cÃ¡c cáº·p khÃ³a-giÃ¡ trá»‹ trong Ä‘á»‘i tÆ°á»£ng person
for (const [key, value] of Object.entries(person)) {
  console.log(`${key}: ${value}`)
}
```

- Äáº§u tiÃªn, chÃºng ta cÃ³ má»™t Ä‘á»‘i tÆ°á»£ng `person` Ä‘áº¡i diá»‡n cho thÃ´ng tin vá» má»™t ngÆ°á»i. ChÃºng ta muá»‘n láº·p qua cÃ¡c thuá»™c tÃ­nh cá»§a Ä‘á»‘i tÆ°á»£ng nÃ y vÃ  hiá»ƒn thá»‹ cáº·p khÃ³a-giÃ¡ trá»‹ tÆ°Æ¡ng á»©ng.

- Báº±ng cÃ¡ch sá»­ dá»¥ng phÆ°Æ¡ng thá»©c `Object.entries(person)`, chÃºng ta chuyá»ƒn Ä‘á»•i Ä‘á»‘i tÆ°á»£ng `person` thÃ nh má»™t máº£ng chá»©a cÃ¡c cáº·p khÃ³a-giÃ¡ trá»‹.

- Sau Ä‘Ã³, chÃºng ta sá»­ dá»¥ng má»™t vÃ²ng láº·p `for...of` Ä‘á»ƒ láº·p qua máº£ng cÃ¡c cáº·p khÃ³a-giÃ¡ trá»‹. Trong má»—i láº§n láº·p, chÃºng ta gÃ¡n khÃ³a vÃ  giÃ¡ trá»‹ tÆ°Æ¡ng á»©ng cho cÃ¡c biáº¿n `key` vÃ  `value`. Sau Ä‘Ã³, chÃºng ta hiá»ƒn thá»‹ cáº·p khÃ³a-giÃ¡ trá»‹ báº±ng cÃ¡ch sá»­ dá»¥ng `console.log()`.

- Káº¿t quáº£ cá»§a Ä‘oáº¡n mÃ£ trÃªn sáº½ lÃ :

```jsx
name: John
age: 30
occupation: Engineer
```

- Má»—i dÃ²ng Ä‘áº¡i diá»‡n cho má»™t cáº·p khÃ³a-giÃ¡ trá»‹ trong Ä‘á»‘i tÆ°á»£ng `person`, trong Ä‘Ã³ `key` lÃ  khÃ³a (vÃ­ dá»¥: 'name', 'age', 'occupation') vÃ  `value` lÃ  giÃ¡ trá»‹ tÆ°Æ¡ng á»©ng (vÃ­ dá»¥: 'John', 30, 'Engineer').

- Äiá»u nÃ y cho tháº¥y chÃºng ta Ä‘Ã£ láº·p qua cÃ¡c thuá»™c tÃ­nh cá»§a Ä‘á»‘i tÆ°á»£ng `person` vÃ  hiá»ƒn thá»‹ cáº·p khÃ³a-giÃ¡ trá»‹ tÆ°Æ¡ng á»©ng.

## Xá»­ lÃ½ lá»—i 422 khi submit form bá»‹ lá»—i trong React Query ?

## Reset error vÃ  data trong React Query ?

## Reset formState vá»›i mutationAsync trong React Query ?

## ÄÃ¢y lÃ  Docs cá»§a ÄÆ°á»£c Dev:

Náº¿u useQuery dÃ¹ng Ä‘á»ƒ GET thÃ¬ useMutation dÃ¹ng Ä‘á»ƒ POST, PUT, DELETE. Video nÃ y tiáº¿p ná»‘i video láº§n trÆ°á»›c chÃºng ta sáº½ thá»±c hiá»‡n chá»©c nÄƒng thÃªm há»c sinh ğŸ‰

ğŸ’“Kiáº¿n thá»©c cÃ¡c báº¡n sáº½ Ä‘Æ°á»£c há»c trong video nÃ y:

ğŸ‰ CÃ¡ch phÃ¢n trang vÃ  tá»‘i Æ°u UX vá»›i React Query
ğŸ‰ Nhá»¯ng state quan trá»ng trong React Query
ğŸ‰ CÆ¡ cháº¿ caching cá»§a React Query

ğŸ•°ï¸Ná»™i dung chÃ­nh

00:00 - add student vá»›i useMutation
28:38 - Xá»­ lÃ½ lá»—i 422 khi submit form bá»‹ lá»—i
48:20 - reset error vÃ  data
50:45 - reset formState vá»›i mutationAsync

```

```

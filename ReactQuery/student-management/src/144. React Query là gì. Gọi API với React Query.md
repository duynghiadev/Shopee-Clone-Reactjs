## ÄÃ¢y lÃ  Docs tá»± research:

## CÃ¡ch dÃ¹ng useQuery cÆ¡ báº£n trong React Query:

1. BÆ°á»›c Ä‘áº§u tiÃªn lÃ  cÃ i Ä‘áº·t React Query trong dá»± Ã¡n cá»§a báº¡n. Báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng npm hoáº·c yarn Ä‘á»ƒ cÃ i Ä‘áº·t:

```jsx
npm install react-query
```

hoáº·c

```jsx
yarn add react-query
```

2. Import `useQuery` tá»« thÆ° viá»‡n React Query vÃ o thÃ nh pháº§n React cá»§a báº¡n:

```jsx
import { useQuery } from 'react-query'
```

3. Sá»­ dá»¥ng `useQuery` trong thÃ nh pháº§n React cá»§a báº¡n. Äáº·t tÃªn biáº¿n vÃ  truyá»n vÃ o hai Ä‘á»‘i sá»‘: `queryKey` vÃ  `queryFn`.

```jsx
const ExampleComponent = () => {
  const { data, isLoading, error } = useQuery(queryKey, queryFn);

  // Xá»­ lÃ½ dá»¯ liá»‡u, hiá»ƒn thá»‹ thÃ´ng bÃ¡o lá»—i hoáº·c tráº¡ng thÃ¡i loading

  return (
    // JSX cá»§a thÃ nh pháº§n
  );
};
```

4. Äiá»u chá»‰nh `queryKey` vÃ  `queryFn` theo nhu cáº§u cá»§a báº¡n.

- `queryKey`: ÄÃ¢y lÃ  má»™t giÃ¡ trá»‹ duy nháº¥t Ä‘áº¡i diá»‡n cho truy váº¥n. NÃ³ cÃ³ thá»ƒ lÃ  má»™t chuá»—i, máº£ng hoáº·c má»™t Ä‘á»‘i tÆ°á»£ng. VÃ­ dá»¥: `'todos'`, `['todos', { userId: 1 }]`, `{ query: 'todos', userId: 1 }`.

- `queryFn`: ÄÃ¢y lÃ  má»™t hÃ m khÃ´ng Ä‘á»“ng bá»™ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ thá»±c hiá»‡n truy váº¥n dá»¯ liá»‡u. HÃ m nÃ y tráº£ vá» má»™t Promise chá»©a dá»¯ liá»‡u báº¡n muá»‘n truy váº¥n.

VÃ­ dá»¥:

```jsx
const queryFn = async () => {
  const response = await fetch('https://api.example.com/todos')
  const data = await response.json()
  return data
}
```

5. Sá»­ dá»¥ng `data`, `isLoading` vÃ  `error` Ä‘á»ƒ xá»­ lÃ½ dá»¯ liá»‡u vÃ  tráº¡ng thÃ¡i cá»§a truy váº¥n trong thÃ nh pháº§n React cá»§a báº¡n.

- `data`: Chá»©a dá»¯ liá»‡u tráº£ vá» tá»« truy váº¥n. Báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng nÃ³ Ä‘á»ƒ hiá»ƒn thá»‹ thÃ´ng tin trong thÃ nh pháº§n cá»§a báº¡n.
- `isLoading`: Má»™t biáº¿n boolean cho biáº¿t liá»‡u truy váº¥n Ä‘ang trong quÃ¡ trÃ¬nh táº£i dá»¯ liá»‡u hay khÃ´ng.
- `error`: Chá»©a thÃ´ng bÃ¡o lá»—i náº¿u truy váº¥n gáº·p pháº£i lá»—i.

6. Trong JSX cá»§a thÃ nh pháº§n React, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng `isLoading` Ä‘á»ƒ hiá»ƒn thá»‹ má»™t tráº¡ng thÃ¡i loading hoáº·c sá»­ dá»¥ng `data` Ä‘á»ƒ hiá»ƒn thá»‹ dá»¯ liá»‡u tráº£ vá». Xá»­ lÃ½ `error` Ä‘á»ƒ hiá»ƒn thá»‹ thÃ´ng bÃ¡o lá»—i náº¿u cáº§n thiáº¿t.

- ÄÃ¢y lÃ  má»™t vÃ­ dá»¥ Ä‘Æ¡n giáº£n vá» cÃ¡ch sá»­ dá»¥ng cÆ¡ báº£n cá»§a `useQuery` trong React Query. Báº¡n cÃ³ thá»ƒ tÃ¹y chá»‰nh `queryKey` vÃ  `queryFn` theo yÃªu cáº§u cá»¥ thá»ƒ cá»§a dá»± Ã¡n cá»§a báº¡n.

## Æ¯u Ä‘iá»ƒm tuyá»‡t vá»i khi so sÃ¡nh React Query vá»›i cÃ¡ch fetch data thÃ´ng qua useEffect:

- So sÃ¡nh React Query vá»›i cÃ¡ch fetch data thÃ´ng qua `useEffect`, cÃ³ má»™t sá»‘ Æ°u Ä‘iá»ƒm tuyá»‡t vá»i mÃ  React Query mang láº¡i:

1. `Caching (Bá»™ nhá»› cache)`: React Query tá»± Ä‘á»™ng lÆ°u trá»¯ káº¿t quáº£ truy váº¥n vÃ  cung cáº¥p chÃºng tá»« bá»™ nhá»› cache khi cáº§n thiáº¿t. Khi cÃ¹ng má»™t truy váº¥n Ä‘Æ°á»£c gá»i láº¡i, React Query sáº½ tráº£ vá» dá»¯ liá»‡u tá»« cache mÃ  khÃ´ng cáº§n thá»±c hiá»‡n láº¡i truy váº¥n máº¡ng. Äiá»u nÃ y giÃºp tiáº¿t kiá»‡m thá»i gian vÃ  tÃ i nguyÃªn máº¡ng.

2. `Invalidation (Há»§y bá» cache)`: React Query cung cáº¥p cÃ¡c phÆ°Æ¡ng phÃ¡p Ä‘á»ƒ há»§y bá» vÃ  cáº­p nháº­t cache khi cÃ³ sá»± thay Ä‘á»•i dá»¯ liá»‡u. Khi dá»¯ liá»‡u bá»‹ thay Ä‘á»•i, báº¡n cÃ³ thá»ƒ thÃ´ng bÃ¡o cho React Query Ä‘á»ƒ lÃ m má»›i cache vÃ  cáº­p nháº­t dá»¯ liá»‡u má»›i nháº¥t.

3. `Auto-Refetching (Tá»± Ä‘á»™ng fetch láº¡i)`: React Query cho phÃ©p tá»± Ä‘á»™ng fetch láº¡i dá»¯ liá»‡u sau má»™t khoáº£ng thá»i gian nháº¥t Ä‘á»‹nh hoáº·c khi cÃ³ sá»± kiá»‡n xáº£y ra. Báº¡n cÃ³ thá»ƒ Ä‘á»‹nh cáº¥u hÃ¬nh cho truy váº¥n tá»± Ä‘á»™ng cáº­p nháº­t Ä‘á»ƒ Ä‘áº£m báº£o dá»¯ liá»‡u luÃ´n Ä‘Æ°á»£c Ä‘á»“ng bá»™ vÃ  cáº­p nháº­t má»›i nháº¥t.

4. `Optimistic Updates (Cáº­p nháº­t láº¡c quan)`: React Query cho phÃ©p cáº­p nháº­t giao diá»‡n ngay láº­p tá»©c vÃ  sau Ä‘Ã³ lÃ m viá»‡c vá»›i dá»¯ liá»‡u báº¥t Ä‘á»“ng bá»™. Báº¡n cÃ³ thá»ƒ cáº­p nháº­t giao diá»‡n trÆ°á»›c khi truy váº¥n hoÃ n thÃ nh, mang láº¡i tráº£i nghiá»‡m ngÆ°á»i dÃ¹ng mÆ°á»£t mÃ  hÆ¡n.

5. `Error Handling (Xá»­ lÃ½ lá»—i)`: React Query há»— trá»£ xá»­ lÃ½ lá»—i má»™t cÃ¡ch linh hoáº¡t vÃ  cung cáº¥p cÃ¡c phÆ°Æ¡ng phÃ¡p Ä‘á»ƒ hiá»ƒn thá»‹ thÃ´ng bÃ¡o lá»—i cho ngÆ°á»i dÃ¹ng. Báº¡n cÃ³ thá»ƒ kiá»ƒm soÃ¡t cÃ¡ch xá»­ lÃ½ lá»—i vÃ  hiá»ƒn thá»‹ thÃ´ng bÃ¡o tÃ¹y chá»‰nh cho cÃ¡c trÆ°á»ng há»£p lá»—i khÃ¡c nhau.

- Tá»•ng thá»ƒ, React Query giÃºp Ä‘Æ¡n giáº£n hÃ³a viá»‡c quáº£n lÃ½ tráº¡ng thÃ¡i dá»¯ liá»‡u báº¥t Ä‘á»“ng bá»™, cache vÃ  xá»­ lÃ½ lá»—i trong á»©ng dá»¥ng React. NÃ³ cung cáº¥p má»™t cÃ¡ch tiáº¿p cáº­n máº¡nh máº½ vÃ  linh hoáº¡t Ä‘á»ƒ lÃ m viá»‡c vá»›i dá»¯ liá»‡u, giÃºp tÄƒng hiá»‡u suáº¥t vÃ  tráº£i nghiá»‡m ngÆ°á»i dÃ¹ng cá»§a á»©ng dá»¥ng cá»§a báº¡n.

## CÃ¡ch dÃ¹ng queryKey vÃ  queryFn:

- Cáº£ hai `queryKey` vÃ  `queryFn` Ä‘á»u lÃ  cÃ¡c Ä‘á»‘i sá»‘ trong hook `useQuery` cá»§a React Query vÃ  Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ xÃ¡c Ä‘á»‹nh truy váº¥n dá»¯ liá»‡u cá»¥ thá»ƒ.

1. queryKey:

- `queryKey` lÃ  má»™t giÃ¡ trá»‹ duy nháº¥t Ä‘áº¡i diá»‡n cho truy váº¥n. NÃ³ cÃ³ thá»ƒ lÃ  má»™t chuá»—i, máº£ng hoáº·c má»™t Ä‘á»‘i tÆ°á»£ng. `queryKey` Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ xÃ¡c Ä‘á»‹nh dá»¯ liá»‡u cáº§n truy váº¥n vÃ  cÅ©ng lÃ  má»™t pháº§n quan trá»ng trong viá»‡c quáº£n lÃ½ bá»™ nhá»› cache cá»§a React Query.

- VÃ­ dá»¥ vá»›i má»™t chuá»—i `queryKey`:

```jsx
const { data } = useQuery('todos', fetchTodos)
```

- Trong vÃ­ dá»¥ nÃ y, `'todos'` lÃ  `queryKey` Ä‘áº¡i diá»‡n cho truy váº¥n dá»¯ liá»‡u danh sÃ¡ch cÃ´ng viá»‡c.

- VÃ­ dá»¥ vá»›i má»™t máº£ng `queryKey`:

```jsx
const { data } = useQuery(['todos', { userId: 1 }], fetchUserTodos)
```

- Trong vÃ­ dá»¥ nÃ y, `['todos', { userId: 1 }]` lÃ  `queryKey` Ä‘áº¡i diá»‡n cho truy váº¥n dá»¯ liá»‡u danh sÃ¡ch cÃ´ng viá»‡c cá»§a má»™t ngÆ°á»i dÃ¹ng cá»¥ thá»ƒ (cÃ³ `userId` lÃ  1).

- VÃ­ dá»¥ vá»›i má»™t Ä‘á»‘i tÆ°á»£ng `queryKey`:

```jsx
const { data } = useQuery({ query: 'todos', userId: 1 }, fetchUserTodos)
```

- Trong vÃ­ dá»¥ nÃ y, `{ query: 'todos', userId: 1 }` lÃ  `queryKey` Ä‘áº¡i diá»‡n cho truy váº¥n dá»¯ liá»‡u danh sÃ¡ch cÃ´ng viá»‡c cá»§a má»™t ngÆ°á»i dÃ¹ng cá»¥ thá»ƒ (cÃ³ `userId` lÃ  1).

- Báº¡n cÃ³ thá»ƒ tÃ¹y chá»‰nh `queryKey` theo yÃªu cáº§u cá»¥ thá»ƒ cá»§a dá»± Ã¡n.

2. queryFn:

- `queryFn` lÃ  má»™t hÃ m khÃ´ng Ä‘á»“ng bá»™ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ thá»±c hiá»‡n truy váº¥n dá»¯ liá»‡u. HÃ m nÃ y tráº£ vá» má»™t `Promise` chá»©a dá»¯ liá»‡u báº¡n muá»‘n truy váº¥n.

- VÃ­ dá»¥:

```jsx
const fetchTodos = async () => {
  const response = await fetch('https://api.example.com/todos')
  const data = await response.json()
  return data
}

const { data } = useQuery('todos', fetchTodos)
```

- Trong vÃ­ dá»¥ nÃ y, `fetchTodos` lÃ  má»™t `queryFn` thá»±c hiá»‡n viá»‡c gá»­i yÃªu cáº§u máº¡ng Ä‘á»ƒ láº¥y dá»¯ liá»‡u danh sÃ¡ch cÃ´ng viá»‡c tá»« má»™t API. HÃ m nÃ y tráº£ vá» má»™t `Promise` chá»©a dá»¯ liá»‡u Ä‘Æ°á»£c gá»­i vá» tá»« API.

- Báº¡n cÃ³ thá»ƒ táº¡o vÃ  tÃ¹y chá»‰nh `queryFn` Ä‘á»ƒ phÃ¹ há»£p vá»›i nhu cáº§u truy váº¥n dá»¯ liá»‡u trong dá»± Ã¡n cá»§a báº¡n.

## Fetch API vá»›i useEffect vÃ  Axios:

- DÆ°á»›i Ä‘Ã¢y lÃ  vÃ­ dá»¥ vá» cÃ¡ch sá»­ dá»¥ng `useEffect` vÃ  `Axios` Ä‘á»ƒ thá»±c hiá»‡n Fetch API:

```jsx
import React, { useEffect, useState } from 'react'
import axios from 'axios'

const ExampleComponent = () => {
  const [data, setData] = useState(null)
  const [isLoading, setIsLoading] = useState(false)
  const [error, setError] = useState(null)

  useEffect(() => {
    const fetchData = async () => {
      setIsLoading(true)
      try {
        const response = await axios.get('https://api.example.com/data')
        setData(response.data)
        setIsLoading(false)
      } catch (error) {
        setError(error.message)
        setIsLoading(false)
      }
    }

    fetchData()
  }, [])

  if (isLoading) {
    return <div>Loading...</div>
  }

  if (error) {
    return <div>Error: {error}</div>
  }

  return (
    <div>
      {data && (
        <ul>
          {data.map((item) => (
            <li key={item.id}>{item.name}</li>
          ))}
        </ul>
      )}
    </div>
  )
}

export default ExampleComponent
```

- Trong vÃ­ dá»¥ nÃ y:

- ChÃºng ta sá»­ dá»¥ng hook `useState` Ä‘á»ƒ khá»Ÿi táº¡o cÃ¡c state `data`, `isLoading`, vÃ  `error`.
- Trong `useEffect`, chÃºng ta Ä‘á»‹nh nghÄ©a hÃ m `fetchData` Ä‘á»ƒ thá»±c hiá»‡n truy váº¥n dá»¯ liá»‡u. Trong trÆ°á»ng há»£p nÃ y, chÃºng ta sá»­ dá»¥ng `Axios` Ä‘á»ƒ gá»­i yÃªu cáº§u `GET` Ä‘áº¿n URL `'https://api.example.com/data'`. Khi yÃªu cáº§u thÃ nh cÃ´ng, dá»¯ liá»‡u Ä‘Æ°á»£c láº¥y tá»« pháº£n há»“i vÃ  Ä‘Æ°á»£c lÆ°u vÃ o state `data`, `isLoading` Ä‘Æ°á»£c Ä‘áº·t vá» `false`. Náº¿u xáº£y ra lá»—i, lá»—i Ä‘Æ°á»£c lÆ°u vÃ o state `error`, `isLoading` Ä‘Æ°á»£c Ä‘áº·t vá» `false`.
- ChÃºng ta gá»i hÃ m `fetchData` trong `useEffect` má»™t láº§n duy nháº¥t báº±ng cÃ¡ch truyá»n má»™t máº£ng rá»—ng `[]` lÃ m tham sá»‘ thá»© hai. Äiá»u nÃ y Ä‘áº£m báº£o ráº±ng truy váº¥n chá»‰ Ä‘Æ°á»£c thá»±c hiá»‡n má»™t láº§n khi `component` Ä‘Æ°á»£c `render` láº§n Ä‘áº§u tiÃªn.
- Trong JSX, chÃºng ta hiá»ƒn thá»‹ thÃ´ng bÃ¡o `"Loading..."` náº¿u `isLoading` lÃ  `true`, hiá»ƒn thá»‹ thÃ´ng bÃ¡o lá»—i náº¿u `error` tá»“n táº¡i, vÃ  hiá»ƒn thá»‹ dá»¯ liá»‡u tá»« `data` náº¿u tá»“n táº¡i.

- Vá»›i vÃ­ dá»¥ trÃªn, báº¡n cÃ³ thá»ƒ tÃ¹y chá»‰nh URL cá»§a API vÃ  xá»­ lÃ½ dá»¯ liá»‡u theo nhu cáº§u cá»§a dá»± Ã¡n cá»§a báº¡n.

## Fetch data vá»›i useQuery vÃ  Axios:

-

## CÃ i dev tool cho React Query:

## HÃ£y giáº£i thÃ­ch chi tiáº¿t vá» queryKey:

## HÃ£y giáº£i thÃ­ch chi tiáº¿t vá» queryFn:

## TÃ³m táº¯t vá» React Query:

## TÃ³m táº¯t vá» gá»i API vá»›i React Query:

## ÄÃ¢y lÃ  Docs cá»§a ÄÆ°á»£c Dev:

ğŸ’“Kiáº¿n thá»©c cÃ¡c báº¡n sáº½ Ä‘Æ°á»£c há»c trong video nÃ y:

ğŸ‰ CÃ¡ch dÃ¹ng useQuery cÆ¡ báº£n trong React Query
ğŸ‰ Æ¯u Ä‘iá»ƒm tuyá»‡t vá»i khi so sÃ¡nh React Query vá»›i cÃ¡ch fetch data thÃ´ng qua useEffect
ğŸ‰ CÃ¡ch dÃ¹ng queryKey vÃ  queryFn

ğŸ•°ï¸Ná»™i dung chÃ­nh

00:00 - Giá»›i thiá»‡u vá» series
03:47 - Giá»›i thiá»‡u vá» repository
07:58 - Fetch API vá»›i useEffect vÃ  Axios
23:29 - Fetch data vá»›i useQuery vÃ  Axios
36:47 - CÃ i dev tool cho React Query
38:58 - queryKey
47:05 - queryFn
47:53 - TÃ³m táº¯t kiáº¿n thá»©c Ä‘Ã£ há»c

![image bÃ i 144](image.png)

## ÄÃ¢y lÃ  Docs tá»± research:

## Sá»­ dá»¥ng react router káº¿t há»£p vá»›i react query ?

- Khi sá»­ dá»¥ng `React Router` káº¿t há»£p vá»›i `React Query`, chÃºng ta cÃ³ thá»ƒ táº­n dá»¥ng cÃ¡c tÃ­nh nÄƒng cá»§a cáº£ hai thÆ° viá»‡n Ä‘á»ƒ xÃ¢y dá»±ng á»©ng dá»¥ng web Ä‘Ã¡ng tin cáº­y vá»›i phÃ¢n trang vÃ  quáº£n lÃ½ dá»¯ liá»‡u hiá»‡u quáº£.

- DÆ°á»›i Ä‘Ã¢y lÃ  má»™t vÃ­ dá»¥ cÆ¡ báº£n vá» cÃ¡ch sá»­ dá»¥ng `React Router` vÃ  `React Query` cÃ¹ng nhau:

1. CÃ i Ä‘áº·t `React Router` vÃ  `React Query`:

```bash
npm install react-router-dom react-query
```

- DÃ²ng code nÃ y Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ cÃ i Ä‘áº·t hai thÆ° viá»‡n `React Router` vÃ  `React Query` thÃ´ng qua npm (Node Package Manager).

  - `npm` lÃ  má»™t cÃ´ng cá»¥ quáº£n lÃ½ gÃ³i cho Node.js vÃ  npm Registry lÃ  má»™t kho lÆ°u trá»¯ trá»±c tuyáº¿n chá»©a cÃ¡c gÃ³i pháº§n má»m JavaScript mÃ  báº¡n cÃ³ thá»ƒ táº£i xuá»‘ng vÃ  sá»­ dá»¥ng trong dá»± Ã¡n cá»§a mÃ¬nh.
  - `install` lÃ  má»™t lá»‡nh trong npm Ä‘á»ƒ cÃ i Ä‘áº·t cÃ¡c gÃ³i pháº§n má»m. Khi cháº¡y lá»‡nh install, npm sáº½ táº£i xuá»‘ng vÃ  cÃ i Ä‘áº·t cÃ¡c gÃ³i Ä‘Æ°á»£c liá»‡t kÃª trong dÃ²ng lá»‡nh vÃ o dá»± Ã¡n cá»§a báº¡n.
  - `react-router-dom` lÃ  má»™t thÆ° viá»‡n há»— trá»£ Ä‘á»‹nh tuyáº¿n (`routing`) trong React. NÃ³ cung cáº¥p cÃ¡c thÃ nh pháº§n (`component`) vÃ  API Ä‘á»ƒ báº¡n cÃ³ thá»ƒ xÃ¡c Ä‘á»‹nh cÃ¡c `route` vÃ  hiá»ƒn thá»‹ cÃ¡c component tÆ°Æ¡ng á»©ng vá»›i tá»«ng `route`.
  - `react-query` lÃ  má»™t thÆ° viá»‡n quáº£n lÃ½ tráº¡ng thÃ¡i vÃ  truy váº¥n dá»¯ liá»‡u trong React. NÃ³ cung cáº¥p cÃ¡c hooks vÃ  API Ä‘á»ƒ báº¡n cÃ³ thá»ƒ thá»±c hiá»‡n cÃ¡c truy váº¥n dá»¯ liá»‡u, lÆ°u trá»¯ káº¿t quáº£ vÃ  quáº£n lÃ½ cache má»™t cÃ¡ch dá»… dÃ ng.

- Khi cháº¡y dÃ²ng lá»‡nh trÃªn, npm sáº½ tÃ¬m kiáº¿m vÃ  táº£i vá» cÃ¡c gÃ³i `react-router-dom` vÃ  `react-query` tá»« npm Registry, sau Ä‘Ã³ cÃ i Ä‘áº·t chÃºng vÃ o thÆ° má»¥c node_modules trong dá»± Ã¡n cá»§a báº¡n. Sau khi quÃ¡ trÃ¬nh cÃ i Ä‘áº·t hoÃ n táº¥t, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡c thÃ nh pháº§n vÃ  API cá»§a hai thÆ° viá»‡n nÃ y trong á»©ng dá»¥ng React cá»§a mÃ¬nh.

2. Táº¡o cÃ¡c components vÃ  Ä‘á»‹nh nghÄ©a cÃ¡c route trong á»©ng dá»¥ng cá»§a báº¡n, vÃ­ dá»¥:

```jsx
import { BrowserRouter as Router, Switch, Route } from 'react-router-dom'
import { QueryClient, QueryClientProvider } from 'react-query'
import Home from './components/Home'
import PostList from './components/PostList'
import PostDetails from './components/PostDetails'

const queryClient = new QueryClient()

function App() {
  return (
    <QueryClientProvider client={queryClient}>
      <Router>
        <Switch>
          <Route exact path='/' component={Home} />
          <Route exact path='/posts' component={PostList} />
          <Route path='/posts/:id' component={PostDetails} />
        </Switch>
      </Router>
    </QueryClientProvider>
  )
}

export default App
```

- Äoáº¡n code trÃªn mÃ´ táº£ cÃ¡ch sá»­ dá»¥ng `React Router` vÃ  `React Query` trong á»©ng dá»¥ng React. DÆ°á»›i Ä‘Ã¢y lÃ  giáº£i thÃ­ch tá»«ng pháº§n cá»§a mÃ£ nguá»“n:

- `import { BrowserRouter as Router, Switch, Route } from 'react-router-dom':` ÄÃ¢y lÃ  cÃ¡ch import cÃ¡c thÃ nh pháº§n tá»« thÆ° viá»‡n `React Router`. `BrowserRouter` Ä‘Æ°á»£c Ä‘áº·t tÃªn láº¡i thÃ nh `Router` Ä‘á»ƒ sá»­ dá»¥ng trong mÃ£ nguá»“n.

- `import { QueryClient, QueryClientProvider } from 'react-query':` ÄÃ¢y lÃ  cÃ¡ch import cÃ¡c thÃ nh pháº§n tá»« thÆ° viá»‡n `React Query`. `QueryClient` lÃ  má»™t Ä‘á»‘i tÆ°á»£ng quáº£n lÃ½ tráº¡ng thÃ¡i vÃ  cache cá»§a `React Query`, vÃ  `QueryClientProvider` lÃ  má»™t thÃ nh pháº§n cung cáº¥p `QueryClient` cho cÃ¡c thÃ nh pháº§n con trong á»©ng dá»¥ng.

- `const queryClient = new QueryClient():` ÄÃ¢y lÃ  khá»Ÿi táº¡o má»™t instance cá»§a `QueryClient`, má»™t Ä‘á»‘i tÆ°á»£ng quáº£n lÃ½ tráº¡ng thÃ¡i vÃ  cache cá»§a `React Query`. Instance nÃ y sáº½ Ä‘Æ°á»£c sá»­ dá»¥ng bá»Ÿi `QueryClientProvider` Ä‘á»ƒ cung cáº¥p cho cÃ¡c thÃ nh pháº§n con trong á»©ng dá»¥ng.

- Trong hÃ m `App()`, chÃºng ta sá»­ dá»¥ng `QueryClientProvider` Ä‘á»ƒ bao bá»c á»©ng dá»¥ng vÃ  cung cáº¥p `queryClient` cho cÃ¡c thÃ nh pháº§n con. Äiá»u nÃ y cho phÃ©p cÃ¡c thÃ nh pháº§n con sá»­ dá»¥ng `React Query` Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c truy váº¥n dá»¯ liá»‡u vÃ  quáº£n lÃ½ cache.

- ChÃºng ta sá»­ dá»¥ng `Router` Ä‘á»ƒ bao bá»c cÃ¡c thÃ nh pháº§n cá»§a á»©ng dá»¥ng vÃ  Ä‘á»‹nh tuyáº¿n giá»¯a cÃ¡c trang. `Switch` lÃ  má»™t thÃ nh pháº§n cá»§a `React Router` dÃ¹ng Ä‘á»ƒ chá»n ra chá»‰ má»™t `Route` phÃ¹ há»£p vá»›i URL hiá»‡n táº¡i.

- ChÃºng ta Ä‘á»‹nh nghÄ©a cÃ¡c `Route` Ä‘á»ƒ xÃ¡c Ä‘á»‹nh cÃ¡c URL vÃ  thÃ nh pháº§n tÆ°Æ¡ng á»©ng Ä‘á»ƒ hiá»ƒn thá»‹. Trong vÃ­ dá»¥ nÃ y, chÃºng ta cÃ³ ba `Route`:

  - `exact path='/'` cho trang chá»§ (component `Home`).
  - `exact path='/posts'` cho danh sÃ¡ch bÃ i viáº¿t (component `PostList`).
  - `path='/posts/:id'` cho chi tiáº¿t bÃ i viáº¿t (component `PostDetails`), trong Ä‘Ã³ `:id` lÃ  má»™t tham sá»‘ Ä‘á»™ng Ä‘á»ƒ xÃ¡c Ä‘á»‹nh ID cá»§a bÃ i viáº¿t.

- Cuá»‘i cÃ¹ng, chÃºng ta xuáº¥t `App` Ä‘á»ƒ sá»­ dá»¥ng trong á»©ng dá»¥ng chÃ­nh.

- Vá»›i cáº¥u hÃ¬nh nÃ y, `React Router` sáº½ xÃ¡c Ä‘á»‹nh cÃ¡c URL vÃ  hiá»ƒn thá»‹ cÃ¡c thÃ nh pháº§n tÆ°Æ¡ng á»©ng trong á»©ng dá»¥ng. `React Query` sáº½ cung cáº¥p kháº£ nÄƒng thá»±c hiá»‡n truy váº¥n dá»¯ liá»‡u vÃ  quáº£n lÃ½ cache cho cÃ¡c thÃ nh pháº§n con.

3. Trong cÃ¡c components cá»§a báº¡n, sá»­ dá»¥ng cÃ¡c hooks cá»§a `React Query` Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c truy váº¥n dá»¯ liá»‡u vÃ  quáº£n lÃ½ state cá»§a chÃºng, vÃ­ dá»¥:

```jsx
import { useQuery } from 'react-query'
import { useParams } from 'react-router-dom'

const fetchPost = async (postId) => {
  const response = await fetch(`api/posts/${postId}`)
  const data = await response.json()
  return data
}

function PostDetails() {
  const { id } = useParams()

  const { data, isLoading, isError, error } = useQuery(['post', id], () => fetchPost(id))

  if (isLoading) {
    return <div>Loading...</div>
  }

  if (isError) {
    return <div>Error: {error.message}</div>
  }

  return (
    <div>
      <h1>Post Details</h1>
      <p>ID: {data.id}</p>
      <p>Title: {data.title}</p>
      <p>Content: {data.content}</p>
    </div>
  )
}

export default PostDetails
```

- Äoáº¡n mÃ£ trÃªn mÃ´ táº£ má»™t trang chi tiáº¿t bÃ i viáº¿t trong á»©ng dá»¥ng sá»­ dá»¥ng `React Query` vÃ  `React Router`.

  - `import { useQuery } from 'react-query'` vÃ  `import { useParams } from 'react-router-dom'`: ÄÃ¢y lÃ  cÃ¡ch import `useQuery` tá»« `React Query` Ä‘á»ƒ thá»±c hiá»‡n truy váº¥n dá»¯ liá»‡u vÃ  `useParams` tá»« `React Router` Ä‘á»ƒ truy cáº­p vÃ o cÃ¡c tham sá»‘ Ä‘á»™ng trong URL.

  - `const fetchPost = async (postId) => { ... }`: ÄÃ¢y lÃ  hÃ m `fetchPost` Ä‘á»ƒ láº¥y dá»¯ liá»‡u cá»§a má»™t bÃ i viáº¿t tá»« API. NÃ³ sá»­ dá»¥ng `postId` lÃ m tham sá»‘ Ä‘á»ƒ xÃ¡c Ä‘á»‹nh bÃ i viáº¿t cáº§n láº¥y. HÃ m nÃ y sá»­ dá»¥ng `fetch` Ä‘á»ƒ gá»­i yÃªu cáº§u GET Ä‘áº¿n API vÃ  tráº£ vá» dá»¯ liá»‡u bÃ i viáº¿t dÆ°á»›i dáº¡ng JSON. DÃ²ng nÃ y sá»­ dá»¥ng phÆ°Æ¡ng thá»©c `json()` cá»§a Ä‘á»‘i tÆ°á»£ng `response` Ä‘á»ƒ chuyá»ƒn Ä‘á»•i dá»¯ liá»‡u tráº£ vá» thÃ nh Ä‘á»‘i tÆ°á»£ng (object) JavaScript. HÃ m nÃ y tráº£ vá» má»™t Promise, vÃ¬ váº­y chÃºng ta sá»­ dá»¥ng tá»« khÃ³a await Ä‘á»ƒ Ä‘á»£i viá»‡c chuyá»ƒn Ä‘á»•i dá»¯ liá»‡u thÃ nh cÃ´ng.

  - Trong component `PostDetails`, chÃºng ta sá»­ dá»¥ng `useParams` Ä‘á»ƒ láº¥y tham sá»‘ `id` tá»« URL. Tham sá»‘ nÃ y xÃ¡c Ä‘á»‹nh ID cá»§a bÃ i viáº¿t Ä‘Æ°á»£c yÃªu cáº§u.

  - ChÃºng ta sá»­ dá»¥ng `useQuery` Ä‘á»ƒ thá»±c hiá»‡n truy váº¥n dá»¯ liá»‡u cá»§a bÃ i viáº¿t. ChÃºng ta truyá»n vÃ o má»™t máº£ng `['post', id]` lÃ m `queryKey`, trong Ä‘Ã³ `'post'` lÃ  má»™t nhÃ£n Ä‘á»‹nh danh cho truy váº¥n vÃ  `id` lÃ  ID cá»§a bÃ i viáº¿t Ä‘á»ƒ xÃ¡c Ä‘á»‹nh truy váº¥n duy nháº¥t. Äá»‘i sá»‘ thá»© hai cá»§a `useQuery` lÃ  má»™t hÃ m callback chá»©a logic Ä‘á»ƒ láº¥y dá»¯ liá»‡u bÃ i viáº¿t tá»« API báº±ng cÃ¡ch sá»­ dá»¥ng hÃ m `fetchPost` vÃ  truyá»n `id` lÃ m tham sá»‘.

  - `useQuery` sáº½ quáº£n lÃ½ tráº¡ng thÃ¡i truy váº¥n vÃ  cache dá»¯ liá»‡u. ChÃºng ta sá»­ dá»¥ng cÃ¡c biáº¿n `data`, `isLoading`, `isError` vÃ  `error` Ä‘Æ°á»£c tráº£ vá» tá»« `useQuery` Ä‘á»ƒ xá»­ lÃ½ tráº¡ng thÃ¡i cá»§a truy váº¥n. CÃ¡c biáº¿n Ä‘Ã³ cÃ³ sáºµn trong `useQuery`.

  - Trong pháº§n render, chÃºng ta kiá»ƒm tra tráº¡ng thÃ¡i `isLoading` vÃ  `isError` Ä‘á»ƒ hiá»ƒn thá»‹ thÃ´ng bÃ¡o tÆ°Æ¡ng á»©ng. Náº¿u Ä‘ang táº£i dá»¯ liá»‡u, chÃºng ta hiá»ƒn thá»‹ thÃ´ng bÃ¡o "Loading...". Náº¿u cÃ³ lá»—i, chÃºng ta hiá»ƒn thá»‹ thÃ´ng bÃ¡o lá»—i vÃ  hiá»ƒn thá»‹ `error.message`, `error` lÃ  thÃ´ng tin lá»—i nÃ³ Ä‘Æ°á»£c tráº£ vá» tá»« hook `useQuery`, nÃ³ cÃ³ sáºµn trong `isError`.

  - Náº¿u tráº¡ng thÃ¡i truy váº¥n lÃ  thÃ nh cÃ´ng (`isLoading` vÃ  `isError` Ä‘á»u lÃ  `false`), chÃºng ta hiá»ƒn thá»‹ chi tiáº¿t bÃ i viáº¿t báº±ng cÃ¡ch truy cáº­p vÃ o `data`. ChÃºng ta sá»­ dá»¥ng cÃ¡c trÆ°á»ng `id`, `title` vÃ  `content` Ä‘á»ƒ hiá»ƒn thá»‹ thÃ´ng tin bÃ i viáº¿t.

- Component `PostDetails` sáº½ Ä‘Æ°á»£c sá»­ dá»¥ng trong cÃ¡c `Route` Ä‘á»ƒ hiá»ƒn thá»‹ trang chi tiáº¿t bÃ i viáº¿t dá»±a trÃªn `ID` Ä‘Æ°á»£c truyá»n qua URL.

âœ…âœ… Tá»•ng láº¡i: TrÃªn Ä‘Ã¢y lÃ  má»™t vÃ­ dá»¥ cÆ¡ báº£n vá» viá»‡c sá»­ dá»¥ng `React Router` káº¿t há»£p vá»›i `React Query` trong á»©ng dá»¥ng cá»§a báº¡n. Báº±ng cÃ¡ch sá»­ dá»¥ng cáº£ hai thÆ° viá»‡n nÃ y, báº¡n cÃ³ thá»ƒ quáº£n lÃ½ `routing` vÃ  truy váº¥n dá»¯ liá»‡u má»™t cÃ¡ch hiá»‡u quáº£, mang láº¡i tráº£i nghiá»‡m ngÆ°á»i dÃ¹ng tá»‘t hÆ¡n vÃ  tá»‘i Æ°u hÃ³a viá»‡c táº£i dá»¯ liá»‡u tá»« server.

## âŒâŒ LÆ°u Ã½: Trong queryKey: ['post', id]. CÃ¡i nÃ y cáº§n hiá»ƒu ká»¹, báº¯t buá»™c pháº£i hiá»ƒu: ğŸ‘‡ğŸ‘‡ğŸ‘‡

## âŒâŒ DÆ°á»›i Ä‘Ã¢y lÃ  giáº£i thÃ­ch tá»«ng tham sá»‘ trong queryKey: ğŸ‘‡ğŸ‘‡ğŸ‘‡

## HÃ£y giáº£i thÃ­ch vá» tham sá»‘ Ä‘áº§u tiÃªn ['post'] trong `queryKey` rÃµ rÃ ng hÆ¡n ?

- Tham sá»‘ Ä‘áº§u tiÃªn `['post']` trong `queryKey` Ä‘áº¡i diá»‡n cho loáº¡i truy váº¥n. NÃ³ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ Ä‘á»‹nh danh loáº¡i dá»¯ liá»‡u báº¡n Ä‘ang truy váº¥n.

- Trong trÆ°á»ng há»£p nÃ y, `'post'` lÃ  má»™t chuá»—i Ä‘áº¡i diá»‡n cho loáº¡i dá»¯ liá»‡u `"post"` mÃ  báº¡n muá»‘n truy váº¥n. Loáº¡i dá»¯ liá»‡u nÃ y cÃ³ thá»ƒ lÃ  báº¥t ká»³ chuá»—i nÃ o mÃ  báº¡n tá»± Ä‘áº·t tÃªn Ä‘á»ƒ phÃ¹ há»£p vá»›i mÃ´ hÃ¬nh dá»¯ liá»‡u cá»§a á»©ng dá»¥ng cá»§a báº¡n. VÃ­ dá»¥: `'user'`, `'comment'`, `'product'`, vv.

- VÃ­ dá»¥: Náº¿u á»©ng dá»¥ng cá»§a báº¡n lÃ  má»™t blog vÃ  báº¡n muá»‘n truy váº¥n cÃ¡c bÃ i Ä‘Äƒng, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng `['post']` lÃ m `queryKey` Ä‘á»ƒ xÃ¡c Ä‘á»‹nh loáº¡i truy váº¥n lÃ  `"post"`.

- Má»¥c Ä‘Ã­ch cá»§a viá»‡c sá»­ dá»¥ng loáº¡i truy váº¥n trong `queryKey` lÃ  Ä‘á»ƒ xÃ¡c Ä‘á»‹nh vÃ  phÃ¢n loáº¡i cÃ¡c truy váº¥n dá»±a trÃªn loáº¡i dá»¯ liá»‡u. Khi báº¡n cÃ³ nhiá»u loáº¡i dá»¯ liá»‡u khÃ¡c nhau trong á»©ng dá»¥ng cá»§a mÃ¬nh, viá»‡c Ä‘á»‹nh danh má»—i loáº¡i dá»¯ liá»‡u thÃ´ng qua `queryKey` giÃºp React Query quáº£n lÃ½ vÃ  xá»­ lÃ½ cÃ¡c truy váº¥n má»™t cÃ¡ch chÃ­nh xÃ¡c.

## Tham sá»‘ thá»© 2 trong `queryKey` lÃ  `id`. NÃ³ cÃ³ nghÄ©a lÃ  sao. TÃ´i chÆ°a hiá»ƒu láº¯m ?

- Tham sá»‘ thá»© hai trong `queryKey`, trong trÆ°á»ng há»£p cá»§a báº¡n lÃ  `id`, Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ xÃ¡c Ä‘á»‹nh má»™t giÃ¡ trá»‹ Ä‘áº·c biá»‡t (vÃ­ dá»¥: ID cá»§a bÃ i viáº¿t) Ä‘á»ƒ truy váº¥n dá»¯ liá»‡u cá»¥ thá»ƒ tá»« server.

- Khi báº¡n truy váº¥n dá»¯ liá»‡u tá»« má»™t nguá»“n dá»¯ liá»‡u nhÆ° má»™t API, thÃ´ng thÆ°á»ng báº¡n cáº§n chá»‰ Ä‘á»‹nh má»™t giÃ¡ trá»‹ duy nháº¥t Ä‘á»ƒ xÃ¡c Ä‘á»‹nh dá»¯ liá»‡u cáº§n láº¥y. Trong trÆ°á»ng há»£p cá»§a báº¡n lÃ  `queryKey: ['post', id]`, `id` Ä‘áº¡i diá»‡n cho giÃ¡ trá»‹ Ä‘áº·c biá»‡t (vÃ­ dá»¥: ID cá»§a bÃ i viáº¿t) mÃ  báº¡n muá»‘n truy váº¥n.

- Vá»›i má»—i giÃ¡ trá»‹ `id` khÃ¡c nhau, báº¡n cÃ³ thá»ƒ truy váº¥n dá»¯ liá»‡u cá»§a cÃ¡c bÃ i viáº¿t khÃ¡c nhau tá»« server. Khi `id` thay Ä‘á»•i, React Query sáº½ tá»± Ä‘á»™ng gá»­i yÃªu cáº§u má»›i Ä‘á»ƒ láº¥y dá»¯ liá»‡u tÆ°Æ¡ng á»©ng tá»« server.

- VÃ­ dá»¥: Náº¿u báº¡n muá»‘n truy váº¥n dá»¯ liá»‡u bÃ i viáº¿t cÃ³ ID lÃ  1, báº¡n sáº½ sá»­ dá»¥ng `queryKey: ['post', 1]`. Äiá»u nÃ y cho biáº¿t báº¡n muá»‘n truy váº¥n dá»¯ liá»‡u bÃ i viáº¿t vá»›i `ID` lÃ  `1` tá»« server.

- TÃ³m láº¡i, viá»‡c sá»­ dá»¥ng `id` lÃ  má»™t cÃ¡ch Ä‘á»ƒ xÃ¡c Ä‘á»‹nh má»™t giÃ¡ trá»‹ Ä‘áº·c biá»‡t vÃ  chá»‰ Ä‘á»‹nh dá»¯ liá»‡u cá»¥ thá»ƒ báº¡n muá»‘n truy váº¥n tá»« server.

## Khi tÃ´i khai bÃ¡o nhÆ° váº­y `queryKey: ['post', id]` thÃ¬ tÃ´i sáº½ láº¥y táº¥t cáº£ cÃ¡c bÃ i viáº¿t trong `server` lun háº£ ?

- KhÃ´ng, khi báº¡n khai bÃ¡o `queryKey: ['post', id]`, nghÄ©a lÃ  báº¡n chá»‰ Ä‘á»‹nh má»™t `queryKey` cá»¥ thá»ƒ Ä‘á»ƒ truy váº¥n dá»¯ liá»‡u cá»§a má»™t bÃ i viáº¿t duy nháº¥t tá»« server. `QueryKey` nÃ y gá»“m hai pháº§n tá»­: `'post'` vÃ  `id`.

- Vá»›i cÃ¡ch truy váº¥n nhÆ° váº­y, React Query sáº½ tá»± Ä‘á»™ng thÃªm `queryKey` vÃ o bá»™ nhá»› cache Ä‘á»ƒ lÆ°u trá»¯ káº¿t quáº£ truy váº¥n cá»§a bÃ i viáº¿t Ä‘Ã³. Khi báº¡n thá»±c hiá»‡n truy váº¥n vá»›i `queryKey` tÆ°Æ¡ng tá»± trong tÆ°Æ¡ng lai, React Query sáº½ trÆ°á»›c tiÃªn kiá»ƒm tra xem liá»‡u dá»¯ liá»‡u Ä‘Ã£ tá»“n táº¡i trong cache hay chÆ°a.

- Náº¿u dá»¯ liá»‡u Ä‘Ã£ tá»“n táº¡i trong cache vÃ  chÆ°a háº¿t háº¡n (thá»i gian háº¿t háº¡n Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh bá»Ÿi `staleTime`), React Query sáº½ tráº£ vá» dá»¯ liá»‡u tá»« cache mÃ  khÃ´ng gá»­i yÃªu cáº§u má»›i Ä‘áº¿n server. Äiá»u nÃ y giÃºp cáº£i thiá»‡n hiá»‡u suáº¥t á»©ng dá»¥ng.

- Náº¿u dá»¯ liá»‡u trong cache Ä‘Ã£ háº¿t háº¡n hoáº·c chÆ°a tá»“n táº¡i trong cache, React Query sáº½ tá»± Ä‘á»™ng gá»­i yÃªu cáº§u má»›i Ä‘áº¿n server Ä‘á»ƒ láº¥y dá»¯ liá»‡u cá»§a bÃ i viáº¿t tÆ°Æ¡ng á»©ng. Sau khi nháº­n Ä‘Æ°á»£c káº¿t quáº£ tá»« server, nÃ³ sáº½ cáº­p nháº­t cache vÃ  tráº£ vá» káº¿t quáº£ cho báº¡n sá»­ dá»¥ng.

- VÃ¬ váº­y, vá»›i `queryKey: ['post', id]`, báº¡n chá»‰ truy váº¥n dá»¯ liá»‡u cá»§a má»™t bÃ i viáº¿t duy nháº¥t cÃ³ `ID` tÆ°Æ¡ng á»©ng tá»« server, khÃ´ng pháº£i táº¥t cáº£ cÃ¡c bÃ i viáº¿t.

## CÃ³ nghÄ©a lÃ  cÃ¡c bÃ i viáº¿t cá»§a tÃ´i Ä‘Ã£ `render` lÃªn mÃ n hÃ¬nh háº¿t rá»“i. VÃ  khi tÃ´i khai bÃ¡o nhÆ° váº­y thÃ¬ cÃ³ nghÄ©a lÃ  tÃ´i `click` vÃ o 1 bÃ i viáº¿t báº¥t kÃ¬ trÃªn mÃ n hÃ¬nh, lÃ  `id` cá»§a bÃ i viáº¿t Ä‘Ã³ Ä‘Æ°á»£c lÆ°u trong `cache`. `queryKey: ['post', id]`, Váº­y dÃ²ng nÃ y cÃ³ `id` lÃ  `id` cá»§a má»—i bÃ i viáº¿t mÃ  tÃ´i `click` vÃ o Ä‘Ã³ háº£ ?

- ÄÃºng, khi báº¡n khai bÃ¡o `queryKey: ['post', id]`, trong Ä‘Ã³ `id` lÃ  `id` cá»§a bÃ i viáº¿t mÃ  báº¡n Ä‘ang xem hoáº·c `click` vÃ o. Äiá»u nÃ y cho phÃ©p React Query xÃ¡c Ä‘á»‹nh vÃ  lÆ°u trá»¯ káº¿t quáº£ truy váº¥n cho tá»«ng bÃ i viáº¿t cá»¥ thá»ƒ trong cache.

- Khi báº¡n `click` vÃ o má»™t bÃ i viáº¿t trÃªn mÃ n hÃ¬nh, báº¡n cÃ³ thá»ƒ truyá»n `id` cá»§a bÃ i viáº¿t Ä‘Ã³ vÃ o `queryKey` Ä‘á»ƒ thá»±c hiá»‡n truy váº¥n dá»¯ liá»‡u cá»§a bÃ i viáº¿t tá»« server. React Query sáº½ sá»­ dá»¥ng `queryKey` nÃ y Ä‘á»ƒ xÃ¡c Ä‘á»‹nh káº¿t quáº£ truy váº¥n tÆ°Æ¡ng á»©ng trong cache.

- VÃ­ dá»¥, náº¿u báº¡n `click` vÃ o bÃ i viáº¿t cÃ³ `id` lÃ  `1`, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng `queryKey: ['post', 1]` Ä‘á»ƒ truy váº¥n dá»¯ liá»‡u cá»§a bÃ i viáº¿t Ä‘Ã³. Khi Ä‘Ã³, React Query sáº½ kiá»ƒm tra cache vÃ  tráº£ vá» káº¿t quáº£ truy váº¥n cá»§a bÃ i viáº¿t cÃ³ `id` lÃ  `1` náº¿u nÃ³ Ä‘Ã£ tá»“n táº¡i trong cache vÃ  chÆ°a háº¿t háº¡n. Náº¿u chÆ°a tá»“n táº¡i hoáº·c Ä‘Ã£ háº¿t háº¡n, React Query sáº½ gá»­i yÃªu cáº§u má»›i Ä‘áº¿n server Ä‘á»ƒ láº¥y dá»¯ liá»‡u cá»§a bÃ i viáº¿t vÃ  cáº­p nháº­t cache.

- Viá»‡c sá»­ dá»¥ng `queryKey` vá»›i `id` cá»§a bÃ i viáº¿t giÃºp React Query quáº£n lÃ½ vÃ  láº¥y dá»¯ liá»‡u tÆ°Æ¡ng á»©ng tá»« cache vÃ  server dá»… dÃ ng cho tá»«ng bÃ i viáº¿t riÃªng biá»‡t.

## Váº­y tÃ³m láº¡i `['post', id]` trong `queryKey`, cÃ³ nghÄ©a lÃ  khi cÃ¡c bÃ i viáº¿t Ä‘Æ°á»£c lÆ°u trong cache thÃ¬ `'post'` Ä‘Ã³ng vai trÃ² nhÆ° `key`, cÃ²n `id` Ä‘Ã³ng vai trÃ² nhÆ° `value` Ä‘Ãºng khÃ´ng ?

- ÄÃºng, báº¡n Ä‘Ã£ hiá»ƒu Ä‘Ãºng. Trong `queryKey: ['post', id]`, `'post'` Ä‘Ã³ng vai trÃ² nhÆ° má»™t pháº§n tá»­ `key` vÃ  `id` Ä‘Ã³ng vai trÃ² nhÆ° má»™t pháº§n tá»­ `value` trong máº£ng `queryKey`.

- CÃ¡c máº£ng `queryKey` Ä‘Æ°á»£c sá»­ dá»¥ng trong React Query nhÆ° má»™t cÃ¡ch Ä‘á»ƒ xÃ¡c Ä‘á»‹nh duy nháº¥t má»™t truy váº¥n dá»¯ liá»‡u. Trong trÆ°á»ng há»£p nÃ y, `'post'` lÃ  pháº§n tá»­ `key` vÃ  Ä‘áº¡i diá»‡n cho loáº¡i dá»¯ liá»‡u bÃ i viáº¿t trong truy váº¥n. `id` lÃ  pháº§n tá»­ `value` vÃ  Ä‘áº¡i diá»‡n cho giÃ¡ trá»‹ cá»¥ thá»ƒ cá»§a `id` cá»§a bÃ i viáº¿t mÃ  báº¡n muá»‘n truy váº¥n.

- Khi sá»­ dá»¥ng `queryKey: ['post', id]`, React Query sáº½ sá»­ dá»¥ng cáº£ `key` vÃ  `value` Ä‘á»ƒ xÃ¡c Ä‘á»‹nh truy váº¥n cá»¥ thá»ƒ vÃ  quáº£n lÃ½ káº¿t quáº£ truy váº¥n cho tá»«ng bÃ i viáº¿t dá»±a trÃªn `id` tÆ°Æ¡ng á»©ng.

## HÃ£y nÃªu khÃ¡i niá»‡m useMutation trong react query ?

- Trong React Query, `useMutation` lÃ  má»™t hook dÃ¹ng Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c yÃªu cáº§u thay Ä‘á»•i dá»¯ liá»‡u, cháº³ng háº¡n nhÆ° táº¡o, cáº­p nháº­t hoáº·c xÃ³a (POST, PUT, DELETE) dá»¯ liá»‡u trÃªn server (ngoáº¡i trá»« GET). NÃ³ cung cáº¥p má»™t cÃ¡ch tiá»‡n lá»£i Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c thao tÃ¡c thay Ä‘á»•i dá»¯ liá»‡u vÃ  quáº£n lÃ½ tráº¡ng thÃ¡i cá»§a chÃºng.

- Khi sá»­ dá»¥ng `useMutation`, báº¡n cáº§n cung cáº¥p má»™t hÃ m gá»i lÃ  `mutationFn`, Ä‘áº¡i diá»‡n cho yÃªu cáº§u thay Ä‘á»•i dá»¯ liá»‡u (vÃ­ dá»¥: gá»­i má»™t POST request Ä‘á»ƒ táº¡o má»›i má»™t bÃ i viáº¿t). Khi gá»i hÃ m `mutationFn`, React Query sáº½ quáº£n lÃ½ quÃ¡ trÃ¬nh gá»­i yÃªu cáº§u, xá»­ lÃ½ káº¿t quáº£ vÃ  cung cáº¥p cÃ¡c tráº¡ng thÃ¡i vÃ  phÆ°Æ¡ng thá»©c há»¯u Ã­ch Ä‘á»ƒ tÆ°Æ¡ng tÃ¡c vá»›i yÃªu cáº§u Ä‘Ã³.

- CÃ¡c tráº¡ng thÃ¡i chÃ­nh khi sá»­ dá»¥ng `useMutation` bao gá»“m:

- `isLoading:` ÄÃ¡nh dáº¥u xem yÃªu cáº§u Ä‘ang Ä‘Æ°á»£c thá»±c hiá»‡n hay khÃ´ng.
- `isError:` ÄÃ¡nh dáº¥u xem yÃªu cáº§u cÃ³ lá»—i xáº£y ra hay khÃ´ng.
- `error:` ThÃ´ng tin chi tiáº¿t vá» lá»—i (náº¿u cÃ³).
- `data:` Dá»¯ liá»‡u tráº£ vá» tá»« yÃªu cáº§u thÃ nh cÃ´ng (náº¿u cÃ³).
- `mutate:` PhÆ°Æ¡ng thá»©c Ä‘á»ƒ gá»i yÃªu cáº§u thay Ä‘á»•i dá»¯ liá»‡u.
- `reset:` PhÆ°Æ¡ng thá»©c Ä‘á»ƒ Ä‘áº·t láº¡i tráº¡ng thÃ¡i yÃªu cáº§u.

- `useMutation` cÅ©ng cung cáº¥p cÃ¡c callback nhÆ° `onSuccess` vÃ  `onError`, cho phÃ©p báº¡n thá»±c hiá»‡n cÃ¡c hÃ nh Ä‘á»™ng tuá»³ chá»‰nh sau khi yÃªu cáº§u thÃ nh cÃ´ng hoáº·c gáº·p lá»—i.

## VÃ­ dá»¥ cÆ¡ báº£n vá» useMutation trong react query ?

- DÆ°á»›i Ä‘Ã¢y lÃ  má»™t vÃ­ dá»¥ cÆ¡ báº£n vá» cÃ¡ch sá»­ dá»¥ng `useMutation` trong React Query Ä‘á»ƒ thá»±c hiá»‡n má»™t yÃªu cáº§u `POST` Ä‘á»ƒ táº¡o má»›i má»™t bÃ i viáº¿t:

```jsx
import { useMutation } from 'react-query'

const createPost = async (newPost) => {
  const response = await fetch('api/posts', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify(newPost)
  })

  if (!response.ok) {
    throw new Error('Failed to create post')
  }

  const data = await response.json()
  return data
}

function CreatePostForm() {
  const mutation = useMutation(createPost)

  const handleSubmit = (event) => {
    event.preventDefault()
    const formData = new FormData(event.target)
    const newPost = Object.fromEntries(formData.entries())
    mutation.mutate(newPost)
  }

  return (
    <form onSubmit={handleSubmit}>
      <input type='text' name='title' placeholder='Title' />
      <textarea name='content' placeholder='Content' />
      <button type='submit' disabled={mutation.isLoading}>
        {mutation.isLoading ? 'Creating...' : 'Create'}
      </button>
      {mutation.isError && <div>Error: {mutation.error.message}</div>}
      {mutation.isSuccess && <div>Post created successfully!</div>}
    </form>
  )
}
```

- Trong vÃ­ dá»¥ nÃ y, chÃºng ta sá»­ dá»¥ng `useMutation` Ä‘á»ƒ táº¡o má»™t yÃªu cáº§u `POST` má»›i báº±ng cÃ¡ch cung cáº¥p hÃ m `createPost` lÃ m Ä‘á»‘i sá»‘ cho `useMutation`. Sau Ä‘Ã³, chÃºng ta sá»­ dá»¥ng `mutation.mutate` Ä‘á»ƒ gá»i yÃªu cáº§u thay Ä‘á»•i dá»¯ liá»‡u vá»›i dá»¯ liá»‡u má»›i tá»« `form`.

- `mutation.isLoading` Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ kiá»ƒm tra xem yÃªu cáº§u Ä‘ang Ä‘Æ°á»£c thá»±c hiá»‡n hay khÃ´ng Ä‘á»ƒ Ä‘iá»u chá»‰nh tráº¡ng thÃ¡i cá»§a nÃºt `"Create"`.
- `mutation.isError` vÃ  `mutation.error.message` Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ hiá»ƒn thá»‹ thÃ´ng bÃ¡o lá»—i náº¿u cÃ³ lá»—i xáº£y ra.
- `mutation.isSuccess` Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ hiá»ƒn thá»‹ thÃ´ng bÃ¡o thÃ nh cÃ´ng sau khi yÃªu cáº§u Ä‘Æ°á»£c thá»±c hiá»‡n thÃ nh cÃ´ng.

- ÄÃ¢y chá»‰ lÃ  má»™t vÃ­ dá»¥ cÆ¡ báº£n vá» cÃ¡ch sá»­ dá»¥ng `useMutation` vÃ  cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ¹y chá»‰nh vÃ  má»Ÿ rá»™ng theo nhu cáº§u cá»§a á»©ng dá»¥ng.

## Giáº£i thÃ­ch Ä‘oáº¡n code trÃªn:

- Trong Ä‘oáº¡n code trÃªn, chÃºng ta sá»­ dá»¥ng `useMutation` tá»« React Query Ä‘á»ƒ thá»±c hiá»‡n má»™t yÃªu cáº§u `POST` Ä‘á»ƒ táº¡o má»›i má»™t bÃ i viáº¿t.

- HÃ m `createPost` lÃ  má»™t hÃ m báº¥t Ä‘á»“ng bá»™ (`async`) Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ gá»­i yÃªu cáº§u `POST` tá»›i API vÃ  tráº£ vá» dá»¯ liá»‡u sau khi yÃªu cáº§u thÃ nh cÃ´ng. Náº¿u yÃªu cáº§u gáº·p lá»—i, chÃºng ta sáº½ `throw` má»™t lá»—i Ä‘á»ƒ xá»­ lÃ½ sau nÃ y.

- Trong component `CreatePostForm`, chÃºng ta sá»­ dá»¥ng `useMutation(createPost)` Ä‘á»ƒ khá»Ÿi táº¡o má»™t mutation instance. Mutation instance nÃ y cung cáº¥p cÃ¡c thuá»™c tÃ­nh vÃ  phÆ°Æ¡ng thá»©c Ä‘á»ƒ theo dÃµi tráº¡ng thÃ¡i cá»§a `mutation`.

- Trong hÃ m `handleSubmit`, chÃºng ta sá»­ dá»¥ng `mutation.mutate(newPost)` Ä‘á»ƒ gá»i yÃªu cáº§u táº¡o má»›i bÃ i viáº¿t. `newPost` lÃ  Ä‘á»‘i tÆ°á»£ng chá»©a thÃ´ng tin bÃ i viáº¿t tá»« `form`.

- Trong form, chÃºng ta sá»­ dá»¥ng `onSubmit` Ä‘á»ƒ gá»i hÃ m `handleSubmit` khi form Ä‘Æ°á»£c submit. Tráº¡ng thÃ¡i `mutation.isLoading` Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ Ä‘iá»u khiá»ƒn tráº¡ng thÃ¡i cá»§a nÃºt `"Create"` vÃ  tráº¡ng thÃ¡i nÃ y Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ hiá»ƒn thá»‹ thÃ´ng bÃ¡o tÆ°Æ¡ng á»©ng (`"Creating..."` hoáº·c `"Create"`).

- `mutation.isError` Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ kiá»ƒm tra xem yÃªu cáº§u cÃ³ gáº·p lá»—i hay khÃ´ng. Náº¿u cÃ³ lá»—i, chÃºng ta hiá»ƒn thá»‹ thÃ´ng bÃ¡o lá»—i trong `div` cÃ³ thÃ´ng bÃ¡o lÃ  Error.

- `mutation.isSuccess` Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ kiá»ƒm tra xem yÃªu cáº§u Ä‘Ã£ thÃ nh cÃ´ng hay khÃ´ng. Náº¿u thÃ nh cÃ´ng, chÃºng ta hiá»ƒn thá»‹ thÃ´ng bÃ¡o thÃ nh cÃ´ng trong `div` cÃ³ thÃ´ng bÃ¡o lÃ  Post created successfully!.

- Äoáº¡n code trÃªn chá»‰ lÃ  má»™t vÃ­ dá»¥ cÆ¡ báº£n Ä‘á»ƒ giáº£i thÃ­ch cÃ¡ch sá»­ dá»¥ng `useMutation` trong React Query. Báº¡n cÃ³ thá»ƒ tÃ¹y chá»‰nh vÃ  má»Ÿ rá»™ng nÃ³ theo nhu cáº§u cá»§a á»©ng dá»¥ng.

## VÃ­ dá»¥ nÃ¢ng cao vá» useMutation trong react query ?

- DÆ°á»›i Ä‘Ã¢y lÃ  má»™t vÃ­ dá»¥ nÃ¢ng cao vá» viá»‡c sá»­ dá»¥ng `useMutation` trong React Query Ä‘á»ƒ táº¡o, cáº­p nháº­t vÃ  xÃ³a dá»¯ liá»‡u:

```jsx
import React from 'react'
import { useMutation, useQueryClient } from 'react-query'

const TodoList = () => {
  const queryClient = useQueryClient()

  // HÃ m gá»i API Ä‘á»ƒ táº¡o má»›i má»™t todo
  const createTodo = async (newTodo) => {
    const response = await fetch('api/todos', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(newTodo)
    })

    if (!response.ok) {
      throw new Error('Failed to create todo')
    }

    const data = await response.json()
    return data
  }

  // HÃ m gá»i API Ä‘á»ƒ cáº­p nháº­t má»™t todo
  const updateTodo = async (updatedTodo) => {
    const response = await fetch(`api/todos/${updatedTodo.id}`, {
      method: 'PUT',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(updatedTodo)
    })

    if (!response.ok) {
      throw new Error('Failed to update todo')
    }

    const data = await response.json()
    return data
  }

  // HÃ m gá»i API Ä‘á»ƒ xÃ³a má»™t todo
  const deleteTodo = async (todoId) => {
    const response = await fetch(`api/todos/${todoId}`, {
      method: 'DELETE'
    })

    if (!response.ok) {
      throw new Error('Failed to delete todo')
    }
  }

  const mutationOptions = {
    onSuccess: () => {
      // Khi thá»±c hiá»‡n thÃ nh cÃ´ng create/update/delete, ta refetch láº¡i dá»¯ liá»‡u Ä‘á»ƒ cáº­p nháº­t UI
      queryClient.invalidateQueries('todos')
    }
  }

  const createMutation = useMutation(createTodo, mutationOptions)
  const updateMutation = useMutation(updateTodo, mutationOptions)
  const deleteMutation = useMutation(deleteTodo, mutationOptions)

  const handleCreateTodo = () => {
    const newTodo = { title: 'New Todo', completed: false }
    createMutation.mutate(newTodo)
  }

  const handleUpdateTodo = (todo) => {
    const updatedTodo = { ...todo, completed: !todo.completed }
    updateMutation.mutate(updatedTodo)
  }

  const handleDeleteTodo = (todoId) => {
    deleteMutation.mutate(todoId)
  }

  return (
    <div>
      <button onClick={handleCreateTodo}>Create Todo</button>
      <ul>
        {todos.map((todo) => (
          <li key={todo.id}>
            {todo.title} - {todo.completed ? 'Completed' : 'Not Completed'}
            <button onClick={() => handleUpdateTodo(todo)}>Toggle Complete</button>
            <button onClick={() => handleDeleteTodo(todo.id)}>Delete</button>
          </li>
        ))}
      </ul>
    </div>
  )
}

export default TodoList
```

- Trong vÃ­ dá»¥ trÃªn, chÃºng ta sá»­ dá»¥ng `useMutation` Ä‘á»ƒ táº¡o ra ba biáº¿n mutation: `createMutation`, `updateMutation`, vÃ  `deleteMutation`. Má»—i biáº¿n mutation Ä‘Æ°á»£c khá»Ÿi táº¡o vá»›i hÃ m tÆ°Æ¡ng á»©ng Ä‘á»ƒ gá»i API tÆ°Æ¡ng á»©ng (táº¡o má»›i, cáº­p nháº­t, xÃ³a).

- `mutationOptions` Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ Ä‘á»‹nh cáº¥u hÃ¬nh cÃ¡c hÃ nh vi sau khi mutation Ä‘Æ°á»£c thá»±c hiá»‡n thÃ nh cÃ´ng. Trong vÃ­ dá»¥ nÃ y, chÃºng ta sá»­ dá»¥ng `onSuccess` Ä‘á»ƒ khi mutation hoÃ n thÃ nh thÃ nh cÃ´ng, ta sáº½ lÃ m tÆ°Æ¡i láº¡i dá»¯ liá»‡u báº±ng cÃ¡ch gá»i `queryClient.invalidateQueries('todos')`. Äiá»u nÃ y giÃºp cáº­p nháº­t UI vá»›i dá»¯ liá»‡u má»›i nháº¥t.

- Khi ngÆ°á»i dÃ¹ng thá»±c hiá»‡n cÃ¡c hÃ nh Ä‘á»™ng nhÆ° táº¡o má»›i, cáº­p nháº­t hoáº·c xÃ³a má»™t todo, ta gá»i phÆ°Æ¡ng thá»©c `mutate` trÃªn cÃ¡c biáº¿n mutation tÆ°Æ¡ng á»©ng vÃ  chuyá»ƒn tham sá»‘ tÆ°Æ¡ng á»©ng (newTodo, updatedTodo, todoId).

- Khi mutation Ä‘ang xá»­ lÃ½, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡c thuá»™c tÃ­nh nhÆ° `isLoading`, `isError`, vÃ  `error` Ä‘á»ƒ hiá»ƒn thá»‹ tráº¡ng thÃ¡i vÃ  thÃ´ng bÃ¡o lá»—i tÆ°Æ¡ng á»©ng.

- VÃ­ dá»¥ trÃªn chá»‰ lÃ  má»™t vÃ­ dá»¥ nÃ¢ng cao vá» viá»‡c sá»­ dá»¥ng `useMutation` trong React Query. Báº¡n cÃ³ thá»ƒ tÃ¹y chá»‰nh nhiá»u hÆ¡n vÃ  Ã¡p dá»¥ng cho cÃ¡c trÆ°á»ng há»£p sá»­ dá»¥ng thá»±c táº¿ khÃ¡c nhau.

## Giáº£i thÃ­ch Ä‘oáº¡n code trÃªn:

```jsx
import React from 'react'
import { useMutation, useQueryClient } from 'react-query'
```

- Äoáº¡n mÃ£ trÃªn bao gá»“m hai import:

1. `React`: ÄÃ¢y lÃ  import cáº§n thiáº¿t Ä‘á»ƒ sá»­ dá»¥ng React trong á»©ng dá»¥ng cá»§a báº¡n. Má»i thÃ nh pháº§n React Ä‘á»u pháº£i import thÆ° viá»‡n React trÆ°á»›c khi sá»­ dá»¥ng (hiá»‡n táº¡i vá»›i phiÃªn báº£n má»›i thÃ¬ cÃ³ thá»ƒ khÃ´ng cáº§n import dÃ²ng nÃ y).

2. `useMutation`, `useQueryClient` tá»« thÆ° viá»‡n `react-query`: ÄÃ¢y lÃ  hai hook Ä‘Æ°á»£c cung cáº¥p bá»Ÿi React Query Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c hoáº¡t Ä‘á»™ng mutation vÃ  truy váº¥n trong á»©ng dá»¥ng.

- `useMutation`: Hook nÃ y cho phÃ©p báº¡n thá»±c hiá»‡n cÃ¡c hoáº¡t Ä‘á»™ng mutation (thÃªm, sá»­a, xÃ³a) vÃ  theo dÃµi tráº¡ng thÃ¡i cá»§a chÃºng. NÃ³ nháº­n vÃ o má»™t hÃ m mutation vÃ  tráº£ vá» cÃ¡c giÃ¡ trá»‹ vÃ  phÆ°Æ¡ng thá»©c liÃªn quan Ä‘áº¿n mutation.
- `useQueryClient`: Hook nÃ y cung cáº¥p má»™t instance cá»§a QueryClient, Ä‘áº¡i diá»‡n cho client cá»§a React Query. Báº±ng cÃ¡ch sá»­ dá»¥ng `useQueryClient`, báº¡n cÃ³ thá»ƒ truy cáº­p vÃ  thao tÃ¡c vá»›i cÃ¡c hoáº¡t Ä‘á»™ng liÃªn quan Ä‘áº¿n cache, nhÆ° invalidate, refetch, remove cÃ¡c query, mutation vÃ  nhiá»u hÆ¡n ná»¯a.

- Báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng `useMutation` Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c hoáº¡t Ä‘á»™ng mutation, vÃ  `useQueryClient` Ä‘á»ƒ thao tÃ¡c vá»›i cache vÃ  cÃ¡c hoáº¡t Ä‘á»™ng liÃªn quan trong React Query.

```jsx
const TodoList = () => {
  const queryClient = useQueryClient();
  ...
};
```

- Trong Ä‘oáº¡n mÃ£ trÃªn, chÃºng ta sá»­ dá»¥ng hook `useQueryClient` tá»« thÆ° viá»‡n React Query Ä‘á»ƒ táº¡o má»™t instance cá»§a `QueryClient` vÃ  gÃ¡n cho biáº¿n `queryClient`.

- `useQueryClient`: Hook nÃ y tráº£ vá» má»™t instance cá»§a `QueryClient` Ä‘Æ°á»£c sá»­ dá»¥ng trong á»©ng dá»¥ng. `QueryClient` lÃ  má»™t Ä‘á»‘i tÆ°á»£ng quáº£n lÃ½ tráº¡ng thÃ¡i vÃ  cache cho cÃ¡c truy váº¥n vÃ  mutations trong React Query. Báº±ng cÃ¡ch sá»­ dá»¥ng `useQueryClient`, chÃºng ta cÃ³ thá»ƒ truy cáº­p vÃ  thá»±c hiá»‡n cÃ¡c hoáº¡t Ä‘á»™ng liÃªn quan Ä‘áº¿n cache nhÆ° refetch, invalidate, remove queries, mutations vÃ  nhiá»u hÆ¡n ná»¯a.

- Trong Ä‘oáº¡n mÃ£ trÃªn, chÃºng ta sá»­ dá»¥ng `useQueryClient` Ä‘á»ƒ láº¥y má»™t instance cá»§a QueryClient vÃ  gÃ¡n nÃ³ cho biáº¿n `queryClient`. Sau Ä‘Ã³, chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng biáº¿n `queryClient` Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c hoáº¡t Ä‘á»™ng liÃªn quan Ä‘áº¿n cache, nhÆ° lÃ m má»›i láº¡i dá»¯ liá»‡u, xÃ³a dá»¯ liá»‡u, vÃ  cÃ¡c hoáº¡t Ä‘á»™ng khÃ¡c mÃ  cáº§n truy cáº­p vÃ o cache cá»§a React Query.

```jsx
const createTodo = async (newTodo) => {
  const response = await fetch('api/todos', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify(newTodo)
  })

  if (!response.ok) {
    throw new Error('Failed to create todo')
  }

  const data = await response.json()
  return data
}

const updateTodo = async (updatedTodo) => {
  const response = await fetch(`api/todos/${updatedTodo.id}`, {
    method: 'PUT',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify(updatedTodo)
  })

  if (!response.ok) {
    throw new Error('Failed to update todo')
  }

  const data = await response.json()
  return data
}

const deleteTodo = async (todoId) => {
  const response = await fetch(`api/todos/${todoId}`, {
    method: 'DELETE'
  })

  if (!response.ok) {
    throw new Error('Failed to delete todo')
  }
}
```

- Trong Ä‘oáº¡n mÃ£ trÃªn, chÃºng ta Ä‘á»‹nh nghÄ©a ba hÃ m `createTodo`, `updateTodo`, vÃ  `deleteTodo` Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c hoáº¡t Ä‘á»™ng tÆ°Æ¡ng á»©ng vá»›i viá»‡c táº¡o, cáº­p nháº­t vÃ  xÃ³a má»™t todo tá»« API.

1. HÃ m `createTodo`:

- HÃ m nÃ y nháº­n vÃ o má»™t Ä‘á»‘i tÆ°á»£ng `newTodo` chá»©a thÃ´ng tin cá»§a todo má»›i.
- Sá»­ dá»¥ng `fetch` Ä‘á»ƒ gá»­i má»™t request POST tá»›i endpoint `'api/todos'`.
- Trong pháº§n cáº¥u hÃ¬nh request:
  - Äáº·t method lÃ  `'POST'` Ä‘á»ƒ táº¡o má»™t todo má»›i.
  - Äáº·t header lÃ  `'Content-Type': 'application/json'` Ä‘á»ƒ chá»‰ Ä‘á»‹nh kiá»ƒu dá»¯ liá»‡u gá»­i Ä‘i lÃ  JSON.
  - Chuyá»ƒn Ä‘á»•i `newTodo` thÃ nh chuá»—i JSON báº±ng cÃ¡ch sá»­ dá»¥ng `JSON.stringify`.
  - Äáº·t body cá»§a request lÃ  chuá»—i JSON chá»©a thÃ´ng tin cá»§a `newTodo`.
- Sau Ä‘Ã³, chÃºng ta chá» response tá»« server báº±ng cÃ¡ch sá»­ dá»¥ng await.
- Náº¿u response khÃ´ng thÃ nh cÃ´ng (khÃ´ng cÃ³ status code 2xx), ta throw má»™t lá»—i vá»›i thÃ´ng bÃ¡o 'Failed to create todo'.
- Náº¿u response thÃ nh cÃ´ng, ta parse response body tá»« kiá»ƒu dá»¯ liá»‡u chuá»—i sang dá»¯ liá»‡u Ä‘á»‘i tÆ°á»£ng (object) vÃ  tráº£ vá» dá»¯ liá»‡u Ä‘Ã³.

- HÃ m createTodo Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ táº¡o má»™t todo má»›i báº±ng cÃ¡ch gá»­i má»™t request POST tá»›i API vÃ  tráº£ vá» dá»¯ liá»‡u cá»§a todo Ä‘Æ°á»£c táº¡o.

2. HÃ m `updateTodo`:

- Trong Ä‘oáº¡n code trÃªn, chÃºng ta cÃ³ hÃ m `updateTodo` Ä‘á»ƒ cáº­p nháº­t má»™t todo Ä‘Ã£ tá»“n táº¡i báº±ng phÆ°Æ¡ng thá»©c `PUT` trong API. DÆ°á»›i Ä‘Ã¢y lÃ  giáº£i thÃ­ch tá»«ng dÃ²ng code:

- `const updateTodo = async (updatedTodo) => {`: ÄÃ¢y lÃ  khai bÃ¡o cá»§a hÃ m `updateTodo` nháº­n má»™t tham sá»‘ `updatedTodo`, Ä‘áº¡i diá»‡n cho thÃ´ng tin todo cáº§n cáº­p nháº­t.

- `const response = await fetch(api/todos/${updatedTodo.id}, {`: ChÃºng ta sá»­ dá»¥ng `fetch` Ä‘á»ƒ gá»­i má»™t yÃªu cáº§u `PUT` Ä‘áº¿n API vá»›i URL Ä‘Æ°á»£c xÃ¢y dá»±ng tá»« `api/todos/` vÃ  `updatedTodo.id` Ä‘á»ƒ chá»‰ Ä‘á»‹nh todo cáº§n cáº­p nháº­t.

- `method: 'PUT'`: ÄÃ¢y lÃ  pháº§n cá»§a cáº¥u hÃ¬nh yÃªu cáº§u gá»­i Ä‘i, chá»‰ Ä‘á»‹nh ráº±ng chÃºng ta Ä‘ang sá»­ dá»¥ng phÆ°Æ¡ng thá»©c `PUT` Ä‘á»ƒ cáº­p nháº­t todo.

- `headers: { 'Content-Type': 'application/json' }`: ÄÃ¢y lÃ  pháº§n cáº¥u hÃ¬nh cho tiÃªu Ä‘á» cá»§a yÃªu cáº§u gá»­i Ä‘i. Trong trÆ°á»ng há»£p nÃ y, chÃºng ta Ä‘ang chá»‰ Ä‘á»‹nh ráº±ng dá»¯ liá»‡u Ä‘Æ°á»£c gá»­i Ä‘i dÆ°á»›i dáº¡ng JSON.

- `body: JSON.stringify(updatedTodo)`: ÄÃ¢y lÃ  pháº§n cáº¥u hÃ¬nh cho ná»™i dung yÃªu cáº§u gá»­i Ä‘i. ChÃºng ta sá»­ dá»¥ng JSON.stringify Ä‘á»ƒ chuyá»ƒn Ä‘á»•i Ä‘á»‘i tÆ°á»£ng `updatedTodo` thÃ nh chuá»—i JSON trÆ°á»›c khi gá»­i Ä‘i (`.stringify` lÃ  chuyá»ƒn tá»« `object` sang `string`).

- `if (!response.ok) { throw new Error('Failed to update todo') }`: ChÃºng ta kiá»ƒm tra xem pháº£n há»“i tá»« API cÃ³ thÃ nh cÃ´ng hay khÃ´ng báº±ng cÃ¡ch kiá»ƒm tra giÃ¡ trá»‹ `response.ok`. Trong trÆ°á»ng há»£p khÃ´ng thÃ nh cÃ´ng, chÃºng ta nÃ©m má»™t lá»—i Ä‘á»ƒ xá»­ lÃ½ sau nÃ y.

- `const data = await response.json()`: Náº¿u pháº£n há»“i tá»« API thÃ nh cÃ´ng, chÃºng ta sá»­ dá»¥ng `response.json()` Ä‘á»ƒ chuyá»ƒn Ä‘á»•i ná»™i dung pháº£n há»“i tá»« JSON sang Ä‘á»‘i tÆ°á»£ng JavaScript. Káº¿t quáº£ chuyá»ƒn Ä‘á»•i Ä‘Æ°á»£c lÆ°u trá»¯ trong biáº¿n `data`.

- `return data`: Cuá»‘i cÃ¹ng, chÃºng ta tráº£ vá» dá»¯ liá»‡u Ä‘Ã£ cáº­p nháº­t tá»« API thÃ´ng qua biáº¿n `data`.

- TÃ³m láº¡i, hÃ m `updateTodo` thá»±c hiá»‡n gá»­i yÃªu cáº§u `PUT` Ä‘áº¿n API Ä‘á»ƒ cáº­p nháº­t todo Ä‘Ã£ tá»“n táº¡i, vÃ  sau Ä‘Ã³ tráº£ vá» dá»¯ liá»‡u cáº­p nháº­t thÃ nh cÃ´ng Ä‘á»ƒ sá»­ dá»¥ng trong quÃ¡ trÃ¬nh hiá»ƒn thá»‹ hoáº·c xá»­ lÃ½ tiáº¿p theo.

3. HÃ m `deleteTodo`:

- Trong Ä‘oáº¡n code trÃªn, chÃºng ta cÃ³ hÃ m `deleteTodo` Ä‘á»ƒ xÃ³a má»™t todo thÃ´ng qua phÆ°Æ¡ng thá»©c `DELETE` trong API. DÆ°á»›i Ä‘Ã¢y lÃ  giáº£i thÃ­ch tá»«ng dÃ²ng code:

- `const deleteTodo = async (todoId) => {`: ÄÃ¢y lÃ  khai bÃ¡o cá»§a hÃ m báº¥t Ä‘á»“ng bá»™ `deleteTodo` nháº­n má»™t tham sá»‘ `todoId`, Ä‘áº¡i diá»‡n cho ID cá»§a todo cáº§n xÃ³a. Tá»« khÃ³a `async` Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ Ä‘á»‹nh nghÄ©a má»™t hÃ m báº¥t Ä‘á»“ng bá»™, cho phÃ©p sá»­ dá»¥ng `await` Ä‘á»ƒ Ä‘á»£i cho Ä‘áº¿n khi má»™t hoáº¡t Ä‘á»™ng báº¥t Ä‘á»“ng bá»™ hoÃ n thÃ nh.

- `const response = await fetch(api/todos/${todoId}, {`: ChÃºng ta sá»­ dá»¥ng `fetch` Ä‘á»ƒ gá»­i má»™t yÃªu cáº§u `DELETE` Ä‘áº¿n API vá»›i URL Ä‘Æ°á»£c xÃ¢y dá»±ng tá»« `api/todos/` vÃ  `todoId` Ä‘á»ƒ chá»‰ Ä‘á»‹nh todo cáº§n xÃ³a.

- `method: 'DELETE'`: ÄÃ¢y lÃ  pháº§n cá»§a cáº¥u hÃ¬nh yÃªu cáº§u gá»­i Ä‘i, chá»‰ Ä‘á»‹nh ráº±ng chÃºng ta Ä‘ang sá»­ dá»¥ng phÆ°Æ¡ng thá»©c `DELETE` Ä‘á»ƒ xÃ³a todo.

- `if (!response.ok) { throw new Error('Failed to delete todo') }`: ChÃºng ta kiá»ƒm tra xem pháº£n há»“i tá»« API cÃ³ thÃ nh cÃ´ng hay khÃ´ng báº±ng cÃ¡ch kiá»ƒm tra giÃ¡ trá»‹ `response.ok`. Trong trÆ°á»ng há»£p khÃ´ng thÃ nh cÃ´ng, chÃºng ta nÃ©m má»™t lá»—i Ä‘á»ƒ xá»­ lÃ½ sau nÃ y.

- TÃ³m láº¡i, hÃ m `deleteTodo` thá»±c hiá»‡n gá»­i yÃªu cáº§u `DELETE` Ä‘áº¿n API Ä‘á»ƒ xÃ³a todo dá»±a trÃªn `todoId`. Náº¿u pháº£n há»“i tá»« API thÃ nh cÃ´ng, khÃ´ng cÃ³ dá»¯ liá»‡u tráº£ vá», ngÆ°á»£c láº¡i, náº¿u khÃ´ng thÃ nh cÃ´ng, chÃºng ta nÃ©m má»™t lá»—i Ä‘á»ƒ xá»­ lÃ½ sau nÃ y.

```jsx
const mutationOptions = {
  onSuccess: () => {
    queryClient.invalidateQueries('todos')
  }
}
```

- Trong Ä‘oáº¡n code trÃªn, chÃºng ta cÃ³ biáº¿n `mutationOptions` Ä‘á»ƒ cáº¥u hÃ¬nh tÃ¹y chá»n cho mutation. DÆ°á»›i Ä‘Ã¢y lÃ  giáº£i thÃ­ch chi tiáº¿t:

- `onSuccess: () => { queryClient.invalidateQueries('todos') }`: ÄÃ¢y lÃ  má»™t callback Ä‘Æ°á»£c gá»i khi mutation thÃ nh cÃ´ng. Trong trÆ°á»ng há»£p nÃ y, chÃºng ta sá»­ dá»¥ng `queryClient.invalidateQueries('todos')` Ä‘á»ƒ lÃ m má»›i táº¥t cáº£ cÃ¡c queries cÃ³ liÃªn quan Ä‘áº¿n danh sÃ¡ch `todos`. `queryClient` lÃ  má»™t instance cá»§a `QueryClient` Ä‘Æ°á»£c táº¡o ra trÆ°á»›c Ä‘Ã³ vÃ  Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tÆ°Æ¡ng tÃ¡c vá»›i React Query. HÃ m `invalidateQueries` Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ Ä‘Ã¡nh dáº¥u cÃ¡c queries liÃªn quan lÃ  khÃ´ng há»£p lá»‡, vÃ  sáº½ Ä‘Æ°á»£c gá»i láº¡i khi cÃ³ yÃªu cáº§u má»›i Ä‘á»ƒ cáº­p nháº­t dá»¯ liá»‡u.

- `queryClient.invalidateQueries('todos')`, dÃ²ng nÃ y cÃ³ nghÄ©a lÃ  khi dá»¯ liá»‡u thay Ä‘á»•i thÃ¬ sáº½ gá»i láº¡i vÃ  sáº½ cáº­p nháº­t láº¡i dá»¯ liá»‡u má»›i háº£ ?

  - ÄÃºng, dÃ²ng code `queryClient.invalidateQueries('todos')` Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ thÃ´ng bÃ¡o cho React Query ráº±ng dá»¯ liá»‡u cÃ³ tÃªn `'todos'` Ä‘Ã£ thay Ä‘á»•i vÃ  cáº§n pháº£i Ä‘Æ°á»£c cáº­p nháº­t láº¡i.

  - Khi gá»i `invalidateQueries('todos')`, React Query sáº½ xÃ³a dá»¯ liá»‡u hiá»‡n cÃ³ cá»§a query cÃ³ tÃªn `'todos'` khá»i cache. Sau Ä‘Ã³, khi truy cáº­p láº¡i query Ä‘Ã³, React Query sáº½ tá»± Ä‘á»™ng thá»±c hiá»‡n má»™t request má»›i Ä‘á»ƒ láº¥y dá»¯ liá»‡u má»›i nháº¥t tá»« server vÃ  cáº­p nháº­t láº¡i cache.

  - Äiá»u nÃ y cho phÃ©p Ä‘á»“ng bá»™ dá»¯ liá»‡u giá»¯a client vÃ  server khi cÃ³ nhá»¯ng thay Ä‘á»•i xáº£y ra, Ä‘áº£m báº£o ráº±ng dá»¯ liá»‡u Ä‘Æ°á»£c hiá»ƒn thá»‹ trÃªn giao diá»‡n ngÆ°á»i dÃ¹ng luÃ´n lÃ  phiÃªn báº£n má»›i nháº¥t.

- TÃ³m láº¡i, khi mutation thÃ nh cÃ´ng, `onSuccess` sáº½ Ä‘Æ°á»£c gá»i vÃ  chÃºng ta sá»­ dá»¥ng `queryClient.invalidateQueries('todos')` Ä‘á»ƒ lÃ m má»›i cÃ¡c queries liÃªn quan Ä‘áº¿n danh sÃ¡ch `todos`, Ä‘á»ƒ Ä‘áº£m báº£o ráº±ng dá»¯ liá»‡u Ä‘Æ°á»£c cáº­p nháº­t vÃ  pháº£n Ã¡nh sá»± thay Ä‘á»•i má»›i nháº¥t.

```jsx
const createMutation = useMutation(createTodo, mutationOptions)
const updateMutation = useMutation(updateTodo, mutationOptions)
const deleteMutation = useMutation(deleteTodo, mutationOptions)
```

- Trong Ä‘oáº¡n code trÃªn, chÃºng ta Ä‘ang sá»­ dá»¥ng ba hook `useMutation` Ä‘á»ƒ táº¡o cÃ¡c mutations cho viá»‡c táº¡o, cáº­p nháº­t vÃ  xÃ³a todos. HÃ£y giáº£i thÃ­ch tá»«ng dÃ²ng code má»™t:

- `const createMutation = useMutation(createTodo, mutationOptions)`: ÄÃ¢y lÃ  cÃ¡ch chÃºng ta sá»­ dá»¥ng `useMutation` Ä‘á»ƒ táº¡o mutation cho hÃ nh Ä‘á»™ng táº¡o má»›i `todo`. `createTodo` lÃ  hÃ m chÃºng ta Ä‘Ã£ Ä‘á»‹nh nghÄ©a trÆ°á»›c Ä‘Ã³, Ä‘áº¡i diá»‡n cho hÃ nh Ä‘á»™ng táº¡o má»›i má»™t `todo`. `mutationOptions` lÃ  Ä‘á»‘i tÆ°á»£ng cáº¥u hÃ¬nh cho mutation, chÃºng ta Ä‘Ã£ giáº£i thÃ­ch á»Ÿ trÃªn. Káº¿t quáº£ cá»§a hook `useMutation` Ä‘Æ°á»£c gÃ¡n vÃ o biáº¿n `createMutation`, vÃ  biáº¿n nÃ y sáº½ chá»©a cÃ¡c thÃ´ng tin vá» tráº¡ng thÃ¡i vÃ  phÆ°Æ¡ng thá»©c liÃªn quan Ä‘áº¿n mutation táº¡o má»›i.

- TÆ°Æ¡ng tá»±, `const updateMutation = useMutation(updateTodo, mutationOptions)` vÃ  `const deleteMutation = useMutation(deleteTodo, mutationOptions)` táº¡o cÃ¡c mutations cho hÃ nh Ä‘á»™ng cáº­p nháº­t vÃ  xÃ³a `todo`. `updateTodo` vÃ  `deleteTodo` lÃ  cÃ¡c hÃ m chÃºng ta Ä‘Ã£ Ä‘á»‹nh nghÄ©a trÆ°á»›c Ä‘Ã³, Ä‘áº¡i diá»‡n cho hÃ nh Ä‘á»™ng cáº­p nháº­t vÃ  xÃ³a `todo` tÆ°Æ¡ng á»©ng.

- TÃ³m láº¡i, ba dÃ²ng code trÃªn táº¡o ra ba mutations sá»­ dá»¥ng `useMutation` vá»›i cÃ¡c hÃ m xá»­ lÃ½ tÆ°Æ¡ng á»©ng vÃ  cáº¥u hÃ¬nh chung Ä‘Æ°á»£c chia sáº» thÃ´ng qua `mutationOptions`. CÃ¡c biáº¿n `createMutation`, `updateMutation` vÃ  `deleteMutation` chá»©a thÃ´ng tin vÃ  phÆ°Æ¡ng thá»©c liÃªn quan Ä‘áº¿n cÃ¡c mutations tÆ°Æ¡ng á»©ng.

```jsx
const handleCreateTodo = () => {
  const newTodo = { title: 'New Todo', completed: false }
  createMutation.mutate(newTodo)
}

const handleUpdateTodo = (todo) => {
  const updatedTodo = { ...todo, completed: !todo.completed }
  updateMutation.mutate(updatedTodo)
}

const handleDeleteTodo = (todoId) => {
  deleteMutation.mutate(todoId)
}
```

- Trong Ä‘oáº¡n code trÃªn, chÃºng ta Ä‘á»‹nh nghÄ©a cÃ¡c hÃ m xá»­ lÃ½ sá»± kiá»‡n Ä‘á»ƒ gá»i cÃ¡c mutations tÆ°Æ¡ng á»©ng. HÃ£y giáº£i thÃ­ch tá»«ng hÃ m má»™t:

- `handleCreateTodo`: ÄÃ¢y lÃ  hÃ m xá»­ lÃ½ sá»± kiá»‡n Ä‘á»ƒ táº¡o má»™t `todo` má»›i. Trong hÃ m nÃ y, chÃºng ta Ä‘áº§u tiÃªn táº¡o má»™t `newTodo` vá»›i cÃ¡c thuá»™c tÃ­nh `title` lÃ  "New Todo" vÃ  `completed` lÃ  false. Sau Ä‘Ã³, chÃºng ta gá»i phÆ°Æ¡ng thá»©c `mutate` cá»§a `createMutation` vÃ  truyá»n vÃ o `newTodo` Ä‘á»ƒ thá»±c hiá»‡n hÃ nh Ä‘á»™ng táº¡o má»›i `todo`.

- `handleUpdateTodo`: ÄÃ¢y lÃ  hÃ m xá»­ lÃ½ sá»± kiá»‡n Ä‘á»ƒ cáº­p nháº­t má»™t `todo` Ä‘Ã£ tá»“n táº¡i. HÃ m nÃ y nháº­n vÃ o má»™t `todo` lÃ  tham sá»‘. Trong hÃ m nÃ y, chÃºng ta táº¡o má»™t `updatedTodo` báº±ng cÃ¡ch sao chÃ©p toÃ n bá»™ thuá»™c tÃ­nh cá»§a `todo` vÃ  thay Ä‘á»•i giÃ¡ trá»‹ cá»§a thuá»™c tÃ­nh `completed` báº±ng phÃ©p Ä‘áº£o ngÆ°á»£c (`!todo.completed`). Sau Ä‘Ã³, chÃºng ta gá»i phÆ°Æ¡ng thá»©c `mutate` cá»§a `updateMutation` vÃ  truyá»n vÃ o `updatedTodo` Ä‘á»ƒ thá»±c hiá»‡n hÃ nh Ä‘á»™ng cáº­p nháº­t todo.

- `handleDeleteTodo`: ÄÃ¢y lÃ  hÃ m xá»­ lÃ½ sá»± kiá»‡n Ä‘á»ƒ xÃ³a má»™t `todo` Ä‘Ã£ tá»“n táº¡i. HÃ m nÃ y nháº­n vÃ o má»™t `todoId` lÃ  tham sá»‘. Trong hÃ m nÃ y, chÃºng ta gá»i phÆ°Æ¡ng thá»©c `mutate` cá»§a `deleteMutation` vÃ  truyá»n vÃ o `todoId` Ä‘á»ƒ thá»±c hiá»‡n hÃ nh Ä‘á»™ng xÃ³a `todo`.

- TÃ³m láº¡i, cÃ¡c hÃ m xá»­ lÃ½ sá»± kiá»‡n trÃªn Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ gá»i cÃ¡c mutations tÆ°Æ¡ng á»©ng thÃ´ng qua viá»‡c gá»i phÆ°Æ¡ng thá»©c `mutate` cá»§a cÃ¡c biáº¿n `createMutation`, `updateMutation` vÃ  `deleteMutation`. Viá»‡c gá»i phÆ°Æ¡ng thá»©c `mutate` nÃ y sáº½ kÃ­ch hoáº¡t quÃ¡ trÃ¬nh thá»±c hiá»‡n mutations tÆ°Æ¡ng á»©ng vÃ  cáº­p nháº­t dá»¯ liá»‡u trong cache cá»§a React Query.

```jsx
return (
  <div>
    <button onClick={handleCreateTodo}>Create Todo</button>
    <ul>
      {todos.map((todo) => (
        <li key={todo.id}>
          {todo.title} - {todo.completed ? 'Completed' : 'Not Completed'}
          <button onClick={() => handleUpdateTodo(todo)}>Toggle Complete</button>
          <button onClick={() => handleDeleteTodo(todo.id)}>Delete</button>
        </li>
      ))}
    </ul>
  </div>
)
```

- Äoáº¡n code trÃªn render ra má»™t danh sÃ¡ch cÃ¡c Todo vÃ  cung cáº¥p cÃ¡c nÃºt Ä‘á»ƒ táº¡o, cáº­p nháº­t vÃ  xÃ³a Todo. HÃ£y giáº£i thÃ­ch tá»«ng pháº§n má»™t:

- `<button onClick={handleCreateTodo}>Create Todo</button>`: ÄÃ¢y lÃ  má»™t nÃºt "Create Todo" vÃ  khi ngÆ°á»i dÃ¹ng nháº¥n vÃ o nÃºt nÃ y, sá»± kiá»‡n `onClick` sáº½ Ä‘Æ°á»£c kÃ­ch hoáº¡t vÃ  gá»i Ä‘áº¿n hÃ m `handleCreateTodo()` Ä‘á»ƒ táº¡o má»™t Todo má»›i.

- `<ul>`: ÄÃ¢y lÃ  má»™t danh sÃ¡ch khÃ´ng sáº¯p xáº¿p (unordered list) Ä‘á»ƒ hiá»ƒn thá»‹ danh sÃ¡ch cÃ¡c Todo.

- `{todos.map((todo) => (...)}`: ÄÃ¢y lÃ  má»™t vÃ²ng láº·p, láº·p qua máº£ng `todos` Ä‘á»ƒ táº¡o ra cÃ¡c pháº§n tá»­ `<li>` tÆ°Æ¡ng á»©ng vá»›i má»—i Todo trong danh sÃ¡ch.

- `<li key={todo.id}>`: ÄÃ¢y lÃ  má»™t pháº§n tá»­ trong danh sÃ¡ch Todo vÃ  cÃ³ thuá»™c tÃ­nh `key` Ä‘Æ°á»£c gÃ¡n báº±ng giÃ¡ trá»‹ `todo.id` Ä‘á»ƒ Ä‘á»‹nh danh duy nháº¥t cho má»—i Todo.

- `{todo.title} - {todo.completed ? 'Completed' : 'Not Completed'}`: Hiá»ƒn thá»‹ tiÃªu Ä‘á» cá»§a Todo vÃ  tráº¡ng thÃ¡i hoÃ n thÃ nh cá»§a nÃ³.

- `<button onClick={() => handleUpdateTodo(todo)}>Toggle Complete</button>`: ÄÃ¢y lÃ  má»™t nÃºt "Toggle Complete" vÃ  khi ngÆ°á»i dÃ¹ng nháº¥n vÃ o nÃºt nÃ y, sá»± kiá»‡n `onClick` sáº½ Ä‘Æ°á»£c kÃ­ch hoáº¡t vÃ  gá»i Ä‘áº¿n hÃ m `handleUpdateTodo()` vá»›i tham sá»‘ lÃ  Todo tÆ°Æ¡ng á»©ng Ä‘á»ƒ cáº­p nháº­t tráº¡ng thÃ¡i hoÃ n thÃ nh cá»§a nÃ³.

- `<button onClick={() => handleDeleteTodo(todo.id)}>Delete</button>`: ÄÃ¢y lÃ  má»™t nÃºt "Delete" vÃ  khi ngÆ°á»i dÃ¹ng nháº¥n vÃ o nÃºt nÃ y, sá»± kiá»‡n `onClick` sáº½ Ä‘Æ°á»£c kÃ­ch hoáº¡t vÃ  gá»i Ä‘áº¿n hÃ m `handleDeleteTodo()` vá»›i tham sá»‘ lÃ  `todo.id` Ä‘á»ƒ xÃ³a Todo tÆ°Æ¡ng á»©ng.

- Tá»•ng cá»™ng, Ä‘oáº¡n code trÃªn hiá»ƒn thá»‹ danh sÃ¡ch Todo vÃ  cung cáº¥p cÃ¡c nÃºt Ä‘á»ƒ táº¡o, cáº­p nháº­t vÃ  xÃ³a Todo. Khi ngÆ°á»i dÃ¹ng thá»±c hiá»‡n cÃ¡c hÃ nh Ä‘á»™ng nÃ y, cÃ¡c hÃ m xá»­ lÃ½ sá»± kiá»‡n tÆ°Æ¡ng á»©ng (`handleCreateTodo`, `handleUpdateTodo`, `handleDeleteTodo`) sáº½ Ä‘Æ°á»£c gá»i Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c mutations vÃ  cáº­p nháº­t dá»¯ liá»‡u.

## HÃ£y nÃªu khÃ¡i niá»‡m useQuery trong react query ?

- Trong React Query, `useQuery` lÃ  má»™t hook Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ thá»±c hiá»‡n yÃªu cáº§u láº¥y dá»¯ liá»‡u tá»« má»™t nguá»“n bÃªn ngoÃ i, cháº³ng háº¡n nhÆ° API, vÃ  theo dÃµi tráº¡ng thÃ¡i cá»§a yÃªu cáº§u.

- Khi sá»­ dá»¥ng `useQuery`, báº¡n cáº§n cung cáº¥p cÃ¡c thÃ´ng tin cáº§n thiáº¿t nhÆ° `queryKey` vÃ  `queryFn`. `queryKey` lÃ  má»™t giÃ¡ trá»‹ duy nháº¥t Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ Ä‘á»‹nh danh cho query, xÃ¡c Ä‘á»‹nh loáº¡i dá»¯ liá»‡u Ä‘Æ°á»£c yÃªu cáº§u. `queryFn` lÃ  má»™t hÃ m mÃ  React Query sáº½ gá»i Ä‘á»ƒ thá»±c hiá»‡n yÃªu cáº§u láº¥y dá»¯ liá»‡u.

- Khi yÃªu cáº§u Ä‘Æ°á»£c gá»­i Ä‘i, `useQuery` sáº½ tá»± Ä‘á»™ng theo dÃµi tráº¡ng thÃ¡i cá»§a yÃªu cáº§u vÃ  cung cáº¥p cÃ¡c biáº¿n nhÆ° `data`, `isLoading`, `isError`, `error`, `isFetching`, `refetch` vÃ  nhiá»u biáº¿n khÃ¡c Ä‘á»ƒ giÃºp báº¡n xá»­ lÃ½ vÃ  hiá»ƒn thá»‹ dá»¯ liá»‡u vÃ  tráº¡ng thÃ¡i tÆ°Æ¡ng á»©ng.

- Má»™t sá»‘ khÃ¡i niá»‡m quan trá»ng liÃªn quan Ä‘áº¿n `useQuery` trong React Query:

- `data`: Dá»¯ liá»‡u tráº£ vá» tá»« yÃªu cáº§u láº¥y dá»¯ liá»‡u. NÃ³ sáº½ Ä‘Æ°á»£c cáº­p nháº­t khi yÃªu cáº§u thÃ nh cÃ´ng.
- `isLoading`: XÃ¡c Ä‘á»‹nh xem yÃªu cáº§u Ä‘ang trong quÃ¡ trÃ¬nh táº£i hay khÃ´ng.
- `isError`: XÃ¡c Ä‘á»‹nh xem yÃªu cáº§u cÃ³ gáº·p lá»—i hay khÃ´ng.
- `error`: ThÃ´ng tin vá» lá»—i náº¿u yÃªu cáº§u gáº·p lá»—i.
- `isFetching`: XÃ¡c Ä‘á»‹nh xem yÃªu cáº§u Ä‘ang trong quÃ¡ trÃ¬nh fetch hay khÃ´ng, bao gá»“m cáº£ khi sá»­ dá»¥ng refetch.
- `refetch`: Má»™t hÃ m dÃ¹ng Ä‘á»ƒ gá»­i láº¡i yÃªu cáº§u láº¥y dá»¯ liá»‡u.
- `onSuccess`: Má»™t hÃ m callback Ä‘Æ°á»£c gá»i khi yÃªu cáº§u thÃ nh cÃ´ng.
- `onError`: Má»™t hÃ m callback Ä‘Æ°á»£c gá»i khi yÃªu cáº§u gáº·p lá»—i.

- Sá»­ dá»¥ng `useQuery`, báº¡n cÃ³ thá»ƒ táº¡o cÃ¡c query instances Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c yÃªu cáº§u láº¥y dá»¯ liá»‡u khÃ¡c nhau trong á»©ng dá»¥ng vÃ  quáº£n lÃ½ tráº¡ng thÃ¡i cá»§a chÃºng.

## VÃ­ dá»¥ cÆ¡ báº£n vá» useQuery trong react query ?

- DÆ°á»›i Ä‘Ã¢y lÃ  má»™t vÃ­ dá»¥ cÆ¡ báº£n vá» cÃ¡ch sá»­ dá»¥ng `useQuery` trong React Query Ä‘á»ƒ láº¥y danh sÃ¡ch cÃ¡c bÃ i viáº¿t tá»« má»™t API:

```jsx
import { useQuery } from 'react-query'

const fetchPosts = async () => {
  const response = await fetch('api/posts')
  const data = await response.json()
  return data
}

function PostList() {
  const { data, isLoading, isError, error } = useQuery('posts', fetchPosts)

  if (isLoading) {
    return <div>Loading...</div>
  }

  if (isError) {
    return <div>Error: {error.message}</div>
  }

  return (
    <div>
      <h1>Post List</h1>
      <ul>
        {data.map((post) => (
          <li key={post.id}>{post.title}</li>
        ))}
      </ul>
    </div>
  )
}
```

- Trong vÃ­ dá»¥ trÃªn, chÃºng ta sá»­ dá»¥ng `useQuery` Ä‘á»ƒ thá»±c hiá»‡n yÃªu cáº§u láº¥y danh sÃ¡ch cÃ¡c bÃ i viáº¿t tá»« API. ChÃºng ta cung cáº¥p má»™t `queryKey` (trong trÆ°á»ng há»£p nÃ y lÃ  `'posts'`) Ä‘á»ƒ Ä‘á»‹nh danh cho query vÃ  má»™t `queryFn` (trong trÆ°á»ng há»£p nÃ y lÃ  hÃ m `fetchPosts`) Ä‘á»ƒ thá»±c hiá»‡n yÃªu cáº§u.

- Khi yÃªu cáº§u Ä‘Æ°á»£c gá»­i Ä‘i, `useQuery` sáº½ tá»± Ä‘á»™ng theo dÃµi tráº¡ng thÃ¡i cá»§a yÃªu cáº§u vÃ  cung cáº¥p cÃ¡c biáº¿n nhÆ° `data`, `isLoading`, `isError`, `error` Ä‘á»ƒ xá»­ lÃ½ vÃ  hiá»ƒn thá»‹ dá»¯ liá»‡u tÆ°Æ¡ng á»©ng. Trong vÃ­ dá»¥ nÃ y, chÃºng ta kiá»ƒm tra tráº¡ng thÃ¡i cá»§a yÃªu cáº§u vÃ  hiá»ƒn thá»‹ dá»¯ liá»‡u, thÃ´ng bÃ¡o táº£i dá»¯ liá»‡u hoáº·c thÃ´ng bÃ¡o lá»—i tÆ°Æ¡ng á»©ng.

- Vá»›i `useQuery`, chÃºng ta cÃ³ thá»ƒ dá»… dÃ ng thá»±c hiá»‡n cÃ¡c yÃªu cáº§u láº¥y dá»¯ liá»‡u vÃ  quáº£n lÃ½ tráº¡ng thÃ¡i cá»§a chÃºng trong á»©ng dá»¥ng React má»™t cÃ¡ch dá»… dÃ ng vÃ  máº¡nh máº½.

## Äá»‹nh danh trong query trong queryKey cá»§a React Query lÃ  sao ?

- Trong ngá»¯ cáº£nh cá»§a React Query, "Ä‘á»‹nh danh" (identity) lÃ  má»™t cÃ¡ch Ä‘á»ƒ xÃ¡c Ä‘á»‹nh má»™t truy váº¥n dá»¯ liá»‡u má»™t cÃ¡ch duy nháº¥t. NÃ³ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ phÃ¢n biá»‡t cÃ¡c truy váº¥n khÃ¡c nhau vÃ  quáº£n lÃ½ káº¿t quáº£ truy váº¥n.

- Äá»‹nh danh thÆ°á»ng Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh báº±ng cÃ¡ch sá»­ dá»¥ng má»™t giÃ¡ trá»‹ duy nháº¥t nhÆ° má»™t khÃ³a (`key`). Trong React Query, `queryKey` cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ xÃ¡c Ä‘á»‹nh Ä‘á»‹nh danh cho má»™t truy váº¥n. `queryKey` cÃ³ thá»ƒ lÃ  má»™t máº£ng (array) chá»©a cÃ¡c giÃ¡ trá»‹ nhÆ° tÃªn truy váº¥n vÃ  cÃ¡c tham sá»‘ Ä‘i kÃ¨m, hoáº·c cÃ³ thá»ƒ lÃ  má»™t giÃ¡ trá»‹ duy nháº¥t Ä‘áº¡i diá»‡n cho truy váº¥n.

- Khi Ä‘á»‹nh danh cá»§a má»™t truy váº¥n thay Ä‘á»•i, React Query sáº½ hiá»ƒu ráº±ng Ä‘Ã³ lÃ  má»™t truy váº¥n má»›i vÃ  sáº½ thá»±c hiá»‡n truy váº¥n láº¡i tá»« `server` thay vÃ¬ sá»­ dá»¥ng káº¿t quáº£ tá»« bá»™ nhá»› `cache`. Äiá»u nÃ y Ä‘áº£m báº£o ráº±ng báº¡n nháº­n Ä‘Æ°á»£c dá»¯ liá»‡u má»›i nháº¥t tá»« `server` khi cÃ³ sá»± thay Ä‘á»•i trong Ä‘á»‹nh danh cá»§a truy váº¥n.

## Má»—i giÃ¡ trá»‹ Ä‘á»‹nh danh Ä‘Ã³ thÃ¬ nÃ³ sáº½ gÃ¡n cho 1 id. CÃ³ nghÄ©a lÃ  1 dá»¯ liá»‡u Ä‘Æ°á»£c gÃ¡n cho 1 id, cÃ³ 10 dá»¯ liá»‡u thÃ¬ sáº½ gÃ¡n cho 10 id háº£ ?

- ÄÃºng, trong React Query, má»—i giÃ¡ trá»‹ Ä‘á»‹nh danh (`queryKey`) sáº½ Ä‘Æ°á»£c gÃ¡n cho má»™t ID duy nháº¥t Ä‘á»ƒ xÃ¡c Ä‘á»‹nh truy váº¥n dá»¯ liá»‡u tÆ°Æ¡ng á»©ng. Khi thá»±c hiá»‡n má»™t truy váº¥n, React Query sáº½ sá»­ dá»¥ng Ä‘á»‹nh danh Ä‘á»ƒ xÃ¡c Ä‘á»‹nh xem truy váº¥n Ä‘Ã£ Ä‘Æ°á»£c thá»±c hiá»‡n trÆ°á»›c Ä‘Ã³ hay chÆ°a.

- VÃ­ dá»¥, náº¿u báº¡n cÃ³ 10 dá»¯ liá»‡u vÃ  muá»‘n láº¥y thÃ´ng tin chi tiáº¿t vá» tá»«ng dá»¯ liá»‡u, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng `queryKey` vá»›i má»™t giÃ¡ trá»‹ duy nháº¥t (vÃ­ dá»¥: `'post'`) vÃ  káº¿t há»£p nÃ³ vá»›i ID cá»§a tá»«ng bÃ i viáº¿t Ä‘á»ƒ táº¡o ra má»™t Ä‘á»‹nh danh duy nháº¥t cho tá»«ng truy váº¥n. Äiá»u nÃ y cho phÃ©p React Query quáº£n lÃ½ cÃ¡c káº¿t quáº£ truy váº¥n riÃªng biá»‡t cho tá»«ng bÃ i viáº¿t.

- VÃ­ dá»¥: `['post', 1]`, `['post', 2]`, `['post', 3]`, v.v. lÃ  cÃ¡c Ä‘á»‹nh danh duy nháº¥t cho cÃ¡c truy váº¥n láº¥y thÃ´ng tin tá»«ng bÃ i viáº¿t tÆ°Æ¡ng á»©ng.

## VÃ­ dá»¥ nÃ¢ng cao vá» useQuery trong react query ?

- DÆ°á»›i Ä‘Ã¢y lÃ  má»™t vÃ­ dá»¥ nÃ¢ng cao vá» viá»‡c sá»­ dá»¥ng `useQuery` trong React Query:

```jsx
import { useQuery } from 'react-query'

const fetchUser = async (userId) => {
  const response = await fetch(`api/users/${userId}`)

  if (!response.ok) {
    throw new Error('Failed to fetch user')
  }

  const data = await response.json()
  return data
}

const UserProfile = ({ userId }) => {
  const { data, isLoading, isError, error } = useQuery(['user', userId], () => fetchUser(userId))

  if (isLoading) {
    return <div>Loading...</div>
  }

  if (isError) {
    return <div>Error: {error.message}</div>
  }

  return (
    <div>
      <h2>User Profile</h2>
      <p>Name: {data.name}</p>
      <p>Email: {data.email}</p>
      <p>Location: {data.location}</p>
    </div>
  )
}

export default UserProfile
```

- Trong vÃ­ dá»¥ trÃªn, chÃºng ta cÃ³ má»™t thÃ nh pháº§n (component) `UserProfile` nháº­n vÃ o má»™t `userId` lÃ m prop. ChÃºng ta sá»­ dá»¥ng `useQuery` Ä‘á»ƒ láº¥y dá»¯ liá»‡u ngÆ°á»i dÃ¹ng tá»« API báº±ng cÃ¡ch gá»i hÃ m `fetchUser` trong hÃ m truyá»n vÃ o cá»§a `useQuery`.

- Trong `useQuery`, chÃºng ta truyá»n má»™t máº£ng dependencies lÃ  `['user', userId]` Ä‘á»ƒ Ä‘á»‹nh danh yÃªu cáº§u dá»¯ liá»‡u ngÆ°á»i dÃ¹ng. Äiá»u nÃ y cho phÃ©p chÃºng ta sá»­ dá»¥ng cÃ¹ng má»™t hÃ m `fetchUser` cho nhiá»u yÃªu cáº§u khÃ¡c nhau báº±ng cÃ¡ch Ä‘á»‹nh danh chÃºng vá»›i cÃ¡c `key` khÃ¡c nhau.
- Khi yÃªu cáº§u dá»¯ liá»‡u Ä‘ang Ä‘Æ°á»£c thá»±c hiá»‡n, `isLoading` sáº½ lÃ  `true`, cho phÃ©p chÃºng ta hiá»ƒn thá»‹ thÃ´ng bÃ¡o "Loading..." Ä‘á»ƒ ngÆ°á»i dÃ¹ng biáº¿t ráº±ng dá»¯ liá»‡u Ä‘ang Ä‘Æ°á»£c táº£i.
- Náº¿u cÃ³ lá»—i xáº£y ra trong quÃ¡ trÃ¬nh yÃªu cáº§u dá»¯ liá»‡u, `isError` sáº½ lÃ  `true` vÃ  `error` sáº½ chá»©a thÃ´ng tin lá»—i. ChÃºng ta hiá»ƒn thá»‹ thÃ´ng bÃ¡o lá»—i cho ngÆ°á»i dÃ¹ng.
- Náº¿u yÃªu cáº§u dá»¯ liá»‡u thÃ nh cÃ´ng, chÃºng ta sá»­ dá»¥ng `data` Ä‘á»ƒ truy cáº­p vÃ  hiá»ƒn thá»‹ thÃ´ng tin ngÆ°á»i dÃ¹ng nhÆ° tÃªn (`name`), `email` vÃ  Ä‘á»‹a chá»‰ (`address`).

- Vá»›i `useQuery`, React Query sáº½ tá»± Ä‘á»™ng quáº£n lÃ½ viá»‡c táº¡o vÃ  lÆ°u trá»¯ cache dá»¯ liá»‡u, tá»± Ä‘á»™ng lÃ m má»›i dá»¯ liá»‡u theo cÃ¡c tiÃªu chÃ­ `dependencies` vÃ  cung cáº¥p cÃ¡c tÃ­nh nÄƒng nhÆ° `prefetching` vÃ  `refetching` dá»¯ liá»‡u. Äiá»u nÃ y giÃºp tá»‘i Æ°u hiá»‡u suáº¥t á»©ng dá»¥ng vÃ  cung cáº¥p tráº£i nghiá»‡m ngÆ°á»i dÃ¹ng tá»‘t hÆ¡n.

## Giáº£i thÃ­ch chi tiáº¿t Ä‘oáº¡n code trÃªn:

- Äoáº¡n mÃ£ trÃªn lÃ  má»™t vÃ­ dá»¥ vá» cÃ¡ch sá»­ dá»¥ng thÆ° viá»‡n React Query Ä‘á»ƒ táº£i dá»¯ liá»‡u tá»« má»™t API vÃ  hiá»ƒn thá»‹ nÃ³ trÃªn giao diá»‡n. DÆ°á»›i Ä‘Ã¢y lÃ  phÃ¢n tÃ­ch tá»«ng Ä‘oáº¡n mÃ£:

```jsx
import { useQuery } from 'react-query'
```

- DÃ²ng code `import { useQuery } from 'react-query';`: Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ import hook `useQuery` tá»« thÆ° viá»‡n React Query. Hook nÃ y cho phÃ©p chÃºng ta thá»±c hiá»‡n cÃ¡c yÃªu cáº§u dá»¯ liá»‡u vÃ  quáº£n lÃ½ cache trong á»©ng dá»¥ng React.

- `useQuery` lÃ  má»™t hook máº¡nh máº½ Ä‘Æ°á»£c cung cáº¥p bá»Ÿi React Query Ä‘á»ƒ thá»±c hiá»‡n yÃªu cáº§u dá»¯ liá»‡u. NÃ³ nháº­n vÃ o hai tham sá»‘ chÃ­nh lÃ  `queryKey`, `queryFn`.

```jsx
const fetchUser = async (userId) => {
  const response = await fetch(`api/users/${userId}`)

  if (!response.ok) {
    throw new Error('Failed to fetch user')
  }

  const data = await response.json()
  return data
}
```

- Äoáº¡n code trÃªn Ä‘á»‹nh nghÄ©a má»™t hÃ m `fetchUser` Ä‘á»ƒ thá»±c hiá»‡n yÃªu cáº§u láº¥y dá»¯ liá»‡u (GET) ngÆ°á»i dÃ¹ng tá»« API.

- Äáº§u tiÃªn, hÃ m nÃ y nháº­n má»™t tham sá»‘ `userId`, Ä‘áº¡i diá»‡n cho ID cá»§a ngÆ°á»i dÃ¹ng mÃ  chÃºng ta muá»‘n láº¥y thÃ´ng tin.

- Tiáº¿p theo, chÃºng ta sá»­ dá»¥ng `fetch` Ä‘á»ƒ gá»­i yÃªu cáº§u HTTP GET Ä‘áº¿n Ä‘Æ°á»ng dáº«n `api/users/${userId}` Ä‘á»ƒ láº¥y thÃ´ng tin ngÆ°á»i dÃ¹ng tá»« API. ÄÃ¢y lÃ  má»™t endpoint giáº£ Ä‘á»‹nh trong vÃ­ dá»¥ cá»§a chÃºng ta. Báº¡n cÃ³ thá»ƒ thay tháº¿ nÃ³ báº±ng endpoint thá»±c táº¿ trong á»©ng dá»¥ng cá»§a báº¡n.

- ChÃºng ta sá»­ dá»¥ng `response.ok` Ä‘á»ƒ kiá»ƒm tra xem yÃªu cáº§u Ä‘Ã£ thÃ nh cÃ´ng hay khÃ´ng. Náº¿u yÃªu cáº§u khÃ´ng thÃ nh cÃ´ng (`response.ok` lÃ  `false`), chÃºng ta nÃ©m má»™t lá»—i báº±ng cÃ¡ch sá»­ dá»¥ng `throw new Error('Failed to fetch user')`.

- Náº¿u yÃªu cáº§u thÃ nh cÃ´ng, chÃºng ta sá»­ dá»¥ng `response.json()` Ä‘á»ƒ chuyá»ƒn Ä‘á»•i pháº£n há»“i tá»« dáº¡ng JSON sang dá»¯ liá»‡u Ä‘á»‘i tÆ°á»£ng (`object`) JavaScript. ÄÃ¢y lÃ  pháº§n dá»¯ liá»‡u mÃ  chÃºng ta mong Ä‘á»£i tá»« yÃªu cáº§u ngÆ°á»i dÃ¹ng.

- Kiá»ƒu dá»¯ liá»‡u JSON lÃ  kiá»ƒu nÃ y:

```
"
  {
    "name": "John Doe",
    "age": 30,
    "email": "john.doe@example.com"
  }
"
```

- Khi chuyá»ƒn Ä‘á»•i tá»« kiá»ƒu JSON sang Object lÃ  kiá»ƒu nÃ y:

```jsx
{
  name: "John Doe",
  age: 30,
  email: "john.doe@example.com"
}
```

- Cuá»‘i cÃ¹ng, chÃºng ta tráº£ vá» dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c chuyá»ƒn Ä‘á»•i. Káº¿t quáº£ nÃ y sáº½ Ä‘Æ°á»£c sá»­ dá»¥ng bá»Ÿi hook `useQuery` Ä‘á»ƒ cung cáº¥p dá»¯ liá»‡u ngÆ°á»i dÃ¹ng cho á»©ng dá»¥ng.

- TÃ³m láº¡i, hÃ m `fetchUser` nÃ y thá»±c hiá»‡n yÃªu cáº§u láº¥y dá»¯ liá»‡u (GET) ngÆ°á»i dÃ¹ng tá»« API vÃ  tráº£ vá» dá»¯ liá»‡u sau khi nÃ³ Ä‘Ã£ Ä‘Æ°á»£c chuyá»ƒn Ä‘á»•i tá»« JSON sang dá»¯ liá»‡u Ä‘á»‘i tÆ°á»£ng (Object) JavaScript.

```jsx
const UserProfile = ({ userId }) => {
  const { data, isLoading, isError, error } = useQuery(['user', userId], () => fetchUser(userId))

  if (isLoading) {
    return <div>Loading...</div>
  }

  if (isError) {
    return <div>Error: {error.message}</div>
  }

  return (
    <div>
      <h2>User Profile</h2>
      <p>Name: {data.name}</p>
      <p>Email: {data.email}</p>
      <p>Location: {data.location}</p>
    </div>
  )
}
```

- Äoáº¡n code trÃªn lÃ  má»™t component `UserProfile` sá»­ dá»¥ng `useQuery` Ä‘á»ƒ láº¥y thÃ´ng tin ngÆ°á»i dÃ¹ng tá»« API vÃ  hiá»ƒn thá»‹ trÃªn giao diá»‡n ngÆ°á»i dÃ¹ng.

- Trong component, chÃºng ta sá»­ dá»¥ng `useQuery` Ä‘á»ƒ táº¡o má»™t truy váº¥n cÃ³ tÃªn lÃ  `'user'` vÃ  `userId` lÃ  tham sá»‘ phá»¥ thuá»™c. Äiá»u nÃ y Ä‘áº£m báº£o ráº±ng truy váº¥n sáº½ Ä‘Æ°á»£c tá»± Ä‘á»™ng kÃ­ch hoáº¡t má»—i khi `userId` thay Ä‘á»•i.

  - `['user', userId]` lÃ  `queryKey`. ÄÃ¢y lÃ  má»™t máº£ng chá»©a cÃ¡c tham sá»‘ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ Ä‘á»‹nh danh cho truy váº¥n (query). Trong trÆ°á»ng há»£p nÃ y, `queryKey` Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ Ä‘á»‹nh danh cho má»™t truy váº¥n Ä‘á»ƒ láº¥y thÃ´ng tin cá»§a má»™t ngÆ°á»i dÃ¹ng cá»¥ thá»ƒ (`userId`).

  - `() => fetchUser(userId)` lÃ  `queryFn`. ÄÃ¢y lÃ  má»™t hÃ m Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ thá»±c hiá»‡n truy váº¥n vÃ  tráº£ vá» káº¿t quáº£. Trong trÆ°á»ng há»£p nÃ y, `queryFn` Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ gá»i hÃ m `fetchUser` Ä‘á»ƒ táº£i thÃ´ng tin cá»§a ngÆ°á»i dÃ¹ng tá»« API. PhÆ°Æ¡ng thá»©c `useQuery` sáº½ tá»± Ä‘á»™ng gá»i `queryFn` khi cáº§n thiáº¿t Ä‘á»ƒ táº£i láº¡i dá»¯ liá»‡u hoáº·c khi truy váº¥n chÆ°a Ä‘Æ°á»£c thá»±c hiá»‡n. Káº¿t quáº£ cá»§a `queryFn` sáº½ Ä‘Æ°á»£c lÆ°u trá»¯ trong `data`.

- Tham sá»‘ thá»© hai cá»§a `useQuery` lÃ  má»™t hÃ m `callback`, trong Ä‘Ã³ chÃºng ta gá»i hÃ m `fetchUser(userId)` Ä‘á»ƒ láº¥y thÃ´ng tin ngÆ°á»i dÃ¹ng tá»« API.
- Káº¿t quáº£ truy váº¥n Ä‘Æ°á»£c lÆ°u trong cÃ¡c biáº¿n `data`, `isLoading`, `isError`, `error`.
- Náº¿u Ä‘ang trong quÃ¡ trÃ¬nh táº£i dá»¯ liá»‡u (`isLoading` lÃ  `true`), chÃºng ta hiá»ƒn thá»‹ má»™t thÃ´ng bÃ¡o "Loading...".
- Náº¿u cÃ³ lá»—i trong quÃ¡ trÃ¬nh truy váº¥n (`isError` lÃ  `true`), chÃºng ta hiá»ƒn thá»‹ thÃ´ng bÃ¡o lá»—i kÃ¨m theo thÃ´ng tin lá»—i tá»« `error.message`.
- Náº¿u khÃ´ng cÃ³ lá»—i vÃ  dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c táº£i thÃ nh cÃ´ng, chÃºng ta hiá»ƒn thá»‹ thÃ´ng tin ngÆ°á»i dÃ¹ng nhÆ° tÃªn, email vÃ  vá»‹ trÃ­ (`name`, `email`, `location`).

- Äoáº¡n code trÃªn cho phÃ©p láº¥y dá»¯ liá»‡u tá»« API vÃ  tá»± Ä‘á»™ng cáº­p nháº­t khi userId thay Ä‘á»•i. NÃ³ cÅ©ng xá»­ lÃ½ cÃ¡c tráº¡ng thÃ¡i táº£i dá»¯ liá»‡u vÃ  xá»­ lÃ½ lá»—i Ä‘á»ƒ cung cáº¥p tráº£i nghiá»‡m ngÆ°á»i dÃ¹ng mÆ°á»£t mÃ .

```jsx
export default UserProfile
```

- `export default` Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ xuáº¥t cÃ¡c thÃ nh pháº§n cá»§a `module` mÃ  cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng bÃªn ngoÃ i `module` nÃ y. Trong trÆ°á»ng há»£p nÃ y, `UserProfile` lÃ  má»™t React function component Ä‘Ã£ Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trong `module` hiá»‡n táº¡i, vÃ  `export default UserProfile` Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ xuáº¥t component nÃ y ra bÃªn ngoÃ i `module` Ä‘á»ƒ cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng trong cÃ¡c `module` khÃ¡c cá»§a á»©ng dá»¥ng React.

- Khi má»™t `module` Ä‘Æ°á»£c xuáº¥t dÆ°á»›i dáº¡ng `export default`, nÃ³ cÃ³ thá»ƒ Ä‘Æ°á»£c nháº­p vÃ o má»™t `module` khÃ¡c báº±ng cÃ¡ch sá»­ dá»¥ng `import` mÃ  khÃ´ng cáº§n Ä‘áº·t tÃªn cho thÃ nh pháº§n Ä‘Æ°á»£c xuáº¥t.

- VÃ­ dá»¥ vá» import module nÃ y vÃ o component khÃ¡c:

```jsx
import UserProfile from './UserProfile'
```

- Trong vÃ­ dá»¥ nÃ y, module `UserProfile` Ä‘Æ°á»£c import vÃ o module hiá»‡n táº¡i, vÃ  Ä‘Æ°á»£c lÆ°u trá»¯ trong biáº¿n `UserProfile`. Biáº¿n nÃ y sáº½ chá»©a component `UserProfile`, vÃ  cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ hiá»ƒn thá»‹ component nÃ y trÃªn giao diá»‡n cá»§a á»©ng dá»¥ng React.

## Tá»•ng quan vá» useMutation vÃ  useQuery trong react query ?

- `useMutation` vÃ  `useQuery` lÃ  hai hook quan trá»ng trong React Query. DÆ°á»›i Ä‘Ã¢y lÃ  tá»•ng quan vá» cáº£ hai hook:

1. `useMutation`:

- `useMutation` Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c yÃªu cáº§u `thay Ä‘á»•i` dá»¯ liá»‡u nhÆ° táº¡o má»›i, cáº­p nháº­t hoáº·c xÃ³a dá»¯ liá»‡u tá»« server.
- NÃ³ nháº­n vÃ o má»™t hÃ m `mutationFn` (hoáº·c promise) Ä‘á»ƒ thá»±c hiá»‡n yÃªu cáº§u thay Ä‘á»•i dá»¯ liá»‡u.

- `useMutation` cung cáº¥p cÃ¡c biáº¿n vÃ  phÆ°Æ¡ng thá»©c Ä‘á»ƒ quáº£n lÃ½ tráº¡ng thÃ¡i cá»§a yÃªu cáº§u, nhÆ° `isLoading`, `isError`, `error`, `data`, `mutate`, `reset`, vÃ  nhiá»u hÆ¡n ná»¯a.

  - `mutate`: PhÆ°Æ¡ng thá»©c nÃ y dÃ¹ng Ä‘á»ƒ kÃ­ch hoáº¡t quÃ¡ trÃ¬nh mutation. Báº¡n cÃ³ thá»ƒ truyá»n vÃ o dá»¯ liá»‡u cáº§n thay Ä‘á»•i vÃ  nÃ³ sáº½ gá»­i yÃªu cáº§u tá»›i server Ä‘á»ƒ thá»±c hiá»‡n mutation.
  - `isLoading, isError, isSuccess`: CÃ¡c tráº¡ng thÃ¡i nÃ y xÃ¡c Ä‘á»‹nh tráº¡ng thÃ¡i hiá»‡n táº¡i cá»§a quÃ¡ trÃ¬nh mutation (Ä‘ang táº£i, cÃ³ lá»—i, thÃ nh cÃ´ng).
  - `error`: Náº¿u cÃ³ lá»—i xáº£y ra trong quÃ¡ trÃ¬nh mutation, thÃ´ng tin lá»—i sáº½ Ä‘Æ°á»£c lÆ°u trong biáº¿n error.
  - `reset`: PhÆ°Æ¡ng thá»©c nÃ y dÃ¹ng Ä‘á»ƒ Ä‘áº·t láº¡i tráº¡ng thÃ¡i cá»§a mutation vá» tráº¡ng thÃ¡i ban Ä‘áº§u.

- Báº±ng cÃ¡ch sá»­ dá»¥ng `mutate`, chÃºng ta cÃ³ thá»ƒ gá»­i yÃªu cáº§u thay Ä‘á»•i dá»¯ liá»‡u má»™t cÃ¡ch báº¥t Ä‘á»“ng bá»™ vÃ  quáº£n lÃ½ tráº¡ng thÃ¡i yÃªu cáº§u dá»… dÃ ng.

2. `useQuery`:

- `useQuery` Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c yÃªu cáº§u `láº¥y` dá»¯ liá»‡u tá»« server.
- NÃ³ nháº­n vÃ o má»™t `queryKey` Ä‘á»ƒ Ä‘á»‹nh danh cho yÃªu cáº§u vÃ  má»™t `queryFn` (hoáº·c promise) Ä‘á»ƒ thá»±c hiá»‡n yÃªu cáº§u láº¥y dá»¯ liá»‡u.

- `useQuery` cung cáº¥p cÃ¡c biáº¿n vÃ  phÆ°Æ¡ng thá»©c Ä‘á»ƒ quáº£n lÃ½ tráº¡ng thÃ¡i cá»§a yÃªu cáº§u, nhÆ° `isLoading`, `isError`, `error`, `data`, `refetch`, `reset`, vÃ  nhiá»u hÆ¡n ná»¯a.

  - `data`: Dá»¯ liá»‡u tráº£ vá» tá»« server Ä‘Æ°á»£c lÆ°u trong biáº¿n `data`.
  - `isLoading, isError, isSuccess`: CÃ¡c tráº¡ng thÃ¡i nÃ y xÃ¡c Ä‘á»‹nh tráº¡ng thÃ¡i hiá»‡n táº¡i cá»§a quÃ¡ trÃ¬nh truy váº¥n (Ä‘ang táº£i, cÃ³ lá»—i, thÃ nh cÃ´ng).
  - `error`: Náº¿u cÃ³ lá»—i xáº£y ra trong quÃ¡ trÃ¬nh truy váº¥n, thÃ´ng tin lá»—i sáº½ Ä‘Æ°á»£c lÆ°u trong biáº¿n error.
  - `refetch`: PhÆ°Æ¡ng thá»©c nÃ y dÃ¹ng Ä‘á»ƒ lÃ m má»›i truy váº¥n, gá»­i yÃªu cáº§u lÃªn server Ä‘á»ƒ láº¥y dá»¯ liá»‡u má»›i.
  - `invalidateQueries`: PhÆ°Æ¡ng thá»©c nÃ y dÃ¹ng Ä‘á»ƒ Ä‘Ã¡nh dáº¥u cÃ¡c truy váº¥n liÃªn quan lÃ  khÃ´ng há»£p lá»‡, yÃªu cáº§u truy váº¥n láº¡i dá»¯ liá»‡u tá»« server.

- Khi sá»­ dá»¥ng `useQuery`, React Query sáº½ tá»± Ä‘á»™ng quáº£n lÃ½ bá»™ nhá»› cache vÃ  sá»­ dá»¥ng dá»¯ liá»‡u Ä‘Ã£ lÆ°u trá»¯ trong cache náº¿u cÃ³, giÃºp tá»‘i Æ°u hiá»‡u suáº¥t vÃ  giáº£m sá»‘ láº§n gá»­i yÃªu cáº§u láº·p láº¡i.

- Cáº£ hai hook Ä‘á»u giÃºp chÃºng ta quáº£n lÃ½ tráº¡ng thÃ¡i yÃªu cáº§u dá»… dÃ ng vÃ  tá»± Ä‘á»™ng, há»— trá»£ táº£i dá»¯ liá»‡u báº¥t Ä‘á»“ng bá»™, quáº£n lÃ½ cache vÃ  cung cáº¥p cÃ¡c phÆ°Æ¡ng thá»©c tiá»‡n Ã­ch Ä‘á»ƒ thao tÃ¡c vá»›i dá»¯ liá»‡u. Sá»­ dá»¥ng `useMutation` vÃ  `useQuery` trong React Query giÃºp táº¡o ra tráº£i nghiá»‡m tá»‘t hÆ¡n cho viá»‡c lÃ m viá»‡c vá»›i dá»¯ liá»‡u trong á»©ng dá»¥ng React.

## TÃ³m láº¡i lÃ  khi sá»­ dá»¥ng `useMutation` lÃ  bao gá»“m POST, PUT, DELETE. CÃ²n khi sá»­ dá»¥ng `useQuery` lÃ  sá»­ dá»¥ng GET ?

- ÄÃºng, khi sá»­ dá»¥ng `useMutation` trong React Query, chÃºng ta thÆ°á»ng sá»­ dá»¥ng nÃ³ Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c yÃªu cáº§u `thay Ä‘á»•i` dá»¯ liá»‡u nhÆ° táº¡o má»›i (POST), cáº­p nháº­t (PUT/PATCH) vÃ  xÃ³a (DELETE). Äiá»u nÃ y lÃ  do cÃ¡c yÃªu cáº§u nÃ y thÆ°á»ng liÃªn quan Ä‘áº¿n viá»‡c `thay Ä‘á»•i` dá»¯ liá»‡u trÃªn server.

- Trong khi Ä‘Ã³, khi sá»­ dá»¥ng `useQuery`, chÃºng ta thÆ°á»ng sá»­ dá»¥ng nÃ³ Ä‘á»ƒ thá»±c hiá»‡n yÃªu cáº§u `láº¥y` dá»¯ liá»‡u tá»« server, Ä‘iá»ƒn hÃ¬nh lÃ  yÃªu cáº§u GET. ChÃºng ta sá»­ dá»¥ng `useQuery` Ä‘á»ƒ láº¥y dá»¯ liá»‡u tá»« server vÃ  quáº£n lÃ½ tráº¡ng thÃ¡i cá»§a yÃªu cáº§u, bao gá»“m tráº¡ng thÃ¡i táº£i dá»¯ liá»‡u (`isLoading`), tráº¡ng thÃ¡i lá»—i (`isError`), dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c láº¥y (`data`), vÃ  nhiá»u thuá»™c tÃ­nh vÃ  phÆ°Æ¡ng thá»©c khÃ¡c.

- Tuy nhiÃªn, trong thá»±c táº¿, khÃ´ng cÃ³ quy táº¯c cá»©ng vÃ  nhanh chÃ³ng ráº±ng `useMutation` chá»‰ Ä‘Æ°á»£c sá»­ dá»¥ng cho POST, PUT vÃ  DELETE, vÃ  `useQuery` chá»‰ Ä‘Æ°á»£c sá»­ dá»¥ng cho GET. ChÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng cáº£ hai hook Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c yÃªu cáº§u tÃ¹y chá»‰nh vÃ  phÃ¹ há»£p vá»›i nhu cáº§u cá»¥ thá»ƒ cá»§a á»©ng dá»¥ng cá»§a chÃºng ta. Má»¥c Ä‘Ã­ch chÃ­nh cá»§a React Query lÃ  há»— trá»£ viá»‡c lÃ m viá»‡c vá»›i dá»¯ liá»‡u báº¥t Ä‘á»“ng bá»™ vÃ  quáº£n lÃ½ tráº¡ng thÃ¡i cá»§a cÃ¡c yÃªu cáº§u dá»… dÃ ng vÃ  hiá»‡u quáº£.

## React Toastify lÃ  gÃ¬ ?

- React Toastify lÃ  má»™t thÆ° viá»‡n React Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ hiá»ƒn thá»‹ cÃ¡c thÃ´ng bÃ¡o (toasts) trong á»©ng dá»¥ng web. NÃ³ cung cáº¥p cÃ¡c thÃ nh pháº§n vÃ  API Ä‘Æ¡n giáº£n Ä‘á»ƒ táº¡o ra cÃ¡c thÃ´ng bÃ¡o Ä‘áº¹p, linh hoáº¡t vÃ  dá»… sá»­ dá»¥ng.

- Vá»›i React Toastify, báº¡n cÃ³ thá»ƒ hiá»ƒn thá»‹ cÃ¡c thÃ´ng bÃ¡o táº¡m thá»i trong gÃ³c mÃ n hÃ¬nh, thÃ´ng bÃ¡o lá»—i, thÃ´ng bÃ¡o thÃ nh cÃ´ng, thÃ´ng bÃ¡o cáº£nh bÃ¡o vÃ  nhiá»u loáº¡i thÃ´ng bÃ¡o khÃ¡c. Báº¡n cÃ³ thá»ƒ tÃ¹y chá»‰nh cÃ¡c thÃ´ng bÃ¡o theo Ã½ muá»‘n, bao gá»“m ná»™i dung, kiá»ƒu, thá»i gian tá»“n táº¡i, hÃ nh Ä‘á»™ng, hÃ¬nh áº£nh vÃ  nhiá»u thuá»™c tÃ­nh khÃ¡c.

- React Toastify cung cáº¥p má»™t API Ä‘Æ¡n giáº£n Ä‘á»ƒ táº¡o ra cÃ¡c thÃ´ng bÃ¡o báº±ng cÃ¡ch sá»­ dá»¥ng cÃ¡c hÃ m nhÆ° `toast.success()`, `toast.error()`, `toast.warning()` vÃ  `toast.info()`. NÃ³ cÅ©ng cung cáº¥p cÃ¡c hook nhÆ° `useToast()` Ä‘á»ƒ táº¡o ra cÃ¡c thÃ´ng bÃ¡o tá»« cÃ¡c thÃ nh pháº§n React.

- ThÆ° viá»‡n nÃ y giÃºp cáº£i thiá»‡n tráº£i nghiá»‡m ngÆ°á»i dÃ¹ng vÃ  tÄƒng tÃ­nh tÆ°Æ¡ng tÃ¡c trong á»©ng dá»¥ng cá»§a báº¡n báº±ng cÃ¡ch cung cáº¥p cÃ¡c thÃ´ng bÃ¡o há»¯u Ã­ch vÃ  háº¥p dáº«n cho ngÆ°á»i dÃ¹ng.

## cho vÃ­ dá»¥ cÆ¡ báº£n vá» React Toastify ?

- Äá»ƒ sá»­ dá»¥ng React Toastify, báº¡n cáº§n cÃ i Ä‘áº·t thÆ° viá»‡n `react-toastify` vÃ  import cÃ¡c thÃ nh pháº§n cáº§n thiáº¿t. DÆ°á»›i Ä‘Ã¢y lÃ  má»™t vÃ­ dá»¥ cÆ¡ báº£n vá» viá»‡c sá»­ dá»¥ng React Toastify Ä‘á»ƒ hiá»ƒn thá»‹ thÃ´ng bÃ¡o thÃ nh cÃ´ng:

```jsx
import React from 'react'
import { toast, ToastContainer } from 'react-toastify'
import 'react-toastify/dist/ReactToastify.css'

const ExampleComponent = () => {
  const handleButtonClick = () => {
    toast.success('Thao tÃ¡c thÃ nh cÃ´ng!')
  }

  return (
    <div>
      <button onClick={handleButtonClick}>Hiá»ƒn thá»‹ thÃ´ng bÃ¡o</button>
      <ToastContainer />
    </div>
  )
}

export default ExampleComponent
```

- Trong vÃ­ dá»¥ trÃªn, chÃºng ta import thÃ nh pháº§n `toast` vÃ  `ToastContainer` tá»« `react-toastify`. HÃ m `toast.success()` Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ hiá»ƒn thá»‹ thÃ´ng bÃ¡o thÃ nh cÃ´ng khi ngÆ°á»i dÃ¹ng nháº¥p vÃ o nÃºt. `ToastContainer` Ä‘Æ°á»£c Ä‘áº·t trong thÃ nh pháº§n Ä‘á»ƒ chá»©a vÃ  hiá»ƒn thá»‹ cÃ¡c thÃ´ng bÃ¡o.

- Báº¡n cÃ³ thá»ƒ thay Ä‘á»•i kiá»ƒu thÃ´ng bÃ¡o báº±ng cÃ¡ch sá»­ dá»¥ng cÃ¡c hÃ m khÃ¡c nhÆ° `toast.error()` (thÃ´ng bÃ¡o lá»—i), `toast.warning()` (thÃ´ng bÃ¡o cáº£nh bÃ¡o) vÃ  `toast.info()` (thÃ´ng bÃ¡o thÃ´ng tin). Báº¡n cÅ©ng cÃ³ thá»ƒ tÃ¹y chá»‰nh ná»™i dung vÃ  cÃ¡c thuá»™c tÃ­nh khÃ¡c cá»§a thÃ´ng bÃ¡o theo Ã½ muá»‘n.

- LÆ°u Ã½ ráº±ng báº¡n cáº§n import CSS cá»§a React Toastify (`react-toastify/dist/ReactToastify.css`) Ä‘á»ƒ Ä‘áº£m báº£o giao diá»‡n cá»§a thÃ´ng bÃ¡o Ä‘Æ°á»£c hiá»ƒn thá»‹ Ä‘Ãºng cÃ¡ch.

- ÄÃ¢y chá»‰ lÃ  má»™t vÃ­ dá»¥ Ä‘Æ¡n giáº£n vá» cÃ¡ch sá»­ dá»¥ng React Toastify. ThÆ° viá»‡n nÃ y cÃ²n ráº¥t nhiá»u tÃ­nh nÄƒng vÃ  tÃ¹y chá»n Ä‘á»ƒ báº¡n khÃ¡m phÃ¡ vÃ  tÃ¹y chá»‰nh theo nhu cáº§u cá»§a mÃ¬nh.

## ÄÃ¢y lÃ  Docs cá»§a ÄÆ°á»£c Dev:

TIáº¿p ná»‘i video láº§n trÆ°á»›c, láº§n nÃ y chÃºng ta sáº½ thá»±c hiá»‡n chá»©c nÄƒng Edit vÃ  Delete Student báº±ng React Query nhÃ©.

ğŸ’“Kiáº¿n thá»©c cÃ¡c báº¡n sáº½ Ä‘Æ°á»£c há»c trong video nÃ y:

ğŸ‰ Sá»­ dá»¥ng react router káº¿t há»£p vá»›i react query
ğŸ‰ useMutation vÃ  useQuery
ğŸ‰ React Toastify

ğŸ•°ï¸Ná»™i dung chÃ­nh

```bash
00:00 - Edit Student
15:50 - Sá»­ dá»¥ng React Toastify
18:40 - Xá»­ lÃ½ lá»—i submit tá»« server tráº£ vá»
22:11 - Delete Student
```
